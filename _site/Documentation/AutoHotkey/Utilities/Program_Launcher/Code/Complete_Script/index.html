

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Code</title>
  <!-- <title>Code &mdash; NewHTMLtitle</title> /*original*/-->
  

  
  <link rel="stylesheet" href="/Documentation/o~DocAssets/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="/Documentation/o~DocAssets/pygments.css" type="text/css" />

  
	<link rel="icon" 
		type="image/png" 		
		href="/assets/images/avatar_favicon_gamepad.coder.png">
  
  <!--[if lt IE 9]>
    <script src="/Documentation/o~DocAssets/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="/Documentation/o~DocAssets/documentation_options.js"></script>
        <script type="text/javascript" src="/Documentation/o~DocAssets/jquery.js"></script>
        <script type="text/javascript" src="/Documentation/o~DocAssets/underscore.js"></script>
        <script type="text/javascript" src="/Documentation/o~DocAssets/doctools.js"></script>
        <script type="text/javascript" src="/Documentation/o~DocAssets/language_data.js"></script>
    
    <script type="text/javascript" src="/Documentation/o~DocAssets/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    
		
	<link rel="search" title="Search" href="/Documentation/search.html" />
    <link rel="next" title="What is Godot?" href="../../../../../Godot/index.html" />
    <link rel="prev" title="User Guide" href="../../User_Guide/index.html" />

	<link rel="stylesheet" href="/Documentation/o~DocAssets/css/Doc_Subsite.css" type="text/css" />



</head>

<body class="wy-body-for-nav">

   
	


	
  
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
	    

	<a href="/contact.html">
	<div id="gc_wrapper_pc">
		<div id="gc_banner__logo">


			<img id="gc_banner__picture" src="/assets/images/avatar_gamepad.coder.png" width="50" height="50">
			<h1 id="gc_banner__email">
				Gamepad.Coder<span id="gc_banner__email_atSign">@</span>gmail.com
			</h1>

		</div>
	</div>
		</a>	
			
			
	
<div class="wy-side-nav-search" >
          


          
			
          <!--
            <a href="/Documentation.html" class=""> APIs, Manuals, Tutorials
		  -->
          

          
          <!-- </a> -->

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
			  
              
              
              
              
			  
              
            
            
				<a href="/Documentation.html" class="icon icon-home">&nbsp;Go to Documentation Home</a>
			        
			
              <p class="caption"><a class="caption-manually-inserted-link" href="/Documentation/AutoHotkey/index.html"><span class="caption-text">AutoHotkey:</span></a></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../What_is_AutoHotkey/index.html" style="font-style:italic;">What is AutoHotkey?</a><ul>
<li class="toctree-l2 samePageSectionHeaderLI"><a class="reference internal samePageSectionHeader" href="../../../../What_is_AutoHotkey/index.html#autohotkey-overview">AutoHotkey Overview</a></li>
<li class="toctree-l2 samePageSectionHeaderLI"><a class="reference internal samePageSectionHeader" href="../../../../What_is_AutoHotkey/index.html#autohotkey-resources">AutoHotkey Resources</a></li>
<li class="toctree-l2 samePageSectionHeaderLI"><a class="reference internal samePageSectionHeader" href="../../../../What_is_AutoHotkey/index.html#first-steps">First Steps</a></li>
<li class="toctree-l2 samePageSectionHeaderLI"><a class="reference internal samePageSectionHeader" href="../../../../What_is_AutoHotkey/index.html#baking-your-autohotkey-scripts">Baking Your AutoHotkey Scripts</a></li>
<li class="toctree-l2 samePageSectionHeaderLI"><a class="reference internal samePageSectionHeader" href="../../../../What_is_AutoHotkey/index.html#glossary">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">My AutoHotkey Utilities</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../Emulate_Numberpad/index.html">Emulate Numberpad</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">Program Launcher</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../User_Guide/index.html">User Guide</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Code</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><a class="caption-manually-inserted-link" href="/Documentation/Godot/index.html"><span class="caption-text">Godot:</span></a></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Godot/index.html" style="font-style:italic;">What is Godot?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Godot/HowTo/index.html">How do I &nbsp; <code class="docutils literal notranslate"><span class="pre">(</span>&#160; <span class="pre">?</span>&#160; <span class="pre">)</span></code> &nbsp; in Godot ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Godot/Projects/index.html">My Godot Experiments</a></li>
</ul>

			  
            
          
        </div>
        
      </div>
      
      
      <div class="SIDEBAR-NAV-BUTTONS rst-footer-buttons" role="navigation" aria-label="footer navigation">
          <a href="../../../../../Godot/index.html" class="btn btn-neutral SIDEBAR-NAV-BTN float-right" title="What is Godot?" accesskey="n" rel="next"> <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
          <a href="../../User_Guide/index.html" class="btn btn-neutral SIDEBAR-NAV-BTN float-left" title="User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> </a>
      </div>
      

    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
		  <a href="/contact.html">Gamepad.Coder@gmail.com</a>
        
      </nav>

      


	<header id="gc_header">
				<nav id="gc_navbar">
					<a href="/" id="navbar_2">
						<li id="gc_navbar__home">
							Home
						</li>
					</a>
					<a href="/Documentation.html" id="navbar_3">
						<li class="gc_navigation_link__current_page">
							<span id="doc_navbar_button">
								Documentation for Projects
							</span>
						</li>
						<li class="gc_navigation_link__current_page__toHome">
							<span id="doc_navbar_button">&nbsp;up to Documentation Home&nbsp;</span>
						</li>
					</a>
					<a href="/Apps.html" id="navbar_4">
						<li>
							App Gallery
						</li>
					</a><a href="/Philosophy.html" id="navbar_5">
						<li>
							Philosophy Blog
						</li>
					</a>
				</nav>
			
			</header> <!-- id="gc_header" | css #gc_header -->
			
	
	


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
	  
      <li>
		<a href="/Documentation.html" class="icon icon-home" style="color:#2980b9;"></a>&nbsp;<span class="breadcrumb_arrow">&raquo;</span>&nbsp;
      </li>
      
          
	  <li style="
        font-family: 'Courier New';"
      >
		<a href="../../../index.html" style="color:#2980b9;">My AutoHotkey Utilities</a>&nbsp;<span class="breadcrumb_arrow">&raquo;</span>&nbsp;
      </li>
        
          
	  <li style="
        font-family: 'Courier New';"
      >
		<a href="../../index.html" style="color:#2980b9;">Program Launcher</a>&nbsp;<span class="breadcrumb_arrow">&raquo;</span>&nbsp;
      </li>
        
      <li style="
        font-family: 'Courier New';"
      >
	    Code
      </li>
      
    
    
      <li class="wy-breadcrumbs-aside">
        
          
			
			<a href="/Documentation/o~SourceFiles/AutoHotkey/Utilities/Program_Launcher/Code/Complete_Script/index.rst.txt" rel="nofollow" style="font-size: 14px;"> View page's source<br />(reStructuredText file)</a>
			
			
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="code">
<h1>Code<a class="headerlink" href="#code" title="Permalink to this headline">Â¶</a></h1>
<p><a class="reference external image-reference" href="../../HelloProgramLauncher.gif"><img alt="../../HelloProgramLauncher.gif" src="../../HelloProgramLauncher.gif"/></a></p>
<p><br /></p>
<p><h2>How Program Launcher is Organized</h2></p>
<p>Program Launcher is divided into two files.</p>
<p>The first file <code class="docutils literal notranslate"><span class="pre" style="color: blue;">program_launcher.ahk</span></code> contains</p>
<ul class="simple">
<li>The initialization code.</li>
<li>A label which displays a command prompt when the hotkey is pressed.
(If the user types a known command here, this label runs the
associated action. The hotkey is read from the savefile.)</li>
<li>A class containing functions to read and write to the .ini savefile.</li>
<li>The default text for the savefile, and code to create a vanilla savefile.
(A default savefile is created when program launcherâs script file
doesnât find a savefile in the folder where its script lives.)</li>
</ul>
<p>The second file <code class="docutils literal notranslate"><span class="pre">program_launcher_settings_window.ahk</span></code> contains</p>
<ul class="simple">
<li>The GUI code for the main settings window.</li>
<li>The GUI code for the popup window to configure actions.</li>
<li>The GUI code for the popup window to configure commands.</li>
</ul>
<p>When <code class="docutils literal notranslate"><span class="pre" style="color: blue;">program_launcher.ahk</span></code> is run, it automatically imports
the code contained in <code class="docutils literal notranslate"><span class="pre">program_launcher_settings_window.ahk</span></code>.</p>
<p><br /></p>
<p><h2>Download</h2></p>
<p>You need both <code class="docutils literal notranslate"><span class="pre" style="color: blue;">program_launcher.ahk</span></code> and <code class="docutils literal notranslate"><span class="pre">program_launcher_settings_window.ahk</span></code> to run this app.
<br /><em>(Place them in the same folder, but that folder can be anywhere)</em>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Project Folder</strong></td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/tree/main/Utilities/Program_Launcher">https://github.com/gamepad-coder/AutoHotkey_Projects/tree/main</a></td>
</tr>
<tr class="row-odd"><td>&nbsp; &nbsp; &nbsp; <a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/tree/main/Utilities/Program_Launcher">/Utilities/Program_Launcher</a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>program_launcher.ahk</strong></td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/blob/main/Utilities/Program_Launcher/program_launcher.ahk">https://github.com/gamepad-coder</a></td>
</tr>
<tr class="row-odd"><td>&nbsp; &nbsp; &nbsp; <a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/blob/main/Utilities/Program_Launcher/program_launcher.ahk">/AutoHotkey_Projects/blob/main/Utilities</a></td>
</tr>
<tr class="row-even"><td>&nbsp; &nbsp; &nbsp; <a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/blob/main/Utilities/Program_Launcher/program_launcher.ahk">/Program_Launcher/program_launcher.ahk</a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>program_launcher_settings_window.ahk</strong></td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/blob/main/Utilities/Program_Launcher/program_launcher_settings_window.ahk">https://github.com/gamepad-coder</a></td>
</tr>
<tr class="row-even"><td>&nbsp; &nbsp; &nbsp; <a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/blob/main/Utilities/Program_Launcher/program_launcher_settings_window.ahk">/AutoHotkey_Projects/blob/main/Utilities</a></td>
</tr>
<tr class="row-odd"><td>&nbsp; &nbsp; &nbsp; <a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/blob/main/Utilities/Program_Launcher/program_launcher_settings_window.ahk">/Program_Launcher/program_launcher_settings_window.ahk</a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>Sample Settings File</strong></td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/blob/main/Utilities/Program_Launcher/program_launcher_settings.ini">https://github.com/gamepad-coder</a></td>
</tr>
<tr class="row-odd"><td>&nbsp; &nbsp; &nbsp; <a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/blob/main/Utilities/Program_Launcher/program_launcher_settings.ini">/AutoHotkey_Projects/blob/main/Utilities</a></td>
</tr>
<tr class="row-even"><td>&nbsp; &nbsp; &nbsp; <a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/blob/main/Utilities/Program_Launcher/program_launcher_settings.ini">/Program_Launcher/program_launcher_settings.ini</a></td>
</tr>
</tbody>
</table>
<p>To download these individual files on GitHub:</p>
<ol class="arabic simple">
<li>Navigating to the file you want.</li>
<li>Right-click the button that says <kbd class="kbd docutils literal notranslate">Raw</kbd>.</li>
<li>Click âSave Link Asâ¦â and save your script file.</li>
</ol>
<p>Alternatively:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/gamepad-coder/AutoHotkey_Projects/archive/refs/heads/main.zip">Download a .zip of my entire AutoHotkey_Projects repository on Github</a>.</li>
</ul>
<p><br /></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you want to look at AutoHotkey scripts in a text editor with highlighted code, see the links
at the bottom of my <a class="reference internal" href="../../../../What_is_AutoHotkey/index.html#ref-what-is-autohotkey-resources-text-editors"><span class="std std-ref">AutoHotkey Resources</span></a> section.</p>
</div>
<p><br /></p>
<p><h2>Read The Full Script On This Page</h2></p>
<p>In this section, you can read the entire code for <code class="docutils literal notranslate"><span class="pre" style="color: blue;">program_launcher.ahk</span></code> and <code class="docutils literal notranslate"><span class="pre">program_launcher_settings_window.ahk</span></code>.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p><strong>Folding and Unfolding:</strong></p>
<p>You can expand and contract sections of code in the scripts below.</p>
<p>For Program Launcher, Iâve collapsed the classes and functions on this page
since this script is so long.</p>
<p><details><summary> Look for the blocks that look like this
<br />&nbsp; &nbsp; &nbsp; and click either the arrow or the text. </summary></p>
<p><div style="padding-left:60px;"></p>
<p><br />
And the code inside that block</p>
<p>will be revealed!
</div></p>
<p></details></p>
<p class="last">&nbsp;</p>
</div>
<p><div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p></p><details><summary> <strong>Scrolling Horizontally (On PC):</strong> </summary>
<div style="padding-left:10px;">
<p style="
    height: 20px;
"></p>
If your mouse has a wheel, you can scroll horizontally using the mouse.
Place your mouse cursor over the code, hold shift, then move the wheel up or down.<p></p>
<p>If you are using a laptop which supports two-finger-scrolling,
hold shift and move two fingers up or down on the touchpad <em>(both in the same direction)</em>,
and the region under the mouse will scroll horizontally.</p>
<p>This only works if</p>
<ol class="arabic simple">
<li>The mouse is hovering over the area to scroll.</li>
<li>The area under the mouse has a horizontal scroll bar.</li>
</ol>
<p>If nothing happens, then your window is big enough to display the entire
width of the box. <em>(In this scenario, horizontal scroll bar will be
greyed out, if it exists)</em>.
</p></div>
</details>
<br> <hr style="
    border-top: 1px solid #75b4ca;
">
<details><summary> <strong>Quick Navigation (On PC):</strong> </summary>
<div style="padding-left:10px;">
<p style="
    height: 20px;
"></p>
Iâve used the HTML <code class="docutils literal notranslate"><span class="pre">&lt;details&gt;</span></code> tag to add text folding to:
<ul class="simple" style="margin-top:0;">
<li style="
    margin-top: 0;
">these Hint boxes,</li>
<li style="
    margin-top: 0;
">the blue-outlined boxes below (which contain entire scripts),</li>
<li style="
    margin-top: 0;
">and blocks of AutoHotkey code <code class="docutils literal notranslate" style="
    color: blue;
"><span class="pre">{</span></code> with curly braces <code class="docutils literal notranslate" style="
    color: blue;
"><span class="pre">}</span></code>.</li>
</ul>
<p>On PC, you can quickly navigate between these foldable <code class="docutils literal notranslate"><span class="pre">&lt;details&gt;</span></code> tags:</p>
<ol><li style="
    margin-top: 20px;
"><p>First click any block of code or text which has a folding arrow to activate it.</p></li>
<li style="
    margin-top: 20px;
"><p>Once youâve activated one of the folding text blocks,
you can use <kbd class="kbd docutils literal notranslate">Tab</kbd> to go to the next foldable region, and
<kbd class="kbd docutils literal notranslate">Shift</kbd>+<kbd class="kbd docutils literal notranslate">Tab</kbd> to go to the previous region. If the region is outside your current view, your browser will scroll the window for you.</p></li>
<li style="
    margin-top: 20px;
"><p>After pressing (<kbd class="kbd docutils literal notranslate">Shift</kbd>+) <kbd class="kbd docutils literal notranslate">Tab</kbd>, the selected region
should be outlined by your web browser. Press <kbd class="kbd docutils literal notranslate">Space</kbd> when a region
    is outlined to toggle its fold/unfold state!</p></li></ol>
<hr style="
    border-top: 1px solid #75b4ca;
    margin-top: 34px;
    margin-left: 2vw;
    margin-right: 2vw;
"><div style="
    padding: 30px;
    padding-top: 10px;
    padding-right: 50px;
"><p><em>Note 1:<br><br> If</em> <i><b>âQuick Navigation (On PC)â</b></i> <em>was the last thing
you clicked, then the</em> <i><code class="docutils literal notranslate"><span class="pre">&lt;details&gt;</span></code></i> <em>containing
this block is currently activated. Go ahead and try pressing</em> <kbd class="kbd docutils literal notranslate">Tab</kbd> <em>now!</em></p></div>
<hr style="
    border-top: 1px solid #75b4ca;
    margin-left: 2vw;
    margin-right: 2vw;
"><div style="
    padding: 30px;
    padding-top: 10px;
    padding-right: 50px;
"><p><em>Note 2:<br><br>This navigation trick only works after clicking a foldable region,
or clicking somewhere in the middle of the page, outside of the sidebar. If you load the page then immediately press</em> <kbd class="kbd docutils literal notranslate">Tab</kbd><em>,  the
Table of Contents in the Sidebar will be outlined first.  If this happens,
click a foldable text block to change the activated region, then use</em>
    <kbd class="kbd docutils literal notranslate">Tab</kbd><em>.</em><br>
</p></div> </div>
</details>
<p style="
    height: 10px;
"></p><p></p>
</div></p>
<p><div class="collapsible_wrapper">
<details class="collapsible_section_via_details"><summary><strong>program_launcher.ahk</strong> </summary> <div class="collapsible_codeblock_section"></p>
<div class="highlight-AutoHotkey_CustomLexer notranslate"><div class="highlight"><pre><span></span><span class="c1">            ;-------------------------------------;</span>
<span class="c1">            ;                                     ;</span>
<span class="c1">            ;           PUBLIC DOMAIN             ;</span>
<span class="c1">            ;                                     ;</span>
<span class="c1">            ;       This file is released         ;</span>
<span class="c1">            ;       under the cc0 license.        ;</span>
<span class="c1">            ;                                     ;</span>
<span class="c1">            ;-------------------------------------;</span>
<span class="c1">            ;                                     ;</span>
<span class="c1">            ;   Written by:                       ;</span>
<span class="c1">            ;                    Gamepad-Coder    ;</span>
<span class="c1">            ;                                     ;</span>
<span class="c1">            ;-------------------------------------;</span>


<span class="c1">;-----------------------------------------------------------------------;</span>
<span class="c1">;  program_launcher.ahk                                                 ;</span>
<span class="c1">;-----------------------------------------------------------------------;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;                                                     version 2         ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;-----------------------------------------------------------------------;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;   ====================                                                ;</span>
<span class="c1">;    About the program:                                                 ;</span>
<span class="c1">;   ====================                                                ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;      ----------------                                                 ;</span>
<span class="c1">;       What it does:                                                   ;</span>
<span class="c1">;      ----------------                                                 ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;       program_launcher.ahk is a small utility                         ;</span>
<span class="c1">;       to reduce the number of steps to                                ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;         (1) open programs or                                          ;</span>
<span class="c1">;         (2) navigate to folders                                       ;</span>
<span class="c1">;             (by opening the folder                                    ;</span>
<span class="c1">;              in a new Windows Explorer window).                       ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;       You can register a word or phrase as a [Command]                ;</span>
<span class="c1">;       which program_launcher.ahk will associate with an [Action].     ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;       Program Launcher&#39;s main hotkey will open a small popup.         ;</span>
<span class="c1">;       Type a Command into the popup, then press enter                 ;</span>
<span class="c1">;       and your Action will run!                                       ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;    --------------------------------------                             ;</span>
<span class="c1">;     See the function Default_Save_File()                              ;</span>
<span class="c1">;     at the bottom of this file to read:                               ;</span>
<span class="c1">;    --------------------------------------                             ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;       () an overview,                                                 ;</span>
<span class="c1">;       () user guide,                                                  ;</span>
<span class="c1">;       () and syntax for the sections of the settings file             ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;       Note:                                                           ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;       This script does provide a graphic user interface               ;</span>
<span class="c1">;       to change settings, so the syntax guide is mainly for           ;</span>
<span class="c1">;       debugging and users who want to understand the script better.   ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;-----------------------------------------------------------------------;</span>



<span class="c1">;================================================;</span>
<span class="c1">;                                                ;</span>
<span class="c1">;             begin autorun section              ;</span>
<span class="c1">;                                                ;</span>
<span class="c1">;================================================;</span>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;---------;</span>
<span class="c1">   ;    ?    ;</span>
<span class="c1">   ;---------------------------------------------------------; </span></SUMMARY>
<span class="c1">   ; For more information about the &quot;auto-execute section&quot;   ;</span>
<span class="c1">   ; at the beginning of an AutoHotkey script, see:          ;</span>
<span class="c1">   ;     https://www.autohotkey.com/docs/Scripts.htm#auto    ;</span>
<span class="c1">   ;---------------------------------------------------------; </span></DETAILS>
   

   <span class="nb">#SingleInstance</span> <span class="n">Force</span>
   <span class="kr">SetWinDelay</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
   <span class="kr">SetControlDelay</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="c1"> </span>
<span class="c1">     ;</span>
<span class="c1">     ; more info:</span>
<span class="c1">     ;</span>
<span class="c1">     ;      https://www.autohotkey.com/docs/commands/SetControlDelay.htm</span>
<span class="c1">     ;      https://www.autohotkey.com/boards/viewtopic.php?t=9660</span>
<span class="c1">     ;</span>
<span class="c1">     ;      https://www.autohotkey.com/docs/commands/SetWinDelay.htm</span>
<span class="c1">     ;</span>
<span class="c1">     ;      https://www.autohotkey.com/docs/commands/_SingleInstance.htm</span>
<span class="c1">     ;---------------------------------------------------------------------------</span>


   <span class="vc">_AHK_DIR</span> <span class="o">:=</span> <span class="s">&quot;C:\[autohotkey]\&quot;</span>



<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;-----------------------------------------------------------------</span>
<span class="c1">   ; variables</span>
<span class="c1">   ;----------------------------------------------------------------- </span></SUMMARY>
<span class="c1">   ;</span>
<span class="c1">   ;</span>
<span class="c1">   ;   [_savefile_path]</span>
<span class="c1">   ;     </span>
<span class="c1">   ;      Default name of the settings file from which </span>
<span class="c1">   ;      program_launcher.ahk loads settings and saved commands.</span>
<span class="c1">   ;     </span>
<span class="c1">   ;      This filename can be changed here.</span>
<span class="c1">   ;</span>
<span class="c1">   ;</span>
<span class="c1">   ;   [_savefile__default_content]</span>
<span class="c1">   ;</span>
<span class="c1">   ;      Holds the default text to insert into </span>
<span class="c1">   ;      the %_savefile_path%.ini file.</span>
<span class="c1">   ;</span>
<span class="c1">   ;</span>
<span class="c1">   ;   [_hotkey_for_commandline_popup]</span>
<span class="c1">   ;      </span>
<span class="c1">   ;      Assigned by .ini settings, by default &lt;^#Space&gt;</span>
<span class="c1">   ;      If unlisted in .ini</span>
<span class="c1">   ;        then automatically assigned to default.</span>
<span class="c1">   ;      </span>
<span class="c1">   ;      Program is useless without at least this, </span>
<span class="c1">   ;      so it can&#39;t be omitted.</span>
<span class="c1">   ;      </span>
<span class="c1">   ;      Edge cases with buggy AHK scripts can result in blocking</span>
<span class="c1">   ;      keyboard or mouse input. But for normal use this hotkey </span>
<span class="c1">   ;      will always allow the user to exit the application:</span>
<span class="c1">   ;        - by opening the command prompt </span>
<span class="c1">   ;        - then typing the Command associated with Quit.</span>
<span class="c1">   ;</span>
<span class="c1">   ;</span>
<span class="c1">   ;  [_hotkey_for_quit]</span>
<span class="c1">   ;    </span>
<span class="c1">   ;     Assigned via .ini, by default &lt;^#Q&gt;.</span>
<span class="c1">   ;     If unlisted in .ini</span>
<span class="c1">   ;       then there will be no hotkey assigned</span>
<span class="c1">   ;       to quit program_launcher.ahk</span>
<span class="c1">   ;     </span>
<span class="c1">   ;     If unlisted, program can be quit:</span>
<span class="c1">   ;     (1)  by right clicking the Notification Tray icon </span>
<span class="c1">   ;          for program_launcher.ahk, then selecting quit, </span>
<span class="c1">   ;     </span>
<span class="c1">   ;     or </span>
<span class="c1">   ;     </span>
<span class="c1">   ;     (2)  by opening the commandline popup</span>
<span class="c1">   ;          then entering the command assigned to the Quit aciton.</span>
<span class="c1">   ;----------------------------------------------------------------- </span></DETAILS>

   
   
   <span class="vc">_o_Gui_ProgramLauncher_UserInputCommand_Popup</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>    
   <span class="vc">_o_Gui_Config_Main</span>       <span class="o">:=</span> <span class="s">&quot;&quot;</span>
   <span class="vc">_o_Gui_Config_Popup</span>      <span class="o">:=</span> <span class="s">&quot;&quot;</span>
   <span class="vc">_o_Gui_Config_IconPicker</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>

   <span class="vc">_COMMANDS</span> <span class="o">:=</span> <span class="p">{}</span>
   <span class="vc">_ACTIONS</span>  <span class="o">:=</span> <span class="p">{}</span>
   
   <span class="vc">_ICON_INDEX</span> <span class="o">:=</span> <span class="mi">138</span>

   <span class="vc">_savefile_path</span> <span class="o">:=</span> <span class="s">&quot;program_launcher_settings.ini&quot;</span>
   <span class="vc">_savefile__default_content</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>

   <span class="vc">_hotkey_for_commandline_popup</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
   <span class="vc">_hotkey_for_settings</span>          <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
   <span class="vc">_hotkey_for_reload</span>            <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
   <span class="vc">_hotkey_for_quit</span>              <span class="o">:=</span> <span class="s">&quot;&quot;</span> 

   <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Load_Settings</span><span class="ss">()</span>
   
   <span class="kr">Menu</span><span class="p">,</span> <span class="n">Tray</span><span class="p">,</span> <span class="n">Icon</span><span class="p">,</span> <span class="n">Shell32</span><span class="o">.</span><span class="n">dll</span><span class="p">,</span> <span class="vi">%_ICON_INDEX%</span>


   <span class="k">return</span><span class="c1"></span>


<span class="c1">;================================;</span>
<span class="c1">; &lt;/&gt;  end of autorun section    ;</span>
<span class="c1">;================================;</span>
<span class="c1">   </span>

<span class="c1">;-----------------------------------------------------------------------------------------------</span>
<span class="c1">  </span>

<span class="c1">;================================================;</span>
<span class="c1">;                                                ;</span>
<span class="c1">;                   Hotkeys                      ;</span>
<span class="c1">;                                                ;</span>
<span class="c1">;================================================;</span>


<span class="c1">;=======================================================;</span>
<span class="c1">;  (KEY) AutoHotkey hotkey syntax :                     ;</span>
<span class="c1">;=======================================================;</span>
<span class="c1">;                                                       ;</span>
<span class="c1">;     +  shift                                          ;</span>
<span class="c1">;     ^  ctrl                                           ;</span>
<span class="c1">;     #  win                                            ;</span>
<span class="c1">;     !  alt                                            ;</span>
<span class="c1">;                                                       ;</span>
<span class="c1">;  For more information see:                            ;</span>
<span class="c1">;  https://www.autohotkey.com/docs/commands/Hotkey.htm  ;</span>
<span class="c1">;  https://www.autohotkey.com/docs/KeyList.htm          ;</span>
<span class="c1">;=======================================================;</span>

<span class="c1">   ;---------------------------------------------;</span>
<span class="c1">   ; These hotkeys are dynamically assigned      ;</span>
<span class="c1">   ; from the settings file when the app starts. ;</span>
<span class="c1">   ;---------------------------------------------;</span>
<span class="c1">   ;</span>
<span class="c1">   ; ^#Space::</span>
<span class="c1">   ;    ProgramLauncherPopupCommand</span>
<span class="c1">   ; return</span>
<span class="c1">   ;</span>
<span class="c1">   ; ^#!q::</span>
<span class="c1">   ;    ProgramLauncherQuit</span>
<span class="c1">   ; return</span>
<span class="c1">   </span>
<span class="c1">   ; TODO</span>
<span class="c1">   ;</span>
<span class="c1">   ; Ran out of time, </span>
<span class="c1">   ; going to add this to the settings file in the next version.</span>
<span class="c1">   ;</span>
   <span class="o">^</span><span class="n">#</span><span class="o">!</span><span class="n">r</span><span class="o">::</span>
      <span class="kr">Reload</span>
   <span class="k">return</span><span class="c1"></span>


<span class="c1">;==================================;</span>
<span class="c1">; &lt;/&gt;  end of Hotkey definitions   ;</span>
<span class="c1">;==================================;</span>


<span class="c1">;-----------------------------------------------------------------------------------------------</span>


<span class="c1">;================================================;</span>
<span class="c1">;                                                ;</span>
<span class="c1">;                    Labels                      ;</span>
<span class="c1">;                                                ;</span>
<span class="c1">;================================================;</span>


<span class="c1">;======================</span>
<span class="c1">; Quit</span>
<span class="c1">;======================</span>

<span class="nl">ProgramLauncherQuit:</span>
   <span class="kr">ExitApp</span>
<span class="k">return</span><span class="c1">   </span>


<span class="c1">;===================================================</span>
<span class="c1">; SETTINGS </span>
<span class="c1">;</span>
<span class="c1">;-&gt; Open the window to configure Program Launcher.</span>
<span class="c1">;===================================================</span>

<span class="nl">OpenConfigurationWindow:</span>
   <span class="vc">_o_Gui_Config_Main</span> <span class="o">:=</span> <span class="n">new</span> <span class="n">GuiConfigMain</span>         
<span class="k">return</span><span class="c1"> </span>


<span class="c1">;======================================================</span>
<span class="c1">; Reload Settings Window</span>
<span class="c1">;</span>
<span class="c1">; -&gt; Reloads the configuration window </span>
<span class="c1">;    in order to display a new icon in the title bar.</span>
<span class="c1">;======================================================</span>

<DETAILS class="leading_tabs_0"><SUMMARY><span class="n">ReloadConfigurationWindow</span><span class="o">:</span>
<span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;--------------------------------------------------------------------</span>
<span class="c1">   ; When the user selects a new Icon, </span>
<span class="c1">   ; the Configuration Gui should reflect this change.</span>
<span class="c1">   ;-------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">   ;</span>
<span class="c1">   ; Progression:</span>
<span class="c1">   ;</span>
<span class="c1">   ;    1. The user changes the program&#39;s icon using </span>
<span class="c1">   ;       the &quot;Settings&quot; tab of the Configuration Gui</span>
<span class="c1">   ;    2. The Configuration Gui&#39;s class stores the user&#39;s choice</span>
<span class="c1">   ;       in the global _ICON_INDEX variable. </span>
<span class="c1">   ;    3. The Config Gui calls this label. </span>
<span class="c1">   ;    4. This label deletes both the Configuration Window&#39;s </span>
<span class="c1">   ;       global object instance &amp; the Config Window Gui. </span>
<span class="c1">   ;    5. This label re-creates the Config Window&#39;s object &amp; Gui.</span>
<span class="c1">   ;    6. The Config Window is told to change to the &quot;Settings&quot; tab.</span>
<span class="c1">   ;    7. The Config Window now has a new icon and the user is still </span>
<span class="c1">   ;       oriented and on the same tab. </span>
<span class="c1">   ;</span>
<span class="c1">   ; Aesthetically, this implementation is a bit choppy in presentation, </span>
<span class="c1">   ; but it&#39;s a simple way to accomplish changing the icon </span>
<span class="c1">   ; without telling the user </span>
<span class="c1">   ; </span>
<span class="c1">   ;   &quot;This will be reflected the next time you run this application.&quot;</span>
<span class="c1">   ; </span>
<span class="c1">   ; Alternatively:</span>
<span class="c1">   ;</span>
<span class="c1">   ;        It seems like a title bar icon can be changed at runtime</span>
<span class="c1">   ;        without destroying the gui by using .dll calls, </span>
<span class="c1">   ;        but I haven&#39;t personally researched this.</span>
<span class="c1">   ;     </span>
<span class="c1">   ;        Further reading:</span>
<span class="c1">   ;        </span>
<span class="c1">   ;        https://www.autohotkey.com/boards/viewtopic.php?t=72727</span>
<span class="c1">   ;</span>
<span class="c1">   ;-------------------------------------------------------------------- </span></DETAILS>
   
   <span class="vc">_o_Gui_Config_Main</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
   <span class="vc">_o_Gui_Config_Main</span> <span class="o">:=</span> <span class="n">new</span> <span class="n">GuiConfigMain</span>
   <span class="vc">_o_Gui_Config_Main</span><span class="o">.</span><span class="nf">Fn_Change_to_Settings_Tab</span><span class="ss">()</span>
   
   <span class="k">return</span>
<span class="p">}</span></DETAILS><span class="c1"></span>


<span class="c1">;======================</span>
<span class="c1">; Command Line Popup</span>
<span class="c1">;======================</span>

<DETAILS class="leading_tabs_0"><SUMMARY><span class="n">ProgramLauncherPopupCommand</span><span class="o">:</span>
<span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;---------------------------------------------------------</span>
<span class="c1">   ; This label creates the &quot;Command Line&quot; popup</span>
<span class="c1">   ; where the user can type a Command to trigger an Action.</span>
<span class="c1">   ;--------------------------------------------------------- </span></SUMMARY>
<span class="c1">   ;</span>
<span class="c1">   ; If the Command exists and is not disabled, </span>
<span class="c1">   ; then the Action associated with the Command is run,</span>
<span class="c1">   ; and the popup is closed.</span>
<span class="c1">   ;</span>
<span class="c1">   ; If the Command is disabled, or text is typed </span>
<span class="c1">   ; which does not match any Command, </span>
<span class="c1">   ; then the popup silently closes. </span>
<span class="c1">   ;--------------------------------------------------------- </span></DETAILS>

   <span class="n">box_title</span>         <span class="o">:=</span> <span class="s">&quot;Program Launcher!&quot;</span>
   <span class="n">box_prompt</span>        <span class="o">:=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">Enter your command...        : ) &quot;</span>
   <span class="n">box_option_noHide</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
   <span class="n">box_width</span>         <span class="o">:=</span> <span class="mi">300</span>
   <span class="n">box_height</span>        <span class="o">:=</span> <span class="mi">150</span>
   <span class="kr">Inputbox</span><span class="p">,</span> <span class="n">userEnteredString</span>
      <span class="p">,</span> <span class="vi">%box_title%</span>
      <span class="p">,</span> <span class="vi">%box_prompt%</span>
      <span class="p">,</span> <span class="vi">%box_option_noHide%</span>
      <span class="p">,</span> <span class="vi">%box_width%</span>
      <span class="p">,</span> <span class="vi">%box_height%</span><span class="c1"></span>
<span class="c1">      ;   , X</span>
<span class="c1">      ;   , Y</span>
<span class="c1">      ;   , Font</span>
<span class="c1">      ;   , Timeout</span>
<span class="c1">      ;   , Default string for editable field</span>
<span class="c1">   </span>
<span class="c1">   ;-----------------------------------------------------------------------</span>
<span class="c1">   ; https://www.autohotkey.com/docs/commands/InputBox.htm#Error_Handling</span>
<span class="c1">   ;</span>
<span class="c1">   ; If the user hits cancel or escape,</span>
<span class="c1">   ; then don&#39;t process the entered text.</span>
<span class="c1">   ;</span>
<span class="c1">   ;</span>
<DETAILS open class="control_flow_block leading_tabs_1"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">0</span> <span class="o">!=</span> <span class="nv">ErrorLevel</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS open class="control_flow_block leading_tabs_1"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_COMMANDS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span> <span class="n">userEnteredString</span> <span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      <span class="n">cmd</span> <span class="o">:=</span> <span class="vc">_COMMANDS</span><span class="p">[</span> <span class="n">userEnteredString</span> <span class="p">]</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------</span>
<span class="c1">      ; If a Command is disabled, it will still </span>
<span class="c1">      ; exist in the app at runtime, but </span>
<span class="c1">      ; calls to run it will be ignored here:</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">false</span> <span class="o">==</span> <span class="n">cmd</span><span class="p">[</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="k">return</span> 
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="n">run_action_id</span> <span class="o">:=</span> <span class="n">cmd</span><span class="p">[</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span>
         <span class="k">gosub</span> <span class="n">RunActionID</span>
      <span class="p">}</span></DETAILS>
   <span class="p">}</span></DETAILS>
   
   <span class="k">return</span>
<span class="p">}</span></DETAILS><span class="c1"></span>


<span class="c1">;======================</span>
<span class="c1">; Run Action </span>
<span class="c1">;======================</span>

<DETAILS class="leading_tabs_0"><SUMMARY><span class="n">RunActionID</span><span class="o">:</span>
<span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;----------------------------------------------------------------------</span>
<span class="c1">   ; This is the only place in the code </span>
<span class="c1">   ; where Actions are actually run. </span>
<span class="c1">   ;---------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">   ;</span>
<span class="c1">   ; This label is separate from the &quot;ProgramLauncherPopupCommand&quot; label </span>
<span class="c1">   ; to allow the user to run Actions from both of these windows: </span>
<span class="c1">   ; </span>
<span class="c1">   ;   (1) from the Command input popup </span>
<span class="c1">   ;   (2) from the Actions tab of the Configuration Gui.</span>
<span class="c1">   ;</span>
<span class="c1">   ;---------------------------------------------------------------------- </span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;---------------------------------------------------------------</span>
<span class="c1">   ; Currently, the only two Actions which call internal functions </span>
<span class="c1">   ;--------------------------------------------------------------- </span></SUMMARY>
<span class="c1">   ; for Program Launcher are Quit &amp; Settings.</span>
<span class="c1">   ;</span>
<span class="c1">   ; The Quit Action :</span>
<span class="c1">   ;  - closes any opened popups</span>
<span class="c1">   ;  - unassigns any hotkeys registered by the app</span>
<span class="c1">   ;  - and terminates the application.</span>
<span class="c1">   ;</span>
<span class="c1">   ; The Settings Action will open </span>
<span class="c1">   ; a window for the user to interactively :</span>
<span class="c1">   ;  - add, edit, and remove Actions &amp; Commands </span>
<span class="c1">   ;  - enable or disable Commands </span>
<span class="c1">   ;  - change settings, including which icon to</span>
<span class="c1">   ;    display (this icon appears in the title bar </span>
<span class="c1">   ;    and in the Notification Area of the Windows Taskbar).</span>
<span class="c1">   ;                                                               </span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_1"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">run_action_id</span> <span class="o">==</span> <span class="s">&quot;QUIT&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      <span class="kr">ExitApp</span>
   <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_1"><SUMMARY><span class="k">else</span> 
   <span class="k">if</span><span class="ss">(</span> <span class="n">cmd</span><span class="o">.</span><span class="n">action_id</span> <span class="o">==</span> <span class="s">&quot;SETTINGS&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
      <span class="k">gosub</span> <span class="n">OpenConfigurationWindow</span>

   <span class="p">}</span></DETAILS>
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;-------------------------------------------------------</span>
<span class="c1">   ; For all other Actions </span>
<span class="c1">   ;------------------------------------------------------- </span></SUMMARY>
<span class="c1">   ; </span>
<span class="c1">   ; Either:</span>
<span class="c1">   ; - a specific folder is opened or</span>
<span class="c1">   ; - a specific app is run </span>
<span class="c1">   ;   optionally with added arguments / parameters</span>
<span class="c1">   ;</span>
<span class="c1">   ;   For example, if your Chrome web browser </span>
<span class="c1">   ;   has multiple profiles, you can tell it to load </span>
<span class="c1">   ;   for a specific user by using the argument: </span>
<span class="c1">   ;</span>
<span class="c1">   ;       --profile-directory=&quot;Profile 2&quot;</span>
<span class="c1">   ;                                                        </span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_1"><SUMMARY><span class="k">else</span>
   <span class="k">if</span><span class="ss">(</span> <span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span> <span class="n">run_action_id</span> <span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      <span class="n">act</span> <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span> <span class="n">run_action_id</span> <span class="p">]</span>
      
      <span class="n">act_path</span> <span class="o">:=</span> <span class="n">act</span><span class="p">[</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
      <span class="n">act_type</span> <span class="o">:=</span> <span class="n">act</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span>
      <span class="n">act_arg</span>  <span class="o">:=</span> <span class="n">act</span><span class="p">[</span><span class="s">&quot;arg&quot;</span><span class="p">]</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;folder&quot;</span> <span class="o">==</span> <span class="n">act_type</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">run</span> <span class="n">explorer</span><span class="o">.</span><span class="n">exe</span> <span class="s">&quot;%act_path%&quot;</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> 
      <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;app&quot;</span> <span class="o">==</span> <span class="n">act_type</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">run</span> <span class="s">&quot;%act_path%&quot;</span> <span class="vi">%act_arg%</span>
      <span class="p">}</span></DETAILS>
   <span class="p">}</span></DETAILS>
   
   <span class="k">return</span>
   
<span class="p">}</span></DETAILS><span class="c1"></span>




<span class="c1">;===============================;</span>
<span class="c1">; &lt;/&gt;   end of Label section    ;</span>
<span class="c1">;===============================;</span>


<span class="c1">;-----------------------------------------------------------------------------------------------</span>


<span class="c1">;===========================================================;</span>
<span class="c1">;                                                           ;</span>
<span class="c1">;                                                           ;</span>
<span class="c1">;        Class - Savefile Parser &amp; Writer functions         ;</span>
<span class="c1">;                                                           ;</span>
<span class="c1">;                                                           ;</span>
<span class="c1">;===========================================================;</span>


<DETAILS class="leading_tabs_0"><SUMMARY><span class="c1">;====================================================================</span>
<span class="c1">;     About the FILE_HELPER class</span>
<span class="c1">;==================================================================== </span></SUMMARY>
<span class="c1">;   </span>
<span class="c1">;   FILE_HELPER contains all the functionality to </span>
<span class="c1">;   </span>
<span class="c1">;      (1) Read the settings file.</span>
<span class="c1">;      (2) Create a settings file if it doesn&#39;t exist.</span>
<span class="c1">;      (3) Update the settings file when the user changes </span>
<span class="c1">;          settings in the CONFIG graphic user interface window.</span>
<span class="c1">;   </span>
<span class="c1">;   When the app is initialized, FILE_HELPER is called </span>
<span class="c1">;   to read the savefile.</span>
<span class="c1">;   </span>
<span class="c1">;   When the user alters a setting in the CONFIG window, </span>
<span class="c1">;   FILE_HELPER is called with the new setting name and value</span>
<span class="c1">;   updates the savefile, then tells the GUI window to proceed.</span>
<span class="c1">;</span>
<span class="c1">;   The GUI knows about the COMMANDS and ACTIONS arrays, </span>
<span class="c1">;   but it knows nothing of the savefile nor functions to </span>
<span class="c1">;   alter the savefile. By organizing the app like this, </span>
<span class="c1">;   functionality is modular and isolated, and each class </span>
<span class="c1">;   has a specific scope it acts within, instead of having </span>
<span class="c1">;   one giant class of spaghetti code which handles </span>
<span class="c1">;   all types of functionality. This is cleaner and easier </span>
<span class="c1">;   to both maintain and extend.</span>
<span class="c1">;   </span>
<span class="c1">;   </span>
<span class="c1">;   REGULAR EXPRESSIONS:</span>
<span class="c1">;   </span>
<span class="c1">;   FILE_HELPER uses Regular Expressions extensively.</span>
<span class="c1">;   </span>
<span class="c1">;   I have tried to add annotations and breakdowns, </span>
<span class="c1">;   but if you&#39;re unfamiliar with Regular Expressions </span>
<span class="c1">;   (or if you&#39;re unfamiliar with programming in general)</span>
<span class="c1">;   this section might seem a bit arcane without further study.</span>
<span class="c1">;</span>
<span class="c1">;   If you are unfamiliar with Regular Expressions, </span>
<span class="c1">;   here are some resources to help you get started:</span>
<span class="c1">;</span>
<span class="c1">;     () regex101.com is a phenomenal tool for</span>
<span class="c1">;        learning, writing, and debugging Regular Expressions. </span>
<span class="c1">;   </span>
<span class="c1">;     () AutoHotkey&#39;s RegEx Quick Reference </span>
<span class="c1">;        is a great resource for starting.              </span>
<span class="c1">;        </span>
<span class="c1">;        And the AHK documentation for RegExReplace and RegExMatch</span>
<span class="c1">;        should help you understand this section better.</span>
<span class="c1">;   </span>
<span class="c1">;         https://www.autohotkey.com/docs/misc/RegEx-QuickRef.htm</span>
<span class="c1">;         https://www.autohotkey.com/docs/commands/RegExMatch.htm</span>
<span class="c1">;         https://www.autohotkey.com/docs/commands/RegExReplace.htm</span>
<span class="c1">;   </span>
<span class="c1">;     () Finally, if you&#39;re planning on using Regular Expressions </span>
<span class="c1">;        in AutoHotkey long-term, or for complicated use cases:</span>
<span class="c1">;   </span>
<span class="c1">;        AHK Forum user &quot;jeeswg&quot; has created an EPIC tutorial post </span>
<span class="c1">;        detailing how to use Regular Expressions in AutoHotkey </span>
<span class="c1">;        in great and exhaustive detail:</span>
<span class="c1">;   </span>
<span class="c1">;         https://www.autohotkey.com/boards/viewtopic.php?t=28031</span>
<span class="c1">;   </span>
<span class="c1">;        Shoutout to jeeswg and thanks for all your excellent posts.</span>
<span class="c1">;   </span>
<span class="c1">;   </span>
<span class="c1">;   NOTE:</span>
<span class="c1">;</span>
<span class="c1">;   This class is not meant to be instantiated as an object.</span>
<span class="c1">;   It could have been a collection of isolated functions </span>
<span class="c1">;   at the toplevel of this script, but for long scripts this </span>
<span class="c1">;   quickly becomes noisy.</span>
<span class="c1">;</span>
<span class="c1">;   I grouped these functions together in a class to improve </span>
<span class="c1">;   readability, organization, and to enable NotePad++&#39;s </span>
<span class="c1">;   code-block folding to quickly expand or contract </span>
<span class="c1">;   thematically related sections of code.</span>
<span class="c1">;</span>
<span class="c1">;==================================================================== </span></DETAILS>

<DETAILS class="leading_tabs_0"><SUMMARY><span class="k">class</span> <span class="n">FILE_HELPER</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>

   <span class="nb">static</span> <span class="n">init__ar_duplicate_actions_found</span> <span class="o">:=</span> <span class="p">[]</span>
   <span class="nb">static</span> <span class="n">init__ar_duplicate_commands_found</span> <span class="o">:=</span> <span class="p">[]</span>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Load_Settings</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
      <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Initialize_Load_Savefile</span><span class="ss">()</span>
      
      <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Init_Validate_and_Prompt_User_if_Errors</span><span class="ss">()</span>

   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;======================================================================;</span>
<span class="c1">   ;     About Initialize_Load_Savefile()                                 ;</span>
<span class="c1">   ;======================================================================; </span></SUMMARY>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  ----------                                                          ;</span>
<span class="c1">   ;    First                                                             ;</span>
<span class="c1">   ;  ----------                                                          ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  When the script begins,                                             ;</span>
<span class="c1">   ;  the Auto-Execute section at the very beginning of this file         ;</span>
<span class="c1">   ;  initializes some global variables, then immediately calls           ;</span>
<span class="c1">   ;  FILE_HELPER.Load_Settings(), which then calls this function.        ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  Before Program Launcher can be useful, it needs to be initialized.  ;</span>
<span class="c1">   ;  Here, FILE_HELPER reads the settings file into memory.              ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  ---------------------------------------                             ;</span>
<span class="c1">   ;    Missing settings file? No problem.                                ;</span>
<span class="c1">   ;  ---------------------------------------                             ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  Initialize_Load_Savefile() will create a default savefile           ;</span>
<span class="c1">   ;  if the settings file does not exist.                                ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  For pre-existing and newly added savefiles,                         ;</span>
<span class="c1">   ;  the process from that point is identical.                           ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  -----------------------------                                       ;</span>
<span class="c1">   ;    What is initialized here?                                         ;</span>
<span class="c1">   ;  -----------------------------                                       ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  The settings file will be read into the program&#39;s memory:           ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;     (1) settings will be assigned                                    ;</span>
<span class="c1">   ;     (such as the icon to display in the notification area),          ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;     (2) hotkeys will be assigned,                                    ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;     (3) Commands will be registered with their Action to call        ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;     (4) Actions will be registered with their function to run.       ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  -----------------------------------------------------               ;</span>
<span class="c1">   ;    Comments a.k.a Ignored lines in the settings file                 ;</span>
<span class="c1">   ;  -----------------------------------------------------               ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  This parsing function will ignore                                   ;</span>
<span class="c1">   ;  any line beginning with a &#39;;&#39; in the settings file:                 ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;     (a) This allows the user to comment out sections of              ;</span>
<span class="c1">   ;     the settings file which they wish to keep,                       ;</span>
<span class="c1">   ;     but don&#39;t want to keep active.                                   ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;     (b) This comment/ignore-a-line feature                           ;</span>
<span class="c1">   ;     allows me to embed a tutorial into the settings file itself.     ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  ---------------------------------                                   ;</span>
<span class="c1">   ;    So how does the parsing work?                                     ;</span>
<span class="c1">   ;  ---------------------------------                                   ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  Initialize_Load_Savefile() will look for                            ;</span>
<span class="c1">   ;  three sections in the savefile:                                     ;</span>
<span class="c1">   ;  &quot;Settings[&quot;, &quot;Commands[&quot; and &quot;Actions[&quot;.                            ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  The ([) open square bracket must be                                 ;</span>
<span class="c1">   ;  on the same line as the section title (Section[).                   ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  Then there will be some lines following the start of a section      ;</span>
<span class="c1">   ;  which correspond to settings for that section.                      ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  Then each section ends with a line which contains nothing           ;</span>
<span class="c1">   ;  but a &quot;]&quot; close square bracket.                                     ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  For example, the default Settings section                           ;</span>
<span class="c1">   ;  in the settings file looks like this:                               ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;     SETTINGS[                                                        ;</span>
<span class="c1">   ;     icon: 95                                                         ;</span>
<span class="c1">   ;     hotkey_for_commandline_popup: ctrl win space                     ;</span>
<span class="c1">   ;     hotkey_for_quit: ctrl win alt q                                  ;</span>
<span class="c1">   ;     ]                                                                ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  Initialize_Load_Savefile() will keep track of which section         ;</span>
<span class="c1">   ;  it is currently parsing within,                                     ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;  and for each line it reads within a section,                        ;</span>
<span class="c1">   ;  it will call one of these and pass the current line as a parameter: ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;     Init_Parse_Savefile_SettingsLine( current_line )                 ;</span>
<span class="c1">   ;     Init_Parse_Savefile_CommandLine( current_line )                  ;</span>
<span class="c1">   ;     Init_Parse_Savefile_ActionLine( current_line )                   ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;======================================================================; </span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Initialize_Load_Savefile</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
   
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">         ===============================================</span>
<span class="cm">         Steps: </span>
<span class="cm">         ===============================================</span>
<span class="cm">         </span>
<span class="cm">         (1) See if Savefile exists.</span>
<span class="cm">         </span>
<span class="cm">         (2) Read Savefile into program memory </span>
<span class="cm">         </span>
<span class="cm">            (2.1) Ignore commented lines (any line beginning with a semicolon &#39;;&#39;)</span>
<span class="cm">            </span>
<span class="cm">            (2.2) Look for one of these sections:</span>
<span class="cm">               &#39;settings[&#39;</span>
<span class="cm">               &#39;commands[&#39;</span>
<span class="cm">               &#39;actions[&#39;</span>
<span class="cm">            </span>
<span class="cm">               (2.3) Parse each line as section </span>
<span class="cm">                    til matching line beginning with &#39;]&#39; </span>
<span class="cm">                    (and containing no other non-whitespace characters)</span>
<span class="cm">                    is found :</span>
<span class="cm">            </span>
<span class="cm">            (2.4) Repeat til all 3 items in (2.2) are searched for </span>
<span class="cm">         </span>
<span class="cm">         (3) Defaults &amp; Error Correction</span>
<span class="cm">         </span>
<span class="cm">            (3.1) if not (1), </span>
<span class="cm">            </span>
<span class="cm">                  Generate default savefile</span>
<span class="cm">                  Load default settings </span>
<span class="cm">            </span>
<span class="cm">            (3.2) if missing </span>
<span class="cm">                 settings:&#39;_hotkey_for_commandline_popup&#39;,</span>
<span class="cm">                 </span>
<span class="cm">                  Use default hotkey &lt;Ctrl+Win+Space&gt;</span>
<span class="cm">               </span>
<span class="cm">                 if unable to get hotkey from </span>
<span class="cm">                 settings:&#39;_hotkey_for_commandline_popup&#39;,</span>
<span class="cm">                 </span>
<span class="cm">                  Exit Application and inform user how to debug.</span>
<span class="cm">                  </span>
<span class="cm">                  (This behaviour is intended to prevent </span>
<span class="cm">                  pushing hotkey and overriding other AutoHotkey scripts.)</span>
<span class="cm">                  </span>
<span class="cm">            (3.3) if missing settings:&#39;icon&#39; </span>
<span class="cm">                 </span>
<span class="cm">                  Use default icon</span>
<span class="cm">            </span>
<span class="cm">            (3.4) if missing command for quit or settings, </span>
<span class="cm">                 </span>
<span class="cm">                  if no conflict with other user commands:</span>
<span class="cm">                     </span>
<span class="cm">                     Add Command:&#39;Quit&#39;:Quit</span>
<span class="cm">                     Add Command:&#39;Settings&#39;:Settings</span>
<span class="cm">                  </span>
<span class="cm">                  if user command conflicts with Quit or Settings</span>
<span class="cm">                  notify as soon as init done.</span>
<span class="cm">            </span>
<span class="cm">         Done.</span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------------------</span>
<span class="c1">      ;   Create Savefile if it doesn&#39;t exist.  </span>
<span class="c1">      ;-------------------------------------------</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span> <span class="kr">FileExist</span><span class="ss">(</span><span class="vc">_savefile_path</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;---------------------------------------------------------------</span>
<span class="c1">         ; Either 1st run, or user renamed, deleted, or moved savefile.</span>
<span class="c1">         ; Steps to take:</span>
<span class="c1">         ;</span>
<span class="c1">         ;    (1) init _savefile__default_content</span>
<span class="c1">         ;    (2)   create default save file </span>
<span class="c1">         ;---------------------------------------------------------------</span>
         
         <span class="nf">Default_Save_File</span><span class="ss">()</span><span class="c1"> ; located at the bottom of this file.</span>
         
         <span class="kr">FileAppend</span><span class="p">,</span> <span class="vi">%_savefile__default_content%</span><span class="p">,</span> <span class="vi">%_savefile_path%</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">      ;------------------------------------</span>
<span class="c1">      ;   Parse savefile into memory </span>
<span class="c1">      ;------------------------------------</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">FileExist</span><span class="ss">(</span><span class="vc">_savefile_path</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; data := &quot;&quot;</span>
<span class="c1">         ; FileRead, data, %_savefile_path%</span>


         
         <span class="n">str</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> </span>
<span class="c1">         </span>
<span class="c1">         ;-----------------------------------------------------------------------</span>
<span class="c1">         ; Parser&#39;s counter values:</span>
<span class="c1">         ;   0 when (section&quot;[&quot;) not encountered</span>
<span class="c1">         ;   1 when (section&quot;[&quot;) encountered and section lines being parsed</span>
<span class="c1">         ;   2 when (&quot;]&quot;) has been encountered and finished processing section</span>
<span class="c1">         ;-----------------------------------------------------------------------</span>
         
         <span class="n">counter_settings</span> <span class="o">:=</span> <span class="mi">0</span>
         <span class="n">counter_commands</span> <span class="o">:=</span> <span class="mi">0</span>
         <span class="n">counter_actions</span>  <span class="o">:=</span> <span class="mi">0</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;-------------------------------------------------------------</span>
<span class="c1">         ; For more information about Regular Expressions, see:</span>
<span class="c1">         ;</span>
<span class="c1">         ;  AHK Doc Pages:</span>
<span class="c1">         ;    https://www.autohotkey.com/docs/misc/RegEx-QuickRef.htm</span>
<span class="c1">         ;    https://www.autohotkey.com/docs/commands/RegExReplace.htm</span>
<span class="c1">         ;    https://www.autohotkey.com/docs/commands/RegExMatch.htm</span>
<span class="c1">         ;</span>
<span class="c1">         ;  Online RegEx Tester + Guide:</span>
<span class="c1">         ;    https://regex101.com/</span>
<span class="c1">         ;</span>
<span class="c1">         ;  jeeswg&#39;s RegEx Tutorial:</span>
<span class="c1">         ;    https://www.autohotkey.com/boards/viewtopic.php?t=28031</span>
<span class="c1">         ;</span>
<span class="c1">         ;-------------------------------------------------------------</span>
         
         <span class="n">match_lines_beginning_with_semi</span> <span class="o">:=</span> <span class="s">&quot;^[ \t]*[;].*&quot;</span>
         <span class="n">match_entirely_whitespace_lines</span> <span class="o">:=</span> <span class="s">&quot;^[ \t]*$&quot;</span>
         
         <span class="n">match_settings</span>          <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*SETTINGS[ \t]*\[[ \t]*$&quot;</span>
         <span class="n">match_commands</span>          <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*COMMANDS[ \t]*\[[ \t]*$&quot;</span>
         <span class="n">match_actions</span>          <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*ACTIONS[ \t]*\[[ \t]*$&quot;</span>
         <span class="n">match_close_set_group</span>    <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*\][ \t]*$&quot;</span>
         
            
         <span class="n">str_for_usr_output</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         
         <span class="n">FILE_HELPER</span><span class="o">.</span><span class="n">init__ar_duplicate_commands_found</span> <span class="o">:=</span> <span class="p">[]</span>
         <span class="n">FILE_HELPER</span><span class="o">.</span><span class="n">init__ar_duplicate_actions_found</span> <span class="o">:=</span> <span class="p">[]</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;---------------------------------------------</span>
<span class="c1">         ; Read _program_launcher_settings.ini, </span>
<span class="c1">         ; one line at a time.</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="n">Loop</span><span class="p">,</span> <span class="kr">Read</span><span class="p">,</span> <span class="vi">%_savefile_path%</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">is_comment</span> <span class="o">:=</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="p">,</span> <span class="n">match_lines_beginning_with_semi</span><span class="ss">)</span>
            <span class="n">is_empty</span>   <span class="o">:=</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="p">,</span> <span class="n">match_entirely_whitespace_lines</span><span class="ss">)</span>
            <span class="n">is_empty</span> <span class="o">:=</span> <span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="o">==</span><span class="s">&quot;&quot;</span> <span class="ow">or</span> <span class="n">is_empty</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ;--------------------------------------------------</span>
<span class="c1">            ; (;) comment encountered</span>
<span class="c1">            ; or empty line (with entirely whitespace characters) encountered</span>
<span class="c1">            ;</span>
<span class="c1">            ;    (;) at beginning of line or </span>
<span class="c1">            ;    any number of whitespace (anynum spaces and/or anynum tabs) then (;)</span>
<span class="c1">            ;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">is_comment</span> <span class="ow">or</span> <span class="n">is_empty</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="k">continue</span>
            <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ;----------------------------------------------------</span>
<span class="c1">            ; (settings[) encountered</span>
<span class="c1">            ;</span>
<span class="c1">            ;    (settings), case insensitive</span>
<span class="c1">            ;    followed by ([), spaces before, between, or after are ignored</span>
<span class="c1">            ;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="p">,</span> <span class="n">match_settings</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">counter_settings</span> <span class="o">==</span> <span class="mi">0</span> 
               <span class="ow">and</span> <span class="n">counter_actions</span>   <span class="o">!=</span> <span class="mi">1</span>
               <span class="ow">and</span> <span class="n">counter_commands</span>  <span class="o">!=</span> <span class="mi">1</span> <span class="ss">)</span>
               <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  ; Found &quot;Settings[&quot; &amp;&amp; not in the middle of &quot;Commands[&quot; nor &quot;Actions[&quot;</span>
                  <span class="n">counter_settings</span> <span class="o">:=</span> <span class="mi">1</span>
                  <span class="k">continue</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  ; either </span>
<span class="c1">                  ;         section actions[  is open but not closed</span>
<span class="c1">                  ;         section commands[ is open but not closed</span>
<span class="c1">                  ;         duplicate line settings[ encountered</span>
<span class="c1">                  ;           when section settings[ is either already open or finished </span>
               <span class="p">}</span></DETAILS>
            <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">            ;----------------------------------------------------</span>
<span class="c1">            ; (commands[) encountered</span>
<span class="c1">            ;</span>
<span class="c1">            ;    (commands), case insensitive</span>
<span class="c1">            ;    followed by ([), spaces before, between, or after are ignored</span>
<span class="c1">            ;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="p">,</span> <span class="n">match_commands</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>

<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">counter_commands</span> <span class="o">==</span> <span class="mi">0</span> 
               <span class="ow">and</span> <span class="n">counter_settings</span>  <span class="o">!=</span> <span class="mi">1</span>
               <span class="ow">and</span> <span class="n">counter_actions</span>   <span class="o">!=</span> <span class="mi">1</span> <span class="ss">)</span>
               <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  ; Found &quot;Commands[&quot; &amp;&amp; not in the middle of &quot;Settings[&quot; nor &quot;Actions[&quot;</span>
                  <span class="n">counter_commands</span> <span class="o">:=</span> <span class="mi">1</span>
                  <span class="k">continue</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  ; either </span>
<span class="c1">                  ;         section settings[ is open but not closed</span>
<span class="c1">                  ;         section actions[  is open but not closed</span>
<span class="c1">                  ;         duplicate line commands[ encountered</span>
<span class="c1">                  ;           when section commands[ is either already open or finished </span>
               <span class="p">}</span></DETAILS>
            <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">            ;----------------------------------------------------</span>
<span class="c1">            ; (actions[) encountered</span>
<span class="c1">            ;</span>
<span class="c1">            ;    (actions), case insensitive</span>
<span class="c1">            ;    followed by ([), spaces before, between, or after are ignored</span>
<span class="c1">            ;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="p">,</span> <span class="n">match_actions</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">counter_actions</span> <span class="o">==</span> <span class="mi">0</span> 
               <span class="ow">and</span> <span class="n">counter_commands</span> <span class="o">!=</span> <span class="mi">1</span>
               <span class="ow">and</span> <span class="n">counter_settings</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ss">)</span>
               <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  ; Found &quot;Actions[&quot; &amp;&amp; not in the middle of &quot;Commands[&quot; nor &quot;Settings[&quot;</span>
                  <span class="n">counter_actions</span> <span class="o">:=</span> <span class="mi">1</span>
                  <span class="k">continue</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  ; either </span>
<span class="c1">                  ;         section commands[  is open but not closed</span>
<span class="c1">                  ;         section settings[ is open but not closed</span>
<span class="c1">                  ;         duplicate line actions[ encountered</span>
<span class="c1">                  ;           when section actions[ is either already open or finished </span>
               <span class="p">}</span></DETAILS>
            <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ;----------------------------------</span>
<span class="c1">            ; (]) encountered while inside either</span>
<span class="c1">            ;</span>
<span class="c1">            ;    (settings[),</span>
<span class="c1">            ;    (commands[), or</span>
<span class="c1">            ;    (actions[)</span>
<span class="c1">            ;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="p">,</span> <span class="n">match_close_set_group</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">               </span>
<span class="c1">               ; ? set counter to 2 if just closed that section, </span>
<span class="c1">               ; : otherwise leave unaltered</span>
               <span class="n">counter_settings</span> <span class="o">:=</span> <span class="ss">(</span><span class="n">counter_settings</span><span class="o">==</span><span class="mi">1</span><span class="ss">)</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span> <span class="n">counter_settings</span>
               <span class="n">counter_commands</span> <span class="o">:=</span> <span class="ss">(</span><span class="n">counter_commands</span><span class="o">==</span><span class="mi">1</span><span class="ss">)</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span> <span class="n">counter_commands</span>
               <span class="n">counter_actions</span>  <span class="o">:=</span> <span class="ss">(</span><span class="n">counter_actions</span> <span class="o">==</span><span class="mi">1</span><span class="ss">)</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span> <span class="n">counter_actions</span>
            <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ;----------------------------------</span>
<span class="c1">            ; (anything else) encountered while inside either</span>
<span class="c1">            ;</span>
<span class="c1">            ;    (settings[),</span>
<span class="c1">            ;    (commands[), or</span>
<span class="c1">            ;    (actions[)</span>
<span class="c1">            ;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">counter_settings</span> <span class="o">==</span> <span class="mi">1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Init_Parse_Savefile_SettingsLine</span><span class="ss">(</span> <span class="nv">A_LoopReadLine</span> <span class="ss">)</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span>
               <span class="k">if</span><span class="ss">(</span> <span class="n">counter_commands</span> <span class="o">==</span> <span class="mi">1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Init_Parse_Savefile_CommandLine</span><span class="ss">(</span> <span class="nv">A_LoopReadLine</span> <span class="ss">)</span>
               <span class="p">}</span></DETAILS>
               
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span>
               <span class="k">if</span><span class="ss">(</span> <span class="n">counter_actions</span> <span class="o">==</span> <span class="mi">1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Init_Parse_Savefile_ActionLine</span><span class="ss">(</span> <span class="nv">A_LoopReadLine</span> <span class="ss">)</span>
               <span class="p">}</span></DETAILS>
            <span class="p">}</span></DETAILS>
            
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>         
   <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">   ;=================================;</span>
<span class="c1">   ;                                 ;</span>
<span class="c1">   ;      HELPER FUNCTIONS FOR       ;</span>
<span class="c1">   ;                                 ;</span>
<span class="c1">   ;    Initialize_Load_Savefile()   ;</span>
<span class="c1">   ;                                 ;</span>
<span class="c1">   ;=================================;</span>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Parse_Savefile_SettingsLine</span><span class="ss">(</span> <span class="n">full_line_text</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> <span class="vc">_ICON_INDEX</span>
   
      <span class="n">match_set_icon</span>      <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*icon[ \t]*:[ \t]*(\d+)[ \t]*$&quot;</span>
      <span class="n">match_set_hot_pop</span>   <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*hotkey_for_commandline_popup[ \t]*:[ \t]*((\w+[ \t]*)+)$&quot;</span>
      <span class="n">match_set_hot_quit</span>  <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*hotkey_for_quit[ \t]*:[ \t]*((\w+[ \t]*)+)$&quot;</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      ; extract text, ignoring leading spaces before first non-whitepace character</span>
      <span class="n">line</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="n">full_line_text</span><span class="p">,</span> <span class="s">&quot;(^[ \t]*)(.*)&quot;</span><span class="p">,</span> <span class="s">&quot;$2&quot;</span><span class="ss">)</span> 
      
      <span class="n">int_icon</span>     <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="n">line</span><span class="p">,</span> <span class="n">match_set_icon</span><span class="p">,</span>     <span class="s">&quot;$1&quot;</span><span class="p">,</span> <span class="n">found_icon</span><span class="ss">)</span>
      <span class="n">str_hot_pop</span>  <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="n">line</span><span class="p">,</span> <span class="n">match_set_hot_pop</span><span class="p">,</span>  <span class="s">&quot;$1&quot;</span><span class="p">,</span> <span class="n">found_pop</span> <span class="ss">)</span>
      <span class="n">str_hot_quit</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="n">line</span><span class="p">,</span> <span class="n">match_set_hot_quit</span><span class="p">,</span> <span class="s">&quot;$1&quot;</span><span class="p">,</span> <span class="n">found_quit</span><span class="ss">)</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">found_icon</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="vc">_ICON_INDEX</span> <span class="o">:=</span> <span class="n">int_icon</span> 
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">found_pop</span> 
      <span class="ow">or</span>       <span class="n">found_quit</span> <span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="n">which_hotkey</span> <span class="o">:=</span> <span class="ss">(</span><span class="n">found_pop</span><span class="ss">)</span> <span class="o">?</span> <span class="s">&quot;commandline_popup&quot;</span> <span class="o">:</span> <span class="s">&quot;quit&quot;</span>
         <span class="n">ssv_key_list</span> <span class="o">:=</span> <span class="ss">(</span><span class="n">found_pop</span><span class="ss">)</span> <span class="o">?</span> <span class="n">str_hot_pop</span> <span class="o">:</span> <span class="n">str_hot_quit</span><span class="c1"> </span>
<span class="c1">         ; ssv similar to csv, space separated values</span>
         
         <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Init_Parse_Settings_Hotkey</span><span class="ss">(</span><span class="n">which_hotkey</span><span class="p">,</span> <span class="n">ssv_key_list</span><span class="p">,</span> <span class="n">line</span><span class="ss">)</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Parse_Savefile_CommandLine</span><span class="ss">(</span> <span class="n">full_line_text</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> <span class="vc">_ACTIONS</span>
   <span class="nb">global</span> <span class="vc">_COMMANDS</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      ;-----------------------------</span>
<span class="c1">      ; Command syntax in savefile:</span>
<span class="c1">      ;</span>
<span class="c1">      ;    Command: decimal</span>
<span class="c1">      ;</span>
<span class="c1">      ; Example:</span>
<span class="c1">      ;</span>
<span class="c1">      ;   godot: 1</span>
<span class="c1">      ;-----------------------------</span>
<span class="c1">      </span>
<span class="c1">      ;---------------------------------------------------------------------</span>
<span class="c1">      ; Remove leading and trailing tabs around the &quot;Command:##&quot; phrase </span>
<span class="c1">      ;</span>
      <span class="n">line</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="n">full_line_text</span><span class="p">,</span> <span class="s">&quot;(^[ \t]*)(.*)[ \t]*$&quot;</span><span class="p">,</span> <span class="s">&quot;$2&quot;</span><span class="ss">)</span> 
      
      <span class="n">match_command_colon_actionID_optionallyAlsoDisableFlag</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
        <span class="o">.</span> <span class="s">&quot;i)^[ \t]*(\\BEGIN_LITERAL\\)?(.*)\:[ \t]*(QUIT|SETTINGS|[\d]+)[ \t]*(DISABLED|disable|;|x)?$&quot;</span>

      
      <span class="kr">RegExMatch</span><span class="ss">(</span> <span class="n">line</span>
              <span class="p">,</span> <span class="n">match_command_colon_actionID_optionallyAlsoDisableFlag</span>
              <span class="p">,</span> <span class="n">matched_subpattern_</span> <span class="ss">)</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------------------------------------------</span>
<span class="c1">      ; `matched_subpattern_1` is just to catch the flag &quot;\BEGIN_LITERAL\&quot;</span>
<span class="c1">      ; which tells parser to include spaces after the flag</span>
<span class="c1">      ; as part of the Command&#39;s text.</span>
<span class="c1">      ;--------------------------------------------------------------------</span>
      
      <span class="n">cmd</span>          <span class="o">:=</span> <span class="n">matched_subpattern_2</span>
      <span class="n">aID</span>          <span class="o">:=</span> <span class="n">matched_subpattern_3</span>
      <span class="n">disable_flag</span> <span class="o">:=</span> <span class="n">matched_subpattern_4</span>
      
      <span class="n">cmd_enabled</span> <span class="o">:=</span> <span class="nv">true</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;DISABLE&quot;</span> <span class="o">=</span> <span class="n">disable_flag</span>
      <span class="ow">or</span> <span class="s">&quot;Disabled&quot;</span> <span class="o">=</span> <span class="n">disable_flag</span>
      <span class="ow">or</span> <span class="s">&quot;;&quot;</span> <span class="o">=</span> <span class="n">disable_flag</span>
      <span class="ow">or</span> <span class="s">&quot;x&quot;</span> <span class="o">=</span> <span class="n">disable_flag</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">cmd_enabled</span> <span class="o">:=</span> <span class="nv">false</span>
      <span class="p">}</span></DETAILS>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_COMMANDS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">cmd</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; add to list of things to notify user about</span>
         
         <span class="n">FILE_HELPER</span><span class="o">.</span><span class="n">init__ar_duplicate_commands_found</span><span class="o">.</span><span class="nn">Push</span><span class="ss">(</span> <span class="p">{</span><span class="s">&quot;cmd&quot;</span><span class="o">:</span><span class="n">cmd</span><span class="p">,</span> <span class="s">&quot;line&quot;</span><span class="o">:</span><span class="n">line</span><span class="p">}</span> <span class="ss">)</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">cmd</span><span class="p">]</span> <span class="o">:=</span> <span class="p">{</span> <span class="s">&quot;action_id&quot;</span><span class="o">:</span><span class="n">aID</span><span class="p">,</span> <span class="s">&quot;enabled&quot;</span><span class="o">:</span><span class="n">cmd_enabled</span> <span class="p">}</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; debug_output :=  &quot;Command matched`n &quot;</span>
<span class="c1">      ; debug_output  .= &quot;1 [&quot; matched_subpattern_1 &quot;] `n &quot;</span>
<span class="c1">      ; debug_output  .= &quot;2 [&quot; matched_subpattern_2 &quot;] `n &quot;</span>
<span class="c1">      ; debug_output  .= &quot;3 [&quot; matched_subpattern_3 &quot;] `n &quot;</span>
<span class="c1">      ; debug_output  .= &quot;4 [&quot; cmd_enabled &quot;] `n &quot;</span>
<span class="c1">      ; msgBOX % debug_output</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Parse_Savefile_ActionLine</span><span class="ss">(</span> <span class="n">full_line_text</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> <span class="vc">_ACTIONS</span>
   <span class="nb">global</span> <span class="vc">_COMMANDS</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">   </span>
<span class="c1">      ;--------------------------------------------------------------------</span>
<span class="c1">      ; Command syntax in savefile:</span>
<span class="c1">      ;</span>
<span class="c1">      ;    Action, Folder or File, &quot;Path&quot;, (Optionally &quot;arguments&quot; if file)</span>
<span class="c1">      ;</span>
<span class="c1">      ; Example:</span>
<span class="c1">      ;</span>
<span class="c1">      ;   1, Folder, &quot;C:/[Godot]/&quot;</span>
<span class="c1">      ;--------------------------------------------------------------------</span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------------------------------</span>
<span class="c1">      ; Get contents of line without leading spaces and tabs.</span>
<span class="c1">      ;</span>
      <span class="n">line</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="n">full_line_text</span><span class="p">,</span> <span class="s">&quot;(^[ \t]*)(.*)[ \t]*$&quot;</span><span class="p">,</span> <span class="s">&quot;$2&quot;</span><span class="ss">)</span><span class="c1"> </span>
<span class="c1">      </span>
<span class="c1">                    ;-------------------------------------------</span>
      <span class="n">ch_quote</span> <span class="o">:=</span> <span class="s">&quot;</span><span class="se">&quot;&quot;</span><span class="s">&quot;</span><span class="c1">  ; AutoHotkey Info:</span>
<span class="c1">                    ;-------------------------------------------</span>
<span class="c1">                    ; Two quotes not separated by a space (&quot;&quot;) </span>
<span class="c1">                    ; within a string resolves to a single (&quot;).</span>
<span class="c1">                    ; Added this var for improved readability.</span>
<span class="c1">                    ;-------------------------------------------</span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------------------------</span>
<span class="c1">      ; RegEx Key </span>
<span class="c1">      ;-----------------------------------------------------------------------</span>
<span class="c1">      ; ? quantifier: match preceeding token zero or one times </span>
<span class="c1">      ; * quantifier: match preceeding token zero or more times </span>
<span class="c1">      ; [ \t]       : match a character from this group, space or tab </span>
<span class="c1">      ; [\d]        : match any decimal digit, 0-9</span>
<span class="c1">      ; [^&quot;]        : match any character which is not a quote character (&quot;)</span>
<span class="c1">      ; a|bc|d      : match if find one case from the|alternatives|list</span>
<span class="c1">      ;-----------------------------------------------------------------------</span>
      
      <span class="n">match_program_launcher_behaviour_action</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"></span>
<span class="c1">        ; match either SETTINGS or QUIT (case insensitive from the &quot;i)&quot; flag)</span>
<span class="c1">        ; surrounded by zero or more spaces and tabs </span>
<span class="c1">        ; and nothing else on the line.</span>
        <span class="o">.</span> <span class="s">&quot;i)^[ \t]*(SETTINGS|QUIT)[ \t]*$&quot;</span>
         
      <span class="n">match_csv_actionID_appOrFolder_path_optionallyAlsoArg</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">        ; match leading spaces and tabs ([ \t]), zero or more (*)</span>
        <span class="o">.</span> <span class="s">&quot;i)^[ \t]*&quot;</span><span class="c1">     </span>
<span class="c1">        </span>
<span class="c1">        ; match ActionID, integer digits ([\d]) one or more (+)</span>
        <span class="o">.</span> <span class="s">&quot;([\d]+)&quot;</span><span class="c1">       </span>
<span class="c1">        ;  ^  $captureGroup1</span>
<span class="c1">        </span>
<span class="c1">        ; match comma (,) after ActionID</span>
<span class="c1">        ; surrounded by zero or more (*) spaces and tabs ([ \t])</span>
        <span class="o">.</span> <span class="s">&quot;[ \t]*,[ \t]*&quot;</span><span class="c1"> </span>
<span class="c1">        </span>
<span class="c1">        ; match ActionType (case insensitive from the &quot;i)&quot; flag)</span>
<span class="c1">        ; if this position contains one|of|the|following</span>
        <span class="o">.</span> <span class="s">&quot;(Folder|Application|App)&quot;</span><span class="c1"></span>
<span class="c1">        ;  ^  $captureGroup2</span>
<span class="c1">        </span>
<span class="c1">        ; match comma (,) after ActionType</span>
<span class="c1">        ; surrounded by zero or more (*) spaces and tabs ([ \t])</span>
        <span class="o">.</span> <span class="s">&quot;[ \t]*,[ \t]*&quot;</span><span class="c1"> </span>
<span class="c1">        </span>
<span class="c1">        ; match </span>
<span class="c1">        ;    (&quot;) quote character,</span>
<span class="c1">        ;    then any number(*) of non-quote characters ([^&quot;]), </span>
<span class="c1">        ;    then (&quot;) quote character</span>
        <span class="o">.</span> <span class="n">ch_quote</span> <span class="s">&quot;([^&quot;</span> <span class="n">ch_quote</span> <span class="s">&quot;]*)&quot;</span> <span class="n">ch_quote</span><span class="c1">  </span>
<span class="c1">        ;           ^  $captureGroup3</span>
<span class="c1">        </span>
<span class="c1">        ; (capture group 4)</span>
<span class="c1">        ; (match comma (,) after ActionPath</span>
<span class="c1">        ;  surrounded by zero or more (*) spaces and tabs ([ \t])</span>
<span class="c1">        ;  then match anything else (.*) til the end of the line)</span>
<span class="c1">        ; ) and find this parenthesized pattern exactly zero or one times (?) </span>
        <span class="o">.</span> <span class="s">&quot;([ \t]*,[ \t]*(.*))?$&quot;</span><span class="c1"></span>
<span class="c1">        ;                ^  $captureGroup5</span>
<span class="c1">        </span>

<span class="c1">      ;---------------------------------------------------------------</span>
<span class="c1">      ; Equivalent to assigining from this string:</span>
<span class="c1">      ;</span>
<span class="c1">      ;    match_csv_actionID_appOrFolder_path_optionallyAlsoArg := &quot;&quot;</span>
<span class="c1">      ;</span>
<span class="c1">      ;    . &quot;i)^[ \t]*([\d]+)[ \t]*,[ \t]*(Folder|Application|App)[ \t]*,&quot;</span>
<span class="c1">      ;    .   &quot;[ \t]*&quot;&quot;([^&quot;&quot;]*)&quot;&quot;([ \t]*,[ \t]*(.*)[ \t]*)?$&quot;</span>
<span class="c1">      ;</span>
<span class="c1">      ;---------------------------------------------------------------</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">found_match</span> <span class="o">:=</span> <span class="kr">RegExMatch</span><span class="ss">(</span> <span class="n">line</span>
              <span class="p">,</span> <span class="n">match_csv_actionID_appOrFolder_path_optionallyAlsoArg</span>
              <span class="p">,</span> <span class="n">matched_subpattern_</span> <span class="ss">)</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="n">aID</span>            <span class="o">:=</span> <span class="n">matched_subpattern_1</span>
         <span class="n">appOrFolder</span>    <span class="o">:=</span> <span class="n">matched_subpattern_2</span>
         <span class="n">aPathUnquoted</span>  <span class="o">:=</span> <span class="n">matched_subpattern_3</span>
         <span class="n">aArg</span>           <span class="o">:=</span> <span class="n">matched_subpattern_5</span>
              
         <span class="n">appOrFolder</span> <span class="o">:=</span> <span class="ss">(</span>   <span class="n">appOrFolder</span> <span class="o">=</span>  <span class="s">&quot;Application&quot;</span>
                     <span class="ow">or</span> <span class="n">appOrFolder</span> <span class="o">==</span> <span class="s">&quot;App&quot;</span>         <span class="ss">)</span> 
                        <span class="o">?</span> <span class="s">&quot;app&quot;</span> 
                        <span class="o">:</span> <span class="n">appOrFolder</span>
         <span class="n">appOrFolder</span> <span class="o">:=</span> <span class="ss">(</span>   <span class="n">appOrFolder</span> <span class="o">==</span>  <span class="s">&quot;Folder&quot;</span> <span class="ss">)</span> 
                        <span class="o">?</span> <span class="s">&quot;folder&quot;</span> 
                        <span class="o">:</span> <span class="n">appOrFolder</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="n">aPathUnquoted</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="nl">aPathUnquoted:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Fn_Standardize_Path_String</span><span class="ss">(</span><span class="n">aPathUnquoted</span><span class="p">,</span> <span class="n">appOrFolder</span><span class="ss">)</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span>
      <span class="k">if</span><span class="ss">(</span> <span class="n">found_match</span> <span class="o">:=</span> <span class="kr">RegExMatch</span><span class="ss">(</span> <span class="n">line</span>
            <span class="p">,</span> <span class="n">match_program_launcher_behaviour_action</span>
            <span class="p">,</span> <span class="n">matched_subpattern_</span> <span class="ss">)</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="n">aID</span>            <span class="o">:=</span> <span class="n">matched_subpattern_1</span>
         <span class="n">appOrFolder</span>    <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">aPathUnquoted</span>  <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">aArg</span>           <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">aID</span> <span class="o">=</span> <span class="s">&quot;quit&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">aID</span> <span class="o">:=</span> <span class="s">&quot;QUIT&quot;</span>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> 
         <span class="k">if</span><span class="ss">(</span> <span class="n">aID</span> <span class="o">=</span> <span class="s">&quot;settings&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">aID</span> <span class="o">:=</span> <span class="s">&quot;SETTINGS&quot;</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">aID</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; add to list of things to notify user about</span>
         <span class="n">FILE_HELPER</span><span class="o">.</span><span class="n">init__ar_duplicate_actions_found</span><span class="o">.</span><span class="nn">Push</span><span class="ss">(</span> <span class="p">{</span><span class="s">&quot;action_id&quot;</span><span class="o">:</span><span class="n">aID</span><span class="p">,</span> <span class="s">&quot;line&quot;</span><span class="o">:</span><span class="n">line</span><span class="p">}</span> <span class="ss">)</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">aID</span><span class="p">]</span> <span class="o">:=</span> <span class="p">{</span> <span class="s">&quot;&quot;</span>
            <span class="o">.</span>   <span class="s">&quot;type&quot;</span> <span class="o">:</span> <span class="n">appOrFolder</span>
             <span class="p">,</span>  <span class="s">&quot;path&quot;</span> <span class="o">:</span> <span class="n">aPathUnquoted</span> 
             <span class="p">,</span>  <span class="s">&quot;arg&quot;</span>  <span class="o">:</span> <span class="n">aArg</span>          <span class="p">}</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; debug_output :=  &quot;Action matched`n &quot;</span>
<span class="c1">      ; debug_output  .= &quot;1 [&quot; matched_subpattern_1 &quot;] `n &quot;</span>
<span class="c1">      ; debug_output  .= &quot;2 [&quot; matched_subpattern_2 &quot;] `n &quot;</span>
<span class="c1">      ; debug_output  .= &quot;3 [&quot; matched_subpattern_3 &quot;] `n &quot;</span>
<span class="c1">      ; debug_output  .= &quot;4 [&quot; matched_subpattern_5 &quot;] `n &quot;</span>
<span class="c1">      ; msgBOX % debug_output</span>

      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Parse_Settings_Hotkey</span><span class="ss">(</span> <span class="n">hotkey_for</span><span class="o">:=</span><span class="s">&quot;commandline_popup|quit&quot;</span>
      <span class="p">,</span> <span class="n">ssv_key_list</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
      <span class="p">,</span> <span class="n">full_line</span><span class="o">:=</span><span class="s">&quot;&quot;</span> <span class="ss">)</span>
   <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   
   <span class="nb">global</span> <span class="vc">_hotkey_for_commandline_popup</span>
   <span class="nb">global</span> <span class="vc">_hotkey_for_settings</span>
   <span class="nb">global</span> <span class="vc">_hotkey_for_reload</span>
   <span class="nb">global</span> <span class="vc">_hotkey_for_quit</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">   </span>
<span class="c1">      ;--------------------------------------------------------------------</span>
<span class="c1">      ; Called exclusively from Initialize_Settings_And_Load_Saved_Commands</span>
<span class="c1">      ; p1: hotkey is either for quit or commandline popup</span>
<span class="c1">      ; p2: space sperated value list of keys to use for hotkey</span>
<span class="c1">      ; p3: currently parsed line of text from the savefile</span>
<span class="c1">      ;--------------------------------------------------------------------</span>
      
      <span class="n">found_shift</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">found_ctrl</span>  <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">found_win</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">found_alt</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">found_key</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">error_msg__changingInvalidHotkey</span>   <span class="o">:=</span> <span class="nv">false</span> 
      
      <span class="n">str_for_output__all_found</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="n">Loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">ssv_key_list</span><span class="p">,</span> <span class="vi">%A_Tab%%A_Space%</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;SHIFT&quot;</span><span class="ss">)</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">found_shift</span> <span class="o">:=</span> <span class="s">&quot;+&quot;</span>
            
            <span class="n">str_for_output__all_found</span> <span class="o">.=</span> <span class="s">&quot;shift &quot;</span>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;CTRL&quot;</span>
         <span class="ow">or</span>  <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;control&quot;</span> <span class="ss">)</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">found_ctrl</span> <span class="o">:=</span> <span class="s">&quot;^&quot;</span>
            
            <span class="n">str_for_output__all_found</span> <span class="o">.=</span> <span class="s">&quot;ctrl &quot;</span>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;WIN&quot;</span>
         <span class="ow">or</span>  <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;WINKEY&quot;</span> 
         <span class="ow">or</span>  <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;WINDOWS&quot;</span> 
         <span class="ow">or</span>  <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;WINDOWSKEY&quot;</span> <span class="ss">)</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">found_win</span> <span class="o">:=</span> <span class="s">&quot;#&quot;</span>
            
            <span class="n">str_for_output__all_found</span> <span class="o">.=</span> <span class="s">&quot;win &quot;</span>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;ALT&quot;</span> <span class="ss">)</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">found_alt</span> <span class="o">:=</span> <span class="s">&quot;!&quot;</span>
            
            <span class="n">str_for_output__all_found</span> <span class="o">.=</span> <span class="s">&quot;alt &quot;</span>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">found_key</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="ss">)</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">found_key</span> <span class="o">:=</span> <span class="nv">A_LoopField</span>
            <span class="n">str_for_output__all_found</span> <span class="o">.=</span> <span class="n">found_key</span> <span class="s">&quot; &quot;</span>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">error_msg__changingInvalidHotkey</span> <span class="o">:=</span> <span class="nv">true</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;---------------------------------------</span>
<span class="c1">      ; if no modifiers, exit app for safety</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">If</span><span class="ss">(</span> <span class="n">found_shift</span> <span class="o">==</span> <span class="s">&quot;&quot;</span>
      <span class="ow">and</span> <span class="n">found_ctrl</span>  <span class="o">==</span> <span class="s">&quot;&quot;</span>
      <span class="ow">and</span> <span class="n">found_win</span>   <span class="o">==</span> <span class="s">&quot;&quot;</span>
      <span class="ow">and</span> <span class="n">found_alt</span>   <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">found_key</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------</span>
<span class="c1">      ; Hotkey successfully found</span>
<span class="c1">      ;  or successfully assigned by fudging away additional keys</span>
<span class="c1">      ;   </span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">found_key</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">hotkey_for_fn_will_be</span> <span class="o">:=</span> <span class="n">found_shift</span> 
                            <span class="o">.</span>  <span class="n">found_ctrl</span>
                            <span class="o">.</span>  <span class="n">found_win</span>
                            <span class="o">.</span>  <span class="n">found_alt</span>
                            <span class="o">.</span>  <span class="n">found_key</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;-----------------------------------------------------------------------</span>
<span class="c1">         ; Hotkey list had more than one key which wasn&#39;t a modifier key (+^#!).</span>
<span class="c1">         ;</span>
<span class="c1">         ; Use any modifiers listed, and the first encountered non-modifier key.</span>
<span class="c1">         ;</span>
<span class="c1">         ;  </span>
<span class="c1">         ;  For example,</span>
<span class="c1">         ;</span>
<span class="c1">         ;     _hotkey_for_quit: ctrl win q u i t </span>
<span class="c1">         ;</span>
<span class="c1">         ;  would be condensed to,</span>
<span class="c1">         ;   </span>
<span class="c1">         ;     _hotkey_for_quit: ctrl win q</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">error_msg__changingInvalidHotkey</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">str_which</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="n">hotkey_for</span> <span class="o">==</span><span class="s">&quot;commandline_popup&quot;</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="n">str_which</span> <span class="o">:=</span>  <span class="s">&quot;_hotkey_for_commandline_popup&quot;</span>
            <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="n">hotkey_for</span> <span class="o">==</span><span class="s">&quot;quit&quot;</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="n">str_which</span> <span class="o">:=</span>  <span class="s">&quot;_hotkey_for_quit&quot;</span>
            <span class="p">}</span></DETAILS>
            <span class="n">str_for_usr_output</span> <span class="o">:=</span> <span class="s">&quot;program_launcher.ahk</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;--------------</span><span class="se">`n</span><span class="s">Oops</span><span class="se">`n</span><span class="s">--------------</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Your ( &quot;</span> <span class="n">str_which</span> <span class="s">&quot; ) line</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;in _program_launcher_settings.ini</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;has more than one non-modifier key.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;This would take a lot more code to account for.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Your settings file says:</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;   &quot;</span> <span class="n">full_line</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;program_launcher.ahk will pretend it says:</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;   &quot;</span> <span class="n">str_which</span> <span class="s">&quot;: &quot;</span> <span class="n">str_for_output__all_found</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;This hotkey will be reassigned to:.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;   &quot;</span> <span class="o">.</span> <span class="n">hotkey_for_fn_will_be</span> <span class="o">.</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;---------------------</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Modifier keys:</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;---------------------</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;[+] = Shift</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;[^] = Control</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;[#] = Win</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;[ ! ] = Alt</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;See: https://www.autohotkey.com/docs/KeyList.htm</span><span class="se">`n`n</span><span class="s">&quot;</span>
            
            <span class="n">title</span> <span class="o">:=</span> <span class="s">&quot;[Error] Hotkey for Popup [in _program_launcher_settings.ini]&quot;</span>
            <span class="kr">MSGBOX</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="vi">%title%</span><span class="p">,</span> <span class="vi">%str_for_usr_output%</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      ;-------------------------------</span>
<span class="c1">      ; Hotkey parse failure</span>
<span class="c1">      ; </span>
<span class="c1">      ;   ExitApp if it was the popup hotkey </span>
<span class="c1">      ;   Ignore and continue with no hotkey for others</span>
<span class="c1">      ;   </span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">hotkey_for</span> <span class="o">==</span> <span class="s">&quot;commandline_popup&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">str_for_usr_output</span> <span class="o">:=</span> <span class="s">&quot;program_launcher.ahk</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;--------------</span><span class="se">`n</span><span class="s">[ERROR]</span><span class="se">`n</span><span class="s">--------------</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Couldn&#39;t process the setting </span><span class="se">&quot;&quot;</span><span class="s">_hotkey_for_commandline_popup</span><span class="se">&quot;&quot;`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;in _program_launcher_settings.ini</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;program_launcher.ahk expects a line like this:</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;  settings[</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;    _hotkey_for_commandline_popup: ctrl win space</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;  ]</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;With one or more modifier keys and one non-modifier.</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;See https://www.autohotkey.com/docs/KeyList.htm</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;See details in program_launcher.ahk or </span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;_program_launcher_settings.ini for help.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;If you can&#39;t get it to work,</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;try removing the entire line beginning with </span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;   _hotkey_for_commandline_popup: (...)</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;and the default setting </span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;   Control Win Space</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;will be used.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Program will now exit, sorry.</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="kr">MSGBOX</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="p">[</span> <span class="n">FATAL</span> <span class="n">ERROR</span> <span class="p">],</span> <span class="o">%</span> <span class="n">str_for_usr_output</span>
            
            <span class="kr">ExitApp</span>
         <span class="p">}</span></DETAILS>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">hotkey_for</span> <span class="o">==</span> <span class="s">&quot;quit&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">str_for_usr_output</span> <span class="o">:=</span> <span class="s">&quot;program_launcher.ahk</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;--------------</span><span class="se">`n</span><span class="s">Oops</span><span class="se">`n</span><span class="s">--------------</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Couldn&#39;t process the setting </span><span class="se">&quot;&quot;</span><span class="s">_hotkey_for_quit</span><span class="se">&quot;&quot;`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;in _program_launcher_settings.ini</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;program_launcher.ahk expects a line like this:</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;  settings[</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;    _hotkey_for_quit: ctrl win q</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;  ]</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;With one or more modifier keys and one non-modifier.</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;See https://www.autohotkey.com/docs/KeyList.htm</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;See details in program_launcher.ahk or </span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;_program_launcher_settings.ini for help.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;If you can&#39;t get program_launcher.ahk to run</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;and you don&#39;t care about having a Quit hotkey,</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;try removing the entire line beginning with: </span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;   _hotkey_for_commandline_popup: (...)</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Alternatively this line should work:</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;   _hotkey_for_commandline_popup: ctrl win q</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Program will continue,</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;with no hotkey assigned to Quit.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;To Exit:</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Right-click the Notification Tray icon</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;and choose quit.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            
            <span class="n">title</span> <span class="o">:=</span> <span class="s">&quot;[X] Couldn&#39;t read line _hotkey_for_quit in settings file&quot;</span>
            <span class="kr">MSGBOX</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="o">%</span> <span class="n">title</span><span class="p">,</span> <span class="o">%</span> <span class="n">str_for_usr_output</span>
            
            <span class="kr">ExitApp</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------</span>
<span class="c1">      ; Hotkey assignment, </span>
<span class="c1">      ; and save var for use elsewhere.</span>
<span class="c1">      ;   </span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">hotkey_for</span> <span class="o">==</span> <span class="s">&quot;commandline_popup&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="vc">_hotkey_for_commandline_popup</span> <span class="o">:=</span> <span class="n">hotkey_for_fn_will_be</span>
         <span class="kr">Hotkey</span><span class="p">,</span> <span class="vi">%_hotkey_for_commandline_popup%</span><span class="p">,</span> <span class="n">ProgramLauncherPopupCommand</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">hotkey_for</span> <span class="o">==</span> <span class="s">&quot;quit&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="vc">_hotkey_for_quit</span> <span class="o">:=</span> <span class="n">hotkey_for_fn_will_be</span>
         <span class="kr">Hotkey</span><span class="p">,</span> <span class="vi">%_hotkey_for_quit%</span><span class="p">,</span> <span class="n">ProgramLauncherQuit</span>
      <span class="p">}</span></DETAILS>

      
      
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Validate_and_Prompt_User_if_Errors</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
      
      <span class="n">ar_commands_without_valid_actions</span> <span class="o">:=</span> <span class="p">[]</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------------------------------------</span>
<span class="c1">      ; If user hasn&#39;t defined &quot;SETTINGS&quot; or &quot;QUIT&quot; as an action, </span>
<span class="c1">      ; that&#39;s okay, add them manually here to make both available.</span>
<span class="c1">      ;</span>
<span class="c1">      ; Do this before checking Commands for valid actions.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="s">&quot;SETTINGS&quot;</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="vc">_ACTIONS</span><span class="p">[</span><span class="s">&quot;SETTINGS&quot;</span><span class="p">]</span> <span class="o">:=</span> <span class="p">{</span> <span class="s">&quot;&quot;</span>
            <span class="o">.</span>   <span class="s">&quot;type&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span>
             <span class="p">,</span>  <span class="s">&quot;path&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span> 
             <span class="p">,</span>  <span class="s">&quot;arg&quot;</span>  <span class="o">:</span> <span class="s">&quot;&quot;</span>     <span class="p">}</span>     
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="s">&quot;QUIT&quot;</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="vc">_ACTIONS</span><span class="p">[</span><span class="s">&quot;QUIT&quot;</span><span class="p">]</span> <span class="o">:=</span> <span class="p">{</span> <span class="s">&quot;&quot;</span>
            <span class="o">.</span>   <span class="s">&quot;type&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span>
             <span class="p">,</span>  <span class="s">&quot;path&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span> 
             <span class="p">,</span>  <span class="s">&quot;arg&quot;</span>  <span class="o">:</span> <span class="s">&quot;&quot;</span> <span class="p">}</span>    
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;----------------------------------------------------------------</span>
<span class="c1">      ; Now that all the Commands have been read from the savefile.ini </span>
<span class="c1">      ; if any Command links to a non-existant Action </span>
<span class="c1">      ; remove the Command and notify the user.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">for</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">cmd_dat</span> <span class="ow">in</span> <span class="vc">_COMMANDS</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
         <span class="n">aID</span> <span class="o">:=</span> <span class="n">cmd_dat</span><span class="p">[</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">aID</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">ar_commands_without_valid_actions</span><span class="o">.</span><span class="nn">Push</span><span class="ss">(</span><span class="n">cmd</span><span class="ss">)</span>
            <span class="vc">_COMMANDS</span><span class="o">.</span><span class="kp">Delete</span><span class="ss">(</span><span class="n">cmd</span><span class="ss">)</span>
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------------------------------------------</span>
<span class="c1">      ; If any Command phrases were encountered more than once </span>
<span class="c1">      ; parser ignored the duplicates above, and made a list of them.</span>
<span class="c1">      ; </span>
<span class="c1">      ; Inform the user which entry was imported, and which were ignored.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="n">init__ar_duplicate_commands_found</span><span class="o">.</span><span class="nn">Count</span><span class="ss">()</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>

         <span class="n">ar_valid_cmds</span>    <span class="o">:=</span> <span class="p">{}</span><span class="c1">     ; only used here temporarily</span>
         <span class="n">str_valid_cmds</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">str_invalid_cmds</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;-----------------------------------------------------------------------</span>
<span class="c1">         ; Get a list of all valid Commands (which also have ignored duplicates)</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dupe</span> <span class="ow">in</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="n">init__ar_duplicate_commands_found</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            ; FILE_HELPER.init__ar_duplicate_commands_found.Push( {&quot;cmd&quot;:cmd, &quot;line&quot;:line} )</span>
            
            <span class="n">dupeCmd</span>  <span class="o">:=</span> <span class="n">dupe</span><span class="p">[</span><span class="s">&quot;cmd&quot;</span><span class="p">]</span>
            <span class="n">dupeLine</span> <span class="o">:=</span> <span class="n">dupe</span><span class="p">[</span><span class="s">&quot;line&quot;</span><span class="p">]</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="n">ar_valid_cmds</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">dupeCmd</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               
               <span class="n">str_valid_cmds</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`t</span><span class="s">&quot;</span>
               <span class="n">str_valid_cmds</span>  <span class="o">.=</span> <span class="n">dupeCmd</span> <span class="s">&quot;: &quot;</span> 
               <span class="n">str_valid_cmds</span>  <span class="o">.=</span> <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">dupeCmd</span><span class="p">][</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span> <span class="s">&quot; &quot;</span>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">false</span> <span class="o">==</span> <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">dupeCmd</span><span class="p">][</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">str_valid_cmds</span>  <span class="o">.=</span> <span class="s">&quot;DISABLED&quot;</span>
               <span class="p">}</span></DETAILS>
               <span class="n">str_valid_cmds</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
               <span class="n">ar_valid_cmds</span><span class="p">[</span> <span class="n">dupeCmd</span> <span class="p">]</span> <span class="o">:=</span> <span class="nv">true</span>
            <span class="p">}</span></DETAILS>
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">         ;-------------------------------------------------</span>
<span class="c1">         ; Get a list of all the ignored invalid Commands </span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dupe</span> <span class="ow">in</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="n">init__ar_duplicate_commands_found</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">str_invalid_cmds</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`t</span><span class="s">&quot;</span> <span class="n">dupe</span><span class="p">[</span><span class="s">&quot;line&quot;</span><span class="p">]</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;----------------------------------;</span>
<span class="c1">         ;          Inform user             ;</span>
<span class="c1">         ;                                  ;</span>
         <span class="n">msg_for_usr</span> <span class="o">:=</span>  <span class="s">&quot;program_launcher.ahk</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;--------------</span><span class="se">`n</span><span class="s">Oops</span><span class="se">`n</span><span class="s">--------------</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;Duplicate Commands were found.</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;The first time a Command is found, it&#39;s kept. </span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;The following Commands were loaded:</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="n">str_valid_cmds</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">The following duplicate lines were ignored:</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="n">str_invalid_cmds</span>
         
         <span class="kr">Msgbox</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="n">Error</span> <span class="ow">in</span> <span class="n">Settings</span><span class="o">.</span><span class="n">ini</span><span class="p">,</span> <span class="vi">%msg_for_usr%</span>
      
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; [~]  TODO </span>
<span class="c1">      ;</span>
<span class="c1">      ; Some Actions have identical configurations.</span>
<span class="c1">      ;</span>
<span class="c1">      ; Would you like to remove the duplicates?</span>
<span class="c1">      ;</span>
<span class="c1">      ; (Any Command which references a duplicate Action</span>
<span class="c1">      ;  will be rewired to the resulting unique Action.)</span>

<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="n">init__ar_duplicate_actions_found</span><span class="o">.</span><span class="nn">Count</span><span class="ss">()</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>

         <span class="n">ar_valid_acts</span>    <span class="o">:=</span> <span class="p">{}</span>
         <span class="n">str_valid_acts</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">str_invalid_acts</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         
         <span class="n">ch_quote</span> <span class="o">:=</span> <span class="s">&quot;</span><span class="se">&quot;&quot;</span><span class="s">&quot;</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dupe</span> <span class="ow">in</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="n">init__ar_duplicate_actions_found</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">            ; FILE_HELPER.init__ar_duplicate_actions_found.Push( {&quot;action_id&quot;:aID, &quot;line&quot;:line} )</span>
            
            <span class="n">dupeAct</span>  <span class="o">:=</span> <span class="n">dupe</span><span class="p">[</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span>
            <span class="n">dupeLine</span> <span class="o">:=</span> <span class="n">dupe</span><span class="p">[</span><span class="s">&quot;line&quot;</span><span class="p">]</span>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="n">ar_valid_acts</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">dupeAct</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               
               <span class="n">str_valid_acts</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`t</span><span class="s">&quot;</span>
               <span class="n">str_valid_acts</span>  <span class="o">.=</span> <span class="n">dupeAct</span> <span class="s">&quot;, &quot;</span> 
               <span class="n">str_valid_acts</span>  <span class="o">.=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">dupeAct</span><span class="p">][</span><span class="s">&quot;type&quot;</span><span class="p">]</span> <span class="s">&quot;, &quot;</span>
               <span class="n">str_valid_acts</span>  <span class="o">.=</span> <span class="n">ch_quote</span>
               <span class="n">str_valid_acts</span>  <span class="o">.=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">dupeAct</span><span class="p">][</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
               <span class="n">str_valid_acts</span>  <span class="o">.=</span> <span class="n">ch_quote</span>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">dupeAct</span><span class="p">][</span><span class="s">&quot;arg&quot;</span><span class="p">]</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">str_valid_acts</span>  <span class="o">.=</span> <span class="s">&quot;, &quot;</span>
                  <span class="n">str_valid_acts</span>  <span class="o">.=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">dupeAct</span><span class="p">][</span><span class="s">&quot;arg&quot;</span><span class="p">]</span>
               <span class="p">}</span></DETAILS>
               <span class="n">str_valid_acts</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
               <span class="n">ar_valid_acts</span><span class="p">[</span> <span class="n">dupeAct</span> <span class="p">]</span> <span class="o">:=</span> <span class="nv">true</span>
            <span class="p">}</span></DETAILS>
         <span class="p">}</span></DETAILS>
         
         <span class="n">ar_valid_acts</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dupe</span> <span class="ow">in</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="n">init__ar_duplicate_actions_found</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">str_invalid_acts</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`t</span><span class="s">&quot;</span> <span class="n">dupe</span><span class="p">[</span><span class="s">&quot;line&quot;</span><span class="p">]</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="p">}</span></DETAILS>
         
         
         <span class="n">msg_for_usr</span> <span class="o">:=</span>  <span class="s">&quot;program_launcher.ahk</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;--------------</span><span class="se">`n</span><span class="s">Oops</span><span class="se">`n</span><span class="s">--------------</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;Duplicate Actions were found.</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;The first time an Actions is found, it&#39;s kept. </span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;The following Actions were loaded:</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="n">str_valid_acts</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">The following duplicate lines were ignored:</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="n">str_invalid_acts</span>
         
         <span class="kr">Msgbox</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="n">Error</span> <span class="ow">in</span> <span class="n">Settings</span><span class="o">.</span><span class="n">ini</span><span class="p">,</span> <span class="vi">%msg_for_usr%</span>
      
      <span class="p">}</span></DETAILS>
      
      
      <span class="n">msg_for_usr</span> <span class="o">:=</span>  <span class="s">&quot;&quot;</span>
      <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">msg_for_usr</span> <span class="o">:=</span>  <span class="s">&quot;&quot;</span>
      <span class="n">msg_for_usr</span>  <span class="o">.=</span> <span class="s">&quot;&quot;</span>
      
      <span class="k">return</span>
   
   <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">   ;===================================;</span>
<span class="c1">   ;  &lt;/&gt; end of helper functions for  ;</span>
<span class="c1">   ;                                   ;</span>
<span class="c1">   ;      Initialize_Load_Savefile()   ;</span>
<span class="c1">   ;===================================;</span>




<span class="c1">   ;---------------------------------------------------</span>
<span class="c1">   ; This is a shorthand way to call Change_Savefile</span>
<span class="c1">   ; in order to enable a Command.</span>
<span class="c1">   ;</span>
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Change_Savefile__Enable_Command</span><span class="ss">(</span> <span class="n">command_to_enable</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------------------------------------------</span>
<span class="c1">      ; Syntax Reference</span>
<span class="c1">      ;-------------------------------------------------------------------</span>
<span class="c1">      ; class:    FILE_HELPER</span>
<span class="c1">      ; function: Change_Savefile( p1,p2,p3,p4 )</span>
<span class="c1">      ;</span>
<span class="c1">      ; p1:  mode                      action|command</span>
<span class="c1">      ; p2:  purpose                   add|delete|edit|enable|disable</span>
<span class="c1">      ; p2:  action_id__or__cmd        new Action&#39;s ID </span>
<span class="c1">      ; p2:  cmd_name_before_rename    only needed for edit Command popups</span>
<span class="c1">      ;-------------------------------------------------------------------</span>
      
      <span class="n">p1</span> <span class="o">:=</span> <span class="s">&quot;command&quot;</span>
      <span class="n">p2</span> <span class="o">:=</span> <span class="s">&quot;enable&quot;</span>
      <span class="n">p3</span> <span class="o">:=</span> <span class="n">command_to_enable</span>
      <span class="n">p4</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Savefile</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span><span class="p">,</span><span class="n">p4</span> <span class="ss">)</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">   ;---------------------------------------------------</span>
<span class="c1">   ; This is a shorthand way to call Change_Savefile</span>
<span class="c1">   ; in order to disable a Command.</span>
<span class="c1">   ;</span>
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Change_Savefile__Disable_Command</span><span class="ss">(</span> <span class="n">command_to_disable</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------------------------------------------</span>
<span class="c1">      ; Syntax Reference</span>
<span class="c1">      ;-------------------------------------------------------------------</span>
<span class="c1">      ; class:    FILE_HELPER</span>
<span class="c1">      ; function: Change_Savefile( p1,p2,p3,p4 )</span>
<span class="c1">      ;</span>
<span class="c1">      ; p1:  mode                      action|command</span>
<span class="c1">      ; p2:  purpose                   add|delete|edit|enable|disable</span>
<span class="c1">      ; p2:  action_id__or__cmd        new Action&#39;s ID </span>
<span class="c1">      ; p2:  cmd_name_before_rename    only needed for edit Command popups</span>
<span class="c1">      ;-------------------------------------------------------------------</span>
      
      <span class="n">p1</span> <span class="o">:=</span> <span class="s">&quot;command&quot;</span>
      <span class="n">p2</span> <span class="o">:=</span> <span class="s">&quot;disable&quot;</span>
      <span class="n">p3</span> <span class="o">:=</span> <span class="n">command_to_disable</span>
      <span class="n">p4</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Savefile</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span><span class="p">,</span><span class="n">p4</span> <span class="ss">)</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;======================================================================;</span>
<span class="c1">   ;     About Initialize_Load_Savefile()                                 ;</span>
<span class="c1">   ;======================================================================; </span></SUMMARY>
<span class="c1">   ;      Initialize_Load_Savefile()    reads from the savefile.          ;</span>
<span class="c1">   ;      Change_Savefile()              writes to the savefile.          ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ; Change_Savefile() is called from the GUI Configuration window when   ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;    (1)  The user changes a setting.                                  ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;    (2)  The user adds a new Command.                                 ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;    (3)  The user changes the Command&#39;s text                          ;</span>
<span class="c1">   ;         or changes the Action associated with the Command.           ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;    (4)  The user enables or disables an existing Command.            ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;    (5)  The user adds a new Action.                                  ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;    (6)  The user changes the functionality of an Action.             ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;    (7)  The user deletes a Command or deletes an Action.             ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ; If you are new to Regular Expressions, see the resources             ;</span>
<span class="c1">   ; in the comment above the beginning of the FILE_HELPER class above.   ;</span>
<span class="c1">   ;                                                                      ;</span>
<span class="c1">   ;======================================================================; </span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Change_Savefile</span><span class="ss">(</span> <span class="n">mode</span><span class="o">:=</span><span class="s">&quot;action|command|setting&quot;</span>
      <span class="p">,</span> <span class="n">purpose</span><span class="o">:=</span><span class="s">&quot;add|delete|edit|enable|disable&quot;</span>
      <span class="p">,</span> <span class="n">action_id__or__cmd</span> <span class="o">:=</span><span class="s">&quot;passed from popup&quot;</span>
      <span class="p">,</span> <span class="n">cmd_name_before_rename</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="p">,</span> <span class="n">setting_to_change</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> <span class="ss">)</span>
   <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> <span class="vc">_savefile_path</span>
   <span class="nb">global</span> <span class="vc">_ACTIONS</span>
   <span class="nb">global</span> <span class="vc">_COMMANDS</span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;---------------------------------------------------------------------------------;</span>
<span class="c1">      ;  Parameters                                                                     ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;---------------------------------------------------------------------------------; </span></SUMMARY>
<span class="c1">      ;  mode                        Determines type of what to change in savefile.     ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;                              Valid values:                                      ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;                                             &quot;action&quot;, &quot;command&quot;, &quot;setting&quot;      ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;---------------------------------------------------------------------------------;</span>
<span class="c1">      ;  purpose                     Type of operation.                                 ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;                              Valid values:                                      ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;                                             &quot;add&quot;, &quot;delete&quot;, &quot;edit&quot;             ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;                              If mode is &quot;command&quot;                               ;</span>
<span class="c1">      ;                              these values are also valid:                       ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;                                             &quot;enable&quot;, &quot;disable&quot;                 ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;---------------------------------------------------------------------------------;</span>
<span class="c1">      ;  action_id__or__cmd          Only used for Commands and Actions.                ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;                              Can be empty string if mode is &quot;setting&quot;.          ;</span>
<span class="c1">      ;---------------------------------------------------------------------------------;</span>
<span class="c1">      ;  cmd_name_before_rename      Only used for Commands.                            ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;                              Can be empty string otherwise.                     ;</span>
<span class="c1">      ;---------------------------------------------------------------------------------;</span>
<span class="c1">      ;  setting_to_change           Only used for Settings.                            ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;                              Variable should be in this format:                 ;</span>
<span class="c1">      ;                                  {&quot;setting_name&quot;:&quot;&quot;, &quot;new_value&quot;:&quot;&quot;}            ;</span>
<span class="c1">      ;                                                                                 ;</span>
<span class="c1">      ;---------------------------------------------------------------------------------; </span></DETAILS>
   
   
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="kr">FileExist</span><span class="ss">(</span><span class="vc">_savefile_path</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; savefile deleted or moved or renamed since program_launcher.ahk was run.</span>
         <span class="n">title</span> <span class="o">:=</span> <span class="s">&quot;[ SUPER ERROR ]&quot;</span>
         <span class="n">msg_for_user</span> <span class="o">:=</span> <span class="s">&quot;Savefile not found where app last found it.</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="kr">MSGBOX</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="o">%</span> <span class="n">title</span><span class="p">,</span> <span class="o">%</span> <span class="n">msg_for_user</span>
         <span class="k">return</span> 
      <span class="p">}</span></DETAILS>
      
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">         PURPOSE:</span>
<span class="cm">            </span>
<span class="cm">            ADD</span>
<span class="cm">            </span>
<span class="cm">               This is the only function which does not need </span>
<span class="cm">               to match a pre-existing line in the savefile.</span>
<span class="cm">               For add, we just need to find the end of </span>
<span class="cm">               the section (]) of either (Actions[) or (Commands[)</span>
<span class="cm">               then add the new line just before the (]).</span>
<span class="cm">                  Thus:</span>
<span class="cm">                  The add functionality needs to watch for </span>
<span class="cm">                  (a) beginning of the relavant Section ([)</span>
<span class="cm">                  (b) ending    of the relavant Section (])</span>
<span class="cm">            </span>
<span class="cm">            DELETE</span>
<span class="cm">            EDIT</span>
<span class="cm">            ENABLE  (applicable only to Commands)</span>
<span class="cm">            DISABLE (applicable only to Commands)</span>
<span class="cm">            </span>
<span class="cm">               Each of these functions needs to find the</span>
<span class="cm">               specific line corresponding to a pre-existing</span>
<span class="cm">               Command or Action in the Savefile. </span>
<span class="cm">               They all need to watch for: </span>
<span class="cm">                  (a) beginning of the relavant Section ([)</span>
<span class="cm">                  (b) the matching pre-existing entry in the Savefile </span>
<span class="cm">               Then each diverges in modification from there.</span>
<span class="cm">            </span>
<span class="cm">         ===============================================</span>
<span class="cm">         Steps: </span>
<span class="cm">         ===============================================</span>
<span class="cm">         </span>
<span class="cm">         (1) Ensure Savefile still exists.</span>
<span class="cm">         </span>
<span class="cm">         (2) Read Savefile into program memory </span>
<span class="cm">         </span>
<span class="cm">            (2.1) Depending on parameter mode, look for the section:</span>
<span class="cm">               &#39;actions[&#39;   or</span>
<span class="cm">               &#39;commands[&#39; </span>
<span class="cm">               </span>
<span class="cm">               (2.2) Look for the matching action_id or cmd</span>
<span class="cm">               </span>
<span class="cm">               (2.3) If parameter purpose is </span>
<span class="cm">               </span>
<span class="cm">                  (a) &quot;edit&quot;,  then modify line </span>
<span class="cm">                  (b) &quot;delete&quot;, then remove line </span>
<span class="cm">         </span>
<span class="cm">         (3)   Overwrite Savefile with new data. </span>
<span class="cm">               </span>
<span class="cm">         Done.</span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS>
      
      <span class="n">match_target_section</span>            <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">match_line_to_compare</span>           <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">match_line__use_capture_group</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="n">mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">match_target_section</span> <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*ACTIONS[ \t]*\[[ \t]*$&quot;</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">match_target_section</span> <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*COMMANDS[ \t]*\[[ \t]*$&quot;</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span><span class="s">&quot;setting&quot;</span> <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">match_target_section</span> <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*SETTINGS[ \t]*\[[ \t]*$&quot;</span>
      <span class="p">}</span></DETAILS>
      
      <span class="n">match_lines_beginning_with_semi</span> <span class="o">:=</span> <span class="s">&quot;^[ \t]*[;].*&quot;</span>
      <span class="n">match_entirely_whitespace_lines</span> <span class="o">:=</span> <span class="s">&quot;^[ \t]*$&quot;</span>
      
      <span class="n">match_close_section</span>    <span class="o">:=</span> <span class="s">&quot;i)^[ \t]*\][ \t]*$&quot;</span>
      <span class="n">counter_for_target_section</span> <span class="o">:=</span> <span class="mi">0</span>
      
      
      <span class="n">revised_file_data</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">is_insertion_point_changed_yet</span> <span class="o">:=</span> <span class="nv">false</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;---------------------------------------------</span>
<span class="c1">      ; Read _program_launcher_settings.ini, </span>
<span class="c1">      ; one line at a time.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="n">Loop</span><span class="p">,</span> <span class="kr">Read</span><span class="p">,</span> <span class="vi">%_savefile_path%</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;---------------------------------------------------------------------</span>
<span class="c1">         ; If we&#39;ve already modified the Action or Command&#39;s target line</span>
<span class="c1">         ; and added the new data to the var revised_file_data,</span>
<span class="c1">         ; then skip the logic and copy the rest of the file to this var </span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">true</span> <span class="o">==</span> <span class="n">is_insertion_point_changed_yet</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
            <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="nv">A_LoopReadLine</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="k">continue</span>
            
         <span class="p">}</span></DETAILS>
         
         <span class="n">is_comment</span> <span class="o">:=</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="p">,</span> <span class="n">match_lines_beginning_with_semi</span><span class="ss">)</span>
         <span class="n">is_empty</span>   <span class="o">:=</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="p">,</span> <span class="n">match_entirely_whitespace_lines</span><span class="ss">)</span>
         <span class="n">is_empty</span>   <span class="o">:=</span> <span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="o">==</span><span class="s">&quot;&quot;</span> <span class="ow">or</span> <span class="n">is_empty</span><span class="ss">)</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">is_comment</span> <span class="ow">or</span> <span class="n">is_empty</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="nv">A_LoopReadLine</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="k">continue</span>
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;----------------------------------------------------</span>
<span class="c1">         ; NECESSARY FOR PURPOSES: </span>
<span class="c1">         ;</span>
<span class="c1">         ;    All.</span>
<span class="c1">         ;</span>
<span class="c1">         ;----------------------------------------------------</span>
<span class="c1">         ;</span>
<span class="c1">         ; Found  (actions[) </span>
<span class="c1">         ; or     (commands[) </span>
<span class="c1">         ; or     (settings[) </span>
<span class="c1">         ;</span>
<span class="c1">         ; (insertion&#39;s target section encountered)</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="p">,</span> <span class="n">match_target_section</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>

               <span class="n">counter_for_target_section</span> <span class="o">:=</span> <span class="mi">1</span>
               
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         ;----------------------------------------------------</span>
<span class="c1">         ; NECESSARY FOR PURPOSES: </span>
<span class="c1">         ;</span>
<span class="c1">         ;    &quot;add&quot;  (any mode)</span>
<span class="c1">         ;</span>
<span class="c1">         ;----------------------------------------------------</span>
<span class="c1">         ;</span>
<span class="c1">         ; (]) encountered while inside either</span>
<span class="c1">         ;</span>
<span class="c1">         ;    (actions[),  or</span>
<span class="c1">         ;    (commands[), or</span>
<span class="c1">         ;    (settings[)</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="nv">A_LoopReadLine</span><span class="p">,</span> <span class="n">match_close_section</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">counter_for_target_section</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;add&quot;</span> <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  
                  <span class="n">p1</span> <span class="o">:=</span> <span class="n">mode</span> 
                  <span class="n">p2</span> <span class="o">:=</span> <span class="n">action_id__or__cmd</span>
                  <span class="n">new_entry_to_insert</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Helper__TargetLine__Create</span><span class="ss">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="ss">)</span>
                  
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="n">new_entry_to_insert</span>
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="s">&quot;]&quot;</span>
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="c1"></span>
<span class="c1">                  </span>
<span class="c1">                  ;====================================================</span>
<span class="c1">                  ; Turn on flag to speed up the rest of the file loop </span>
<span class="c1">                  ;====================================================</span>
                  
                  <span class="n">is_insertion_point_changed_yet</span> <span class="o">:=</span> <span class="nv">true</span>
                  
                  <span class="k">continue</span> 
               <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">               ;----------------------------------------------------</span>
<span class="c1">               ; When editing a setting, </span>
<span class="c1">               ; if it isn&#39;t present in the Savefile yet, then:</span>
<span class="c1">               ; </span>
<span class="c1">               ;    - Add it at the end of the (settings[) section.</span>
<span class="c1">               ;    - Close the section (])</span>
<span class="c1">               ;    - Finish collecting the rest of the file into </span>
<span class="c1">               ;       revised_file_data, and write the file.</span>
<span class="c1">               ;</span>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span>
               <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;setting&quot;</span> <span class="o">==</span> <span class="n">mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  
                  <span class="n">p1</span> <span class="o">:=</span> <span class="n">mode</span> 
                  <span class="n">p2</span> <span class="o">:=</span> <span class="n">setting_to_change</span><span class="c1"> ; {&quot;setting_name&quot;:__, &quot;new_value&quot;:__}</span>
                  
                  <span class="n">edited_line</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Helper__TargetLine__Create</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ss">)</span>
                  
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="n">edited_line</span>
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="s">&quot;]&quot;</span>
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="c1"></span>
<span class="c1">                  </span>
<span class="c1">                  ;====================================================</span>
<span class="c1">                  ; Turn on flag to speed up the rest of the file loop </span>
<span class="c1">                  ;====================================================</span>
                  
                  <span class="n">is_insertion_point_changed_yet</span> <span class="o">:=</span> <span class="nv">true</span>
                  
                  <span class="k">continue</span> 
               <span class="p">}</span></DETAILS>
               
            <span class="p">}</span></DETAILS>
            
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         ;-------------------------------------------------------</span>
<span class="c1">         ; NECESSARY FOR PURPOSES: </span>
<span class="c1">         ;</span>
<span class="c1">         ;    &quot;delete&quot;  (any mode)</span>
<span class="c1">         ;    &quot;edit&quot;    (any mode)</span>
<span class="c1">         ;    &quot;enable&quot;    (applicable only to Commands) </span>
<span class="c1">         ;    &quot;disable&quot;   (applicable only to Commands) </span>
<span class="c1">         ;</span>
<span class="c1">         ;-------------------------------------------------------</span>
<span class="c1">         ;</span>
<span class="c1">         ; Found line containing Action or Command </span>
<span class="c1">         ; while inside </span>
<span class="c1">         ;</span>
<span class="c1">         ;    (actions[)    or </span>
<span class="c1">         ;    (commands[)   or</span>
<span class="c1">         ;    (settings[) </span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span>
         <span class="k">if</span><span class="ss">(</span> <span class="n">counter_for_target_section</span> <span class="o">==</span> <span class="mi">1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
            <span class="n">p1</span> <span class="o">:=</span> <span class="n">mode</span>
            <span class="n">p2</span> <span class="o">:=</span> <span class="nv">A_LoopReadLine</span>
            <span class="n">p3</span> <span class="o">:=</span> <span class="n">action_id__or__cmd</span>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">mode</span> 
            <span class="ow">and</span> <span class="s">&quot;edit&quot;</span>    <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">               ;-----------------------------------------------------------</span>
<span class="c1">               ; If the Command&#39;s text was renamed, </span>
<span class="c1">               ; we need to look for the previous version in the Savefile.</span>
<span class="c1">               ;</span>
               <span class="n">p3</span> <span class="o">:=</span> <span class="n">cmd_name_before_rename</span>
               
            <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span>
            <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;setting&quot;</span> <span class="o">==</span> <span class="n">mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">               ;-----------------------------------------------------------</span>
<span class="c1">               ; If the Command&#39;s text was renamed, </span>
<span class="c1">               ; we need to look for the previous version in the Savefile.</span>
<span class="c1">               ;</span>
               <span class="n">p3</span> <span class="o">:=</span> <span class="n">setting_to_change</span><span class="p">[</span><span class="s">&quot;setting_name&quot;</span><span class="p">]</span>
               
            <span class="p">}</span></DETAILS>
            
            <span class="n">found_it</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Helper__IsCurrentLineTheTargetLine</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span> <span class="ss">)</span>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">found_it</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;delete&quot;</span> <span class="o">==</span> <span class="n">purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">               </span>
<span class="c1">                  ;======================================================</span>
<span class="c1">                  ; Delete by omission, </span>
<span class="c1">                  ; skip adding to revised_file_data this loop iteration.</span>
<span class="c1">                  ;======================================================</span>
<span class="c1">                  </span>
<span class="c1">                  </span>
<span class="c1">                  ;====================================================</span>
<span class="c1">                  ; Turn on flag to speed up the rest of the file loop </span>
<span class="c1">                  ;====================================================</span>
                  
                  <span class="n">is_insertion_point_changed_yet</span> <span class="o">:=</span> <span class="nv">true</span> 
                  
                  <span class="k">continue</span>
                  
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span><span class="s">&quot;edit&quot;</span> <span class="o">==</span> <span class="n">purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  </span>
<span class="c1">                  ;============================================================</span>
<span class="c1">                  ; Generate a new line for this entry in the Savefile </span>
<span class="c1">                  ; based on current data in _ACTIONS and _COMMANDS.</span>
<span class="c1">                  ;</span>
<span class="c1">                  ; Note about editing a Command here:</span>
<span class="c1">                  ;   We already ensured that this is the correct line above. </span>
<span class="c1">                  ;   So we don&#39;t need to pass in the old name for examination,</span>
<span class="c1">                  ;   only the new command text to insert in the Savefile.</span>
<span class="c1">                  ;============================================================</span>
                  
                  <span class="n">p1</span> <span class="o">:=</span> <span class="n">mode</span> 
                  <span class="n">p2</span> <span class="o">:=</span> <span class="n">action_id__or__cmd</span>
<DETAILS open class="control_flow_block leading_tabs_6"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;setting&quot;</span> <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                     <span class="n">p2</span> <span class="o">:=</span> <span class="n">setting_to_change</span><span class="c1"> ; {&quot;setting_name&quot;:__, &quot;new_value&quot;:__}</span>
                  <span class="p">}</span></DETAILS>
                  <span class="n">edited_line</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Helper__TargetLine__Create</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ss">)</span>
                  
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="n">edited_line</span>
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="c1"></span>
<span class="c1">                  </span>
<span class="c1">                  ;====================================================</span>
<span class="c1">                  ; Turn on flag to speed up the rest of the file loop </span>
<span class="c1">                  ;====================================================</span>
                  
                  <span class="n">is_insertion_point_changed_yet</span> <span class="o">:=</span> <span class="nv">true</span>
                  
                  <span class="k">continue</span> 
                  
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">mode</span>
                        <span class="ow">and</span> <span class="ss">(</span>   <span class="s">&quot;enable&quot;</span>  <span class="o">==</span> <span class="n">purpose</span>
                             <span class="ow">or</span> <span class="s">&quot;disable&quot;</span> <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span>  <span class="ss">)</span>
               <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  </span>
<span class="c1">                  ;=================================================================</span>
<span class="c1">                  ; Generate an edited line for this Command&#39;s entry in the Savefile </span>
<span class="c1">                  ; to store its current enabled or disabled state, by:</span>
<span class="c1">                  ;</span>
<span class="c1">                  ;    either appending a trailing &quot;DISABLED&quot; string</span>
<span class="c1">                  ;    or by removing the trailing &quot;DISABLED&quot; string.</span>
<span class="c1">                  ;=================================================================</span>
                  
                  <span class="n">p1</span> <span class="o">:=</span> <span class="n">purpose</span> 
                  <span class="n">p2</span> <span class="o">:=</span> <span class="nv">A_LoopReadLine</span>
                  <span class="n">edited_line</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Helper__TargetLine__ToggleCommand</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ss">)</span>
                  
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="n">edited_line</span>
                  <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="c1"></span>
<span class="c1">                  </span>
<span class="c1">                  ;====================================================</span>
<span class="c1">                  ; Turn on flag to speed up the rest of the file loop </span>
<span class="c1">                  ;====================================================</span>
                  
                  <span class="n">is_insertion_point_changed_yet</span> <span class="o">:=</span> <span class="nv">true</span>
                  
                  <span class="k">continue</span>
               
               <span class="p">}</span></DETAILS>
               
            <span class="p">}</span><span class="c1"> ; if found (target Action ID) or (target Command) </span></DETAILS>
            
         <span class="p">}</span><span class="c1"> ; if loop line is within Section &quot;Actions[&quot; or &quot;Commands[&quot; </span></DETAILS>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">         ;----------------------------------------------------------</span>
<span class="c1">         ; Didn&#39;t find the target Action or Command to modify yet.</span>
<span class="c1">         ;</span>
<span class="c1">         ; For everything else, </span>
<span class="c1">         ; copy current line to our file data var, </span>
<span class="c1">         ; continue to next line.</span>
<span class="c1">         ;</span>
         <span class="n">revised_file_data</span> <span class="o">.=</span> <span class="nv">A_LoopReadLine</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
         
         
      <span class="p">}</span><span class="c1"> ; end of file loop </span></DETAILS>
<span class="c1">      </span>
<span class="c1">      ; msgbox newfile`n%revised_file_data%</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="n">revised_file_data</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
         <span class="kr">FileDelete</span><span class="p">,</span> <span class="vi">%_savefile_path%</span>
         <span class="kr">FileAppend</span><span class="p">,</span> <span class="vi">%revised_file_data%</span><span class="p">,</span> <span class="vi">%_savefile_path%</span>
         
      <span class="p">}</span></DETAILS>
         
      
      
      
      
      
      <span class="k">return</span> <span class="n">is_insertion_point_changed_yet</span>
   <span class="p">}</span><span class="c1"> ; Change_Savefile() </span></DETAILS>
<span class="c1">         </span>
<span class="c1">   ;=================================;</span>
<span class="c1">   ;                                 ;</span>
<span class="c1">   ;      HELPER FUNCTIONS FOR       ;</span>
<span class="c1">   ;                                 ;</span>
<span class="c1">   ;        Change_Savefile()        ;</span>
<span class="c1">   ;                                 ;</span>
<span class="c1">   ;=================================;</span>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Change_Helper__IsCurrentLineTheTargetLine</span><span class="ss">(</span> <span class="n">mode</span><span class="p">,</span> <span class="n">current_line</span><span class="p">,</span> <span class="n">id_or_cmd_or_setting</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">   ; No globals needed.</span>
<span class="c1">   ;</span>
<span class="c1">   ; This function only exists outside the file loop </span>
<span class="c1">   ; to improve readability &amp; organize complexity </span>
<span class="c1">   ; (and possibly to benefit anyone new to AutoHotkey or programming).</span>
<span class="c1">   ;---------------------------------------------------------------------------</span>
   
      <span class="n">is_this_the_destination</span> <span class="o">:=</span> <span class="nv">false</span> 
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="n">mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;------------------------------------------------</span>
<span class="c1">         ; Each Action entry in the Savefile </span>
<span class="c1">         ; has a unique ID at the beginning of the line, </span>
<span class="c1">         ; followed by a (,) comma.</span>
<span class="c1">         ;</span>
<span class="c1">         ; This function receieved a parameter holding </span>
<span class="c1">         ; the Action ID to alter in the savefile.</span>
<span class="c1">         ;</span>
<span class="c1">         ; So this leading sequence of one or more digits</span>
<span class="c1">         ;</span>
<span class="c1">         ;     ([\d]+)</span>
<span class="c1">         ;</span>
<span class="c1">         ; is all we need to ensure the target line </span>
<span class="c1">         ; matches the given Action ID parameter.</span>
<span class="c1">         ;</span>
<span class="c1">         ; The leading &quot;U)&quot; portion is the &quot;Ungreedy&quot; flag, </span>
<span class="c1">         ; telling the regular expression to look </span>
<span class="c1">         ; for the smallest substring which satisfies our </span>
<span class="c1">         ; match string. </span>
<span class="c1">         ;</span>
<span class="c1">         ; Without this &quot;Ungreedy&quot; flag, </span>
<span class="c1">         ; a more verbose regular expression match string </span>
<span class="c1">         ; is required. </span>
<span class="c1">         ;</span>
<span class="c1">         ; Enclosing the one or more digits [\d]+ </span>
<span class="c1">         ; in parenthesis signifies that we want </span>
<span class="c1">         ; everything between the open and close parenthesis</span>
<span class="c1">         ; to count as a &quot;Match Group&quot;.</span>
<span class="c1">         ;</span>
<span class="c1">         ; A successful call to AutoHotkey&#39;s RegExMatch() </span>
<span class="c1">         ; creates a variable for each match group.</span>
<span class="c1">         ; In this case, we only have one match group</span>
<span class="c1">         ; (containing the Action ID).</span>
<span class="c1">         ;</span>
<span class="c1">         ; The output variable MatchGroup </span>
<span class="c1">         ; contains our Action ID plus the trailing comma.</span>
<span class="c1">         ;</span>
<span class="c1">         ; The output variable MatchGroup1 </span>
<span class="c1">         ; contains our Action ID by itself.</span>
<span class="c1">         ;------------------------------------------------</span>
         
         <span class="n">match_unique_token</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
         <span class="o">.</span> <span class="s">&quot;U)^[ \t]*([\d]+)[ \t]*,&quot;</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;~ capture_group_for_unique_token := &quot;$1&quot;</span>
         
         
         <span class="n">unique_token</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         
         <span class="kr">RegExMatch</span><span class="ss">(</span> <span class="n">current_line</span>
                   <span class="p">,</span> <span class="n">match_unique_token</span>
                   <span class="p">,</span> <span class="n">MatchGroup</span> <span class="ss">)</span>
         
         <span class="n">unique_token</span> <span class="o">:=</span> <span class="n">MatchGroup1</span>
                                 
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;------------------------------------------------</span>
<span class="c1">         ; Each Command entry in the Savefile </span>
<span class="c1">         ; has a unique text at the beginning of the line, </span>
<span class="c1">         ; followed by a (:) colon.</span>
<span class="c1">         ;</span>
<span class="c1">         ; If this Command has just been renamed, </span>
<span class="c1">         ; we first need to find its old entry </span>
<span class="c1">         ; with its old name in the Savefile.</span>
<span class="c1">         ;</span>
<span class="c1">         ; This function receieved a parameter holding </span>
<span class="c1">         ; the Command&#39;s last-saved unique text.</span>
<span class="c1">         ;</span>
<span class="c1">         ; Unlike the above regular expression match string</span>
<span class="c1">         ; to find the Action ID, Commands can have a wide </span>
<span class="c1">         ; variety of leading text. The full Command </span>
<span class="c1">         ; match string is used here. </span>
<span class="c1">         ;</span>
<span class="c1">         ; The second capture group will contain each </span>
<span class="c1">         ; Command&#39;s text, and will be identical to our </span>
<span class="c1">         ; parameter when the proper line is found. </span>
<span class="c1">         ;</span>
<span class="c1">         ;[~] TODO</span>
<span class="c1">         ;------------------------------------------------</span>
         
         <span class="n">match_unique_token</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
         <span class="o">.</span> <span class="s">&quot;i)^[ \t]*(\\BEGIN_LITERAL\\)?(.*):[ \t]*(QUIT|SETTINGS|[\d]+)[ \t]*(DISABLED|disable|;|x)?$&quot;</span>
         
         <span class="n">capture_group_for_unique_token</span> <span class="o">:=</span> <span class="s">&quot;$2&quot;</span>
         
         <span class="n">unique_token</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span>  <span class="n">current_line</span>
                                         <span class="p">,</span> <span class="n">match_unique_token</span>
                                         <span class="p">,</span> <span class="n">capture_group_for_unique_token</span> <span class="ss">)</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span><span class="s">&quot;setting&quot;</span> <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
         <span class="n">match_unique_token</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
         <span class="o">.</span> <span class="s">&quot;i)^[ \t]*(&quot;</span> <span class="n">id_or_cmd_or_setting</span> <span class="s">&quot;)[ \t]*:[ \t]*(\d+)[ \t]*$&quot;</span>
         
         <span class="n">capture_group_for_unique_token</span> <span class="o">:=</span> <span class="s">&quot;$1&quot;</span>
         
         <span class="n">unique_token</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span>  <span class="n">current_line</span>
                                         <span class="p">,</span> <span class="n">match_unique_token</span>
                                         <span class="p">,</span> <span class="n">capture_group_for_unique_token</span> <span class="ss">)</span>
      <span class="p">}</span></DETAILS>
      
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">unique_token</span> <span class="o">==</span> <span class="n">id_or_cmd_or_setting</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">is_this_the_destination</span> <span class="o">:=</span> <span class="nv">true</span> 
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span> <span class="n">is_this_the_destination</span>
   <span class="p">}</span></DETAILS>
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Change_Helper__TargetLine__Create</span><span class="ss">(</span> <span class="n">mode</span><span class="p">,</span> <span class="n">id_or_cmd_or_setting</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> <span class="vc">_ACTIONS</span>
   <span class="nb">global</span> <span class="vc">_COMMANDS</span>
   
      <span class="n">new_savefile_line_to_insert</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      ;=======================================</span>
<span class="c1">      ; Create Line to Insert into Savefile</span>
<span class="c1">      ;=======================================</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="n">mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="n">action_id</span> <span class="o">:=</span> <span class="n">id_or_cmd_or_setting</span>
         
         <span class="n">ActionID</span>     <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">FolderOrApp</span>  <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">ActionPath</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">ActionArg</span>    <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         
         <span class="n">quote_character</span> <span class="o">:=</span> <span class="s">&quot;</span><span class="se">&quot;&quot;</span><span class="s">&quot;</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ; Unique ID #</span>
         <span class="n">ActionID</span> <span class="o">:=</span>  <span class="n">action_id</span>
         <span class="n">ActionID</span>  <span class="o">.=</span> <span class="s">&quot;, &quot;</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ; &quot;Folder&quot; </span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;folder&quot;</span> <span class="o">==</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">action_id</span><span class="p">][</span><span class="s">&quot;type&quot;</span><span class="p">]</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
            <span class="n">FolderOrApp</span> <span class="o">:=</span>  <span class="s">&quot;Folder&quot;</span>
            <span class="n">FolderOrApp</span>  <span class="o">.=</span> <span class="s">&quot;, &quot;</span>
            
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         ; or &quot;App&quot;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;app&quot;</span> <span class="o">==</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">action_id</span><span class="p">][</span><span class="s">&quot;type&quot;</span><span class="p">]</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
            <span class="n">FolderOrApp</span> <span class="o">:=</span>  <span class="s">&quot;App&quot;</span>
            <span class="n">FolderOrApp</span>  <span class="o">.=</span> <span class="s">&quot;,    &quot;</span><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ; (Optional) Arguments for App</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">action_id</span><span class="p">][</span><span class="s">&quot;arg&quot;</span><span class="p">]</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
               <span class="n">ActionArg</span> <span class="o">:=</span>  <span class="s">&quot;, &quot;</span>
               <span class="n">ActionArg</span>  <span class="o">.=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">action_id</span><span class="p">][</span><span class="s">&quot;arg&quot;</span><span class="p">]</span>
               
            <span class="p">}</span></DETAILS>
            
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ; Quoted Path</span>
         <span class="n">ActionPath</span> <span class="o">:=</span>  <span class="n">quote_character</span>
         <span class="n">ActionPath</span>  <span class="o">.=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">action_id</span><span class="p">][</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
         <span class="n">ActionPath</span>  <span class="o">.=</span> <span class="n">quote_character</span>
         
         
         <span class="n">new_savefile_line_to_insert</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
            <span class="o">.</span> <span class="s">&quot;</span><span class="se">`t</span><span class="s">&quot;</span><span class="c1">                          ; Add a leading tab each time for visual consistency.</span>
            <span class="o">.</span> <span class="n">ActionID</span><span class="c1">                       ; Add Action ID         followed by a comma (,) and spaces.</span>
            <span class="o">.</span> <span class="n">FolderOrApp</span><span class="c1">                   ; Add &quot;Folder&quot; or &quot;App&quot; followed by a comma (,) and spaces.</span>
            <span class="o">.</span> <span class="n">ActionPath</span><span class="c1">                    ; Add Action&#39;s Path, surrounded by double-quote (&quot;) characters.</span>
            <span class="o">.</span> <span class="n">ActionArg</span><span class="c1">                     ; If present add a comma and one space (, )</span>
<span class="c1">                                            ;  and custom arguments to call when App is run.</span>
            
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span>
      <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="n">cmd</span> <span class="o">:=</span> <span class="n">id_or_cmd_or_setting</span>
         
         <span class="n">action_id</span> <span class="o">:=</span> <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">cmd</span><span class="p">][</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span>
         
         <span class="n">begin_literal_flag</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> ; not needed if cmd doesn&#39;t begin with spaces</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">&quot;^[ \t]+.*&quot;</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">begin_literal_flag</span> <span class="o">:=</span> <span class="s">&quot;\BEGIN_LITERAL\&quot;</span>
         <span class="p">}</span></DETAILS>
         
         <span class="n">cmd_len</span> <span class="o">:=</span> <span class="kr">StrLen</span><span class="ss">(</span> <span class="n">cmd</span> <span class="ss">)</span>
         
         <span class="n">padding</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Fn_Calculate_Number_of_Tabs_Between_CommandColon_and_ActionID</span><span class="ss">(</span> <span class="n">cmd_len</span> <span class="ss">)</span><span class="c1"></span>
<span class="c1">         ; padding := FILE_HELPER.Fn_Calculate_Number_of_Spaces_Between_CommandColon_and_ActionID( cmd_len )</span>
         
         <span class="n">new_savefile_line_to_insert</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
            <span class="o">.</span> <span class="s">&quot;</span><span class="se">`t</span><span class="s">&quot;</span><span class="c1">                          ; Add a leading tab each time for visual consistency.</span>
            <span class="o">.</span> <span class="n">begin_literal_flag</span><span class="c1">            ; Only present if user&#39;s Command text begins with spaces.</span>
            <span class="o">.</span> <span class="n">cmd</span><span class="c1">                           ; Add User&#39;s Command text.</span>
            <span class="o">.</span> <span class="s">&quot;:&quot;</span> <span class="n">padding</span><span class="c1">                   ; Add colon (:) + padding for visual consistency (configured for Notepad++).</span>
            <span class="o">.</span> <span class="n">action_id</span><span class="c1">                       ; Add Action ID the Command&#39;s text triggers when typed in Program Launcher.</span>
         
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span>
      <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;setting&quot;</span> <span class="o">==</span> <span class="n">mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">setting_name</span> <span class="o">:=</span> <span class="n">id_or_cmd_or_setting</span><span class="p">[</span><span class="s">&quot;setting_name&quot;</span><span class="p">]</span>
         <span class="n">new_value</span> <span class="o">:=</span> <span class="n">id_or_cmd_or_setting</span><span class="p">[</span><span class="s">&quot;new_value&quot;</span><span class="p">]</span>
         
         
         <span class="n">new_savefile_line_to_insert</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
            <span class="o">.</span> <span class="s">&quot;</span><span class="se">`t</span><span class="s">&quot;</span><span class="c1">                          ; Add a leading tab each time for visual consistency.</span>
            <span class="o">.</span> <span class="n">setting_name</span><span class="c1">                  ; Add setting name</span>
            <span class="o">.</span> <span class="s">&quot;: &quot;</span><span class="c1">                          ; Add a colon and a space (: )</span>
            <span class="o">.</span> <span class="n">new_value</span><span class="c1">                     ; Add value for setting</span>
            
      <span class="p">}</span></DETAILS>
      
      
      <span class="k">return</span> <span class="n">new_savefile_line_to_insert</span>
   <span class="p">}</span></DETAILS>
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Change_Helper__TargetLine__ToggleCommand</span><span class="ss">(</span> <span class="n">purpose</span><span class="p">,</span> <span class="n">target_line</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>

      <span class="n">new_savefile_line_to_insert</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
   
      <span class="n">match_command_colon_actionID_optionallyAlsoDisableFlag</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
        <span class="o">.</span> <span class="s">&quot;i)^([ \t]*(\\BEGIN_LITERAL\\)?(.*)\:[ \t]*(QUIT|SETTINGS|[\d]+))[ \t]*(DISABLED|disable|;|x)?$&quot;</span>
      
      <span class="n">text_without_disableFlag</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span> <span class="n">target_line</span>
         <span class="p">,</span> <span class="n">match_command_colon_actionID_optionallyAlsoDisableFlag</span>
         <span class="p">,</span> <span class="s">&quot;$1&quot;</span> <span class="ss">)</span>
         
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;disable&quot;</span> <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>

<span class="c1">         ;=====================================================</span>
<span class="c1">         ; Append &quot;DISABLED&quot; to Command&#39;s line </span>
<span class="c1">         ; store to our file data var to write after this loop </span>
<span class="c1">         ;=====================================================</span>
         
         <span class="n">new_savefile_line_to_insert</span> <span class="o">:=</span> <span class="n">text_without_disableFlag</span> <span class="s">&quot;</span><span class="se">`t`t</span><span class="s">&quot;</span> <span class="s">&quot;DISABLED&quot;</span><span class="c1"></span>

<span class="c1">         ; msgBOX %   target_line &quot;`t`t&quot; &quot;DISABLED&quot;</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> 
      <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;enable&quot;</span> <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
            
         <span class="n">new_savefile_line_to_insert</span> <span class="o">:=</span> <span class="n">text_without_disableFlag</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ; msgBOX %   text_without_disableFlag</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span> <span class="n">new_savefile_line_to_insert</span>
   <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">   ;===================================;</span>
<span class="c1">   ;  &lt;/&gt; end of helper functions for  ;</span>
<span class="c1">   ;                                   ;</span>
<span class="c1">   ;         Change_Savefile()         ;</span>
<span class="c1">   ;===================================;</span>


   

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_Standardize_Path_String</span><span class="ss">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path_type</span><span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">    </span>
<span class="c1">      ;======================================================</span>
<span class="c1">      ; format Path string to maintain visual consistency</span>
<span class="c1">      ;======================================================</span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------</span>
<span class="c1">      ; format path to remove leading &amp; trailing whitespace</span>
<span class="c1">      ;-----------------------------------------------------</span>
      <span class="n">formatted_path</span> <span class="o">:=</span> <span class="kr">Trim</span><span class="ss">(</span><span class="n">path</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------------------</span>
<span class="c1">      ; convert &quot;/&quot;s to &quot;\&quot;s </span>
<span class="c1">      ;  because Windows is weird, and this is conventional.</span>
<span class="c1">      ;------------------------------------------------------</span>
      <span class="n">formatted_path</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="n">formatted_path</span><span class="p">,</span><span class="s">&quot;[/]&quot;</span><span class="p">,</span><span class="s">&quot;\&quot;</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------------</span>
<span class="c1">      ; append trailing &quot;\&quot; to directory if not there </span>
<span class="c1">      ;------------------------------------------------</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;folder&quot;</span> <span class="o">=</span> <span class="n">path_type</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="n">formatted_path</span><span class="p">,</span> <span class="s">&quot;[^\\]$&quot;</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">formatted_path</span> <span class="o">:=</span> <span class="n">formatted_path</span> <span class="o">.</span> <span class="s">&quot;\&quot;</span>
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS>
      <span class="k">return</span> <span class="n">formatted_path</span>
   <span class="p">}</span></DETAILS>


<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_Calculate_Number_of_Spaces_Between_CommandColon_and_ActionID</span><span class="ss">(</span> <span class="n">cmd_length</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   
      <span class="n">space_string</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; Add 1 to the length to account for the colon (:) before tabs begin</span>
      <span class="n">cmd_length</span> <span class="o">:=</span> <span class="n">cmd_length</span> <span class="o">+</span> <span class="mi">1</span> 
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">28</span> <span class="o">&lt;=</span> <span class="n">cmd_length</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">space_string</span> <span class="o">:=</span> <span class="s">&quot; &quot;</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">cmd_length</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="n">empty_space_to_fill</span> <span class="o">:=</span> <span class="mi">28</span> <span class="o">-</span> <span class="n">cmd_length</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="n">Loop</span><span class="p">,</span> <span class="vi">%empty_space_to_fill%</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">space_string</span> <span class="o">.=</span> <span class="s">&quot; &quot;</span>
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS>
      
      
      <span class="k">return</span> <span class="n">space_string</span>
   <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">   </span>
<span class="c1">   ;~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ </span>
<span class="c1">   ; [~] TODO</span>
<span class="c1">   ;</span>
<span class="c1">   ; Add a setting where if changed, </span>
<span class="c1">   ; on launch Program Launcher will reformat savefile </span>
<span class="c1">   ; for either notepad.exe (which uses 16 spaces for 1 tab)</span>
<span class="c1">   ; or for standard 4 spaces for 1 tab </span>
<span class="c1">   ; or for standard 3 spaces for 1 tab </span>
<span class="c1">   ;</span>
<span class="c1">   ; to allow for smoother experience in user&#39;s text editor of choice. </span>
<span class="c1">   ;</span>
<span class="c1">   ;~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ </span>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_Calculate_Number_of_Tabs_Between_CommandColon_and_ActionID</span><span class="ss">(</span> <span class="n">cmd_length</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">         number of characters           number of tabs </span>
<span class="cm">         including                      to use </span>
<span class="cm">         command + colon (:)</span>
<span class="cm">         ______________________   ___________________________</span>
<span class="cm">         </span>
<span class="cm">         a:                            # (some action id), 7 tabs</span>
<span class="cm">         bbbbbbbbbb:                    # (some action id), 5 tabs </span>
<span class="cm">         </span>
<span class="cm">         2:                          7</span>
<span class="cm">         3.:                         7         2 ch or less, 7 tabs</span>
<span class="cm">         4..:                        6</span>
<span class="cm">         5...:                       6</span>
<span class="cm">         6....:                      6</span>
<span class="cm">         7.....:                     6        6 ch or less, 6 tabs</span>
<span class="cm">         8......:                    5</span>
<span class="cm">         9.......:                   5</span>
<span class="cm">         10.......:                  5</span>
<span class="cm">         11........:                 5       10 ch or less, 5 tabs</span>
<span class="cm">         12.........:                4</span>
<span class="cm">         13..........:               4</span>
<span class="cm">         14...........:              4</span>
<span class="cm">         15............:             4       14 ch or less, 4 tabs</span>
<span class="cm">         16.............:            3</span>
<span class="cm">         17..............:           3</span>
<span class="cm">         18...............:          3</span>
<span class="cm">         19................:         3       18 ch or less, 3 tabs</span>
<span class="cm">         20.................:        2</span>
<span class="cm">         21..................:       2</span>
<span class="cm">         22...................:      2</span>
<span class="cm">         23....................:     2       22 ch or less, 2 tabs</span>
<span class="cm">         24.....................:    1</span>
<span class="cm">         25......................:   1</span>
<span class="cm">         26.......................:  1</span>
<span class="cm">         27........................: 1</span>
<span class="cm">         28.........................:1</span>
<span class="cm">         </span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS>
      
      <span class="n">format_for_notepadPlusPlus</span> <span class="o">:=</span> <span class="nv">true</span> 
      <span class="n">format_for_notepadDotExe</span>   <span class="o">:=</span> <span class="nv">false</span>
      
      <span class="n">tab_string</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; Add 1 to the length to account for the colon (:) before tabs begin</span>
      <span class="n">cmd_length</span> <span class="o">:=</span> <span class="n">cmd_length</span> <span class="o">+</span> <span class="mi">1</span> 
      
      <span class="n">textEditorTabWidth</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">format_for_notepadPlusPlus</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">textEditorTabWidth</span> <span class="o">:=</span> <span class="mf">4.0</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> 
      <span class="k">if</span><span class="ss">(</span> <span class="n">format_for_notepadDotExe</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">textEditorTabWidth</span> <span class="o">:=</span> <span class="mf">8.0</span>
      <span class="p">}</span></DETAILS>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">24</span> <span class="o">&lt;=</span> <span class="n">cmd_length</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">tab_string</span> <span class="o">:=</span> <span class="s">&quot;</span><span class="se">`t</span><span class="s">&quot;</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">cmd_length</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">empty_space_to_fill</span> <span class="o">:=</span> <span class="mi">28</span> <span class="o">-</span> <span class="n">cmd_length</span>
         <span class="n">num_spaces_with_remainder</span> <span class="o">:=</span> <span class="n">empty_space_to_fill</span> <span class="o">/</span> <span class="n">textEditorTabWidth</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;---------------------------------------------------------</span>
<span class="c1">         ; AutoHotkey Documentation:</span>
<span class="c1">         ; Ceil : </span>
<span class="c1">         ;   &quot;Returns Number rounded up to the nearest integer </span>
<span class="c1">         ;    (without any .00 suffix).&quot;</span>
<span class="c1">         ;---------------------------------------------------------</span>
<span class="c1">         ; https://www.autohotkey.com/docs/commands/Math.htm#Ceil</span>
<span class="c1">         ;---------------------------------------------------------</span>
         
         <span class="n">number_of_tabs</span> <span class="o">:=</span> <span class="kr">Ceil</span><span class="ss">(</span> <span class="n">num_spaces_with_remainder</span> <span class="ss">)</span><span class="c1"></span>
<span class="c1">         ; msgbox num tabs %number_of_tabs%</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="n">Loop</span><span class="p">,</span> <span class="vi">%number_of_tabs%</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">tab_string</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`t</span><span class="s">&quot;</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
      
      <span class="k">return</span> <span class="n">tab_string</span>
   <span class="p">}</span></DETAILS>


<span class="p">}</span><span class="c1"> ; end of class: FILE_HELPER  </span></DETAILS>


<span class="c1">;-------------------------------------------;</span>
<span class="c1">;  The remaining classes are located        ;</span>
<span class="c1">;  in program_launcher_settings_window.ahk  ;</span>
<span class="c1">;-------------------------------------------;</span>



<span class="c1">;===============================;</span>
<span class="c1">; &lt;/&gt;   end of Class section    ;</span>
<span class="c1">;===============================;</span>


<span class="c1">;-----------------------------------------------------------------------------------------------</span>


<span class="c1">;================================================;</span>
<span class="c1">;                                                ;</span>
<span class="c1">;          Text for Default Savefile             ;</span>
<span class="c1">;                                                ;</span>
<span class="c1">;================================================;</span>

<DETAILS class="leading_tabs_0"><SUMMARY><span class="nf">Default_Save_File</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<span class="nb">global</span> <span class="vc">_savefile__default_content</span>


   <span class="vc">_savefile__default_content</span> <span class="o">:=</span> <span class="s">&quot;</span>
   <span class="g">(</span>
<span class="g">      ;====================================================================</span>
<span class="g">      ; file:     program_launcher_saved_phrases.ini</span>
<span class="g">      ; purpose:  program_launcher.ahk&#39;s saved data + tutorial</span>
<span class="g">      ;====================================================================</span>


<span class="g">             ;____________________________;</span>
<span class="g">             ;                            ;</span>
<span class="g">             ;          SETTINGS          ;</span>
<span class="g">             ;____________________________;</span>


<span class="g">      SETTINGS[</span>
<span class="g">         icon: 95</span>
<span class="g">         hotkey_for_commandline_popup: ctrl win space</span>
<span class="g">         hotkey_for_quit: ctrl win alt q</span>
<span class="g">      ]</span>



<span class="g">          ;______________________________________;</span>
<span class="g">          ;                                      ;</span>
<span class="g">          ;              SAVED DATA              ;</span>
<span class="g">          ;______________________________________;</span>
<span class="g">          ;                                      ;</span>
<span class="g">          ;          COMMANDS + ACTIONS          ;</span>
<span class="g">          ;______________________________________;</span>
<span class="g">          </span>

<span class="g">      COMMANDS[</span>
<span class="g">         config:                      SETTINGS</span>
<span class="g">         quit:                        QUIT</span>
<span class="g">         c:                           1</span>
<span class="g">         notepad:                     2</span>
<span class="g">         calc:                        3</span>
<span class="g">         paint:                       4</span>
<span class="g">      ]</span>

<span class="g">      ACTIONS[</span>
<span class="g">         SETTINGS</span>
<span class="g">         QUIT</span>
<span class="g">         1, Folder, &quot;&quot;C:\&quot;&quot;</span>
<span class="g">         2, App,    &quot;&quot;C:\Windows\System32\notepad.exe&quot;&quot;</span>
<span class="g">         3, App,    &quot;&quot;C:\Windows\System32\calc.exe&quot;&quot;</span>
<span class="g">         4, App,    &quot;&quot;C:\Windows\System32\mspaint.exe&quot;&quot;</span>
<span class="g">      ]</span>


<span class="g">      </span>
<span class="g">            ;-----------------------------------------------------;</span>
<span class="g">            ; Note 1:    Lines beginning with a &#39;;&#39; are ignored.  ;</span>
<span class="g">            ; Note 2:    Use Notepad++ or Sublime text editor     ;</span>
<span class="g">            ;                if the formatting looks strange.     ;</span>
<span class="g">            ;                                                     ;</span>
<span class="g">            ;     Notepad.exe uses tabs which are 16 spaces wide, ; </span>
<span class="g">            ;            and will not display this document well. ; </span>
<span class="g">            ;-----------------------------------------------------;</span>


<span class="g">      ;===========================================================================</span>
<span class="g">      ; About the program:                                  program_launcher.ahk</span>
<span class="g">      ;===========================================================================</span>
<span class="g">      ;</span>
<span class="g">      ;</span>
<span class="g">      ;  ------------------</span>
<span class="g">      ;  What it does:</span>
<span class="g">      ;  ------------------</span>
<span class="g">      ;</span>
<span class="g">      ;  program_launcher.ahk is a small utility </span>
<span class="g">      ;  to reduce the number of steps to</span>
<span class="g">      ;</span>
<span class="g">      ;         (1) open programs or</span>
<span class="g">      ;         (2) navigate to folders</span>
<span class="g">      ;             (by opening the folder</span>
<span class="g">      ;              in a new Windows Explorer window).</span>
<span class="g">      ;</span>
<span class="g">      ;</span>
<span class="g">      ;  You can register a word or phrase as a [Command]</span>
<span class="g">      ;  which program_launcher.ahk will associate with an [Action].</span>
<span class="g">      ;</span>
<span class="g">      ;  Program Launcher&#39;s main hotkey will open a small popup.</span>
<span class="g">      ;  Type a command into the popup, then press enter</span>
<span class="g">      ;  and your action will run!</span>
<span class="g">      ;</span>
<span class="g">      ;</span>
<span class="g">      ;  --------------------</span>
<span class="g">      ;  Commands + Actions:</span>
<span class="g">      ;  --------------------</span>
<span class="g">      ;  </span>
<span class="g">      ;  A command can be any single-line series of typable text you desire.</span>
<span class="g">      ;  </span>
<span class="g">      ;  Each command triggers one specific action.</span>
<span class="g">      ;  Each action can have multiple commands which trigger it.</span>
<span class="g">      ; </span>
<span class="g">      ;  Example:</span>
<span class="g">      ;</span>
<span class="g">      ;     Register the command &quot;&quot;Show me my muisc&quot;&quot; </span>
<span class="g">      ;     -&gt; to open the folder C:/Music in a new window.</span>
<span class="g">      ;     </span>
<span class="g">      ;     Register (also) the command &quot;&quot;mu&quot;&quot;</span>
<span class="g">      ;     -&gt; to open the folder C:/Music in a new window.</span>
<span class="g">      ;  </span>
<span class="g">      ;  Currently, commands can only be one line long, but can contain: </span>
<span class="g">      ;  </span>
<span class="g">      ;     () any alphanumeric text</span>
<span class="g">      ;     () spaces</span>
<span class="g">      ;     () symbols `~!@#$%^&amp;*()_+-=[]\{}|;&#39;:&quot;&quot;,./&lt;&gt;?</span>
<span class="g">      ;</span>
<span class="g">      ;  Actions fall into three categories:</span>
<span class="g">      ;</span>
<span class="g">      ;     (1) Open a folder in a new window.</span>
<span class="g">      ;     (2) Open an application.</span>
<span class="g">      ;     (3) program_launcher.ahk functions: </span>
<span class="g">      ;         () Quit </span>
<span class="g">      ;         () Settings</span>
<span class="g">      ;</span>
<span class="g">      ;</span>
<span class="g">      ;  ------------------</span>
<span class="g">      ;  How to use it:</span>
<span class="g">      ;  ------------------</span>
<span class="g">      ;</span>
<span class="g">      ;  Run program_launcher.ahk</span>
<span class="g">      ;</span>
<span class="g">      ;  (1) Add some commands:</span>
<span class="g">      ;</span>
<span class="g">      ;     (1.1)  Hit the hotkey to bring up the command prompt </span>
<span class="g">      ;</span>
<span class="g">      ;            (By default, this is Ctrl+Windows+Space.</span>
<span class="g">      ;            This can be changed using this file, </span>
<span class="g">      ;            or by using the settings window).</span>
<span class="g">      ;</span>
<span class="g">      ;     (1.2)  A popup will appear.</span>
<span class="g">      ;            Type &#39;settings&#39; or &#39;config&#39; or &#39;configuration&#39; here</span>
<span class="g">      ;            (without quotes).</span>
<span class="g">      ;</span>
<span class="g">      ;     (1.3)  Hit &lt;Enter&gt; or press &quot;&quot;OK&quot;&quot;.</span>
<span class="g">      ;</span>
<span class="g">      ;     (1.4)  The command popup will disappear.</span>
<span class="g">      ;            The settings window will appear.</span>
<span class="g">      ;</span>
<span class="g">      ;            Change or add commands and actions.</span>
<span class="g">      ;</span>
<span class="g">      ;     (1.5)  Close the settings window.</span>
<span class="g">      ;            Your changes will be automatically saved to this file.</span>
<span class="g">      ;</span>
<span class="g">      ;  (2) Use your commands:</span>
<span class="g">      ;</span>
<span class="g">      ;     (2.1)  Hit the hotkey to bring up the command prompt</span>
<span class="g">      ;            (default setting is Ctrl+Windows+Space)</span>
<span class="g">      ;  </span>
<span class="g">      ;     (2.2)  Type one of the commands you registered in (1.4)</span>
<span class="g">      ;</span>
<span class="g">      ;     (2.3)  Hit &lt;Enter&gt; or press &quot;&quot;OK&quot;&quot;.</span>
<span class="g">      ;</span>
<span class="g">      ;     (2.4)  Enjoy!</span>
<span class="g">      ;  </span>
<span class="g">      ;</span>
<span class="g">      ;</span>
<span class="g">      ;  -------------------------------</span>
<span class="g">      ;  How do I know if it&#39;s running?</span>
<span class="g">      ;  -------------------------------</span>
<span class="g">      ;</span>
<span class="g">      ;  Run program_launcher.ahk.</span>
<span class="g">      ;  You will see its icon appear in Window&#39;s &quot;&quot;Notificaiton Area&quot;&quot; </span>
<span class="g">      ;  (located at the right end of the Windows Taskbar, just before the clock).</span>
<span class="g">      ;</span>
<span class="g">      ;  If you hover your mouse over this script&#39;s icon in the Notificaiton Area,</span>
<span class="g">      ;  a tooltip will appear saying &quot;&quot;program_launcher.ahk&quot;&quot;.</span>
<span class="g">      ;</span>
<span class="g">      ;</span>
<span class="g">      ;  -------------------</span>
<span class="g">      ;  How do I close it?</span>
<span class="g">      ;  -------------------</span>
<span class="g">      ;</span>
<span class="g">      ;  To close program_launcher.ahk either:</span>
<span class="g">      ;</span>
<span class="g">      ;  (1) Right click its icon in the Notificaiton Tray and click &quot;&quot;Exit&quot;&quot;. </span>
<span class="g">      ;</span>
<span class="g">      ;  (2) Quit using a command:</span>
<span class="g">      ;         </span>
<span class="g">      ;      (2.1)  Press the hotkey to display the commandline popup</span>
<span class="g">      ;             (by default, this hotkey is Ctrl+Win+Space). </span>
<span class="g">      ;      (2.2)  Type &#39;q&#39; or &#39;quit&#39; or &#39;exit&#39; without quotes (&#39;).</span>
<span class="g">      ;      (2.3)  Hit enter or click &quot;&quot;OK&quot;&quot;.</span>
<span class="g">      ;      (2.4)  The program will stop running. </span>
<span class="g">      ;</span>
<span class="g">      ;   </span>
<span class="g">      ;===========================================================================</span>


<span class="g">      ;====================================================================</span>
<span class="g">      ; About this config file:         program_launcher_saved_phrases.ini</span>
<span class="g">      ;====================================================================</span>
<span class="g">      ;</span>
<span class="g">      ;  ------------------</span>
<span class="g">      ;  Commented lines : </span>
<span class="g">      ;  ------------------</span>
<span class="g">      ;</span>
<span class="g">      ;     program_launcher.ahk will ignore any line</span>
<span class="g">      ;     in this config file if it starts with &#39;;&#39;</span>
<span class="g">      ;  </span>
<span class="g">      ;     Feel free to keep, alter, move, or remove any commented lines.</span>
<span class="g">      ;     It won&#39;t affect program_launcher.ahk&#39;s behavior.</span>
<span class="g">      ;  </span>
<span class="g">      ;  -----------</span>
<span class="g">      ;  Settings :</span>
<span class="g">      ;  -----------</span>
<span class="g">      ;   </span>
<span class="g">      ;  Setting name:               &quot;&quot;icon&quot;&quot;</span>
<span class="g">      ;  Value for setting:          Integer number.</span>
<span class="g">      ;</span>
<span class="g">      ;    How it works: </span>
<span class="g">      ;</span>
<span class="g">      ;      This number corresponds to a Shell32.dll icon number.</span>
<span class="g">      ;      This script will use this icon</span>
<span class="g">      ;      (1) in the Windows Notification Tray </span>
<span class="g">      ;      (2) in the window title bars for program_launcher.ahk&#39;s</span>
<span class="g">      ;          (2.a) commandline popup</span>
<span class="g">      ;          (2.b) configuration window</span>
<span class="g">      ;  </span>
<span class="g">      ;  </span>
<span class="g">      ;  Setting name:               &quot;&quot;hotkey_for_commandline_popup&quot;&quot;</span>
<span class="g">      ;  Value for setting:          Key names separated by spaces.</span>
<span class="g">      ;</span>
<span class="g">      ;    How it works: </span>
<span class="g">      ;    </span>
<span class="g">      ;      When this hotkey is pressed</span>
<span class="g">      ;      program_launcher.ahk displays its commandline popup.</span>
<span class="g">      ;</span>
<span class="g">      ;</span>
<span class="g">      ;  Setting name:               &quot;&quot;hotkey_for_quit&quot;&quot;</span>
<span class="g">      ;  Value for setting:          Key names separated by spaces.</span>
<span class="g">      ;</span>
<span class="g">      ;    How it works: </span>
<span class="g">      ;    </span>
<span class="g">      ;      When this hotkey is pressed</span>
<span class="g">      ;      program_launcher.ahk exits.</span>
<span class="g">      ;</span>
<span class="g">      ;</span>
<span class="g">      ;   ---------------------</span>
<span class="g">      ;   Commands + Actions : </span>
<span class="g">      ;   ---------------------</span>
<span class="g">      ;     </span>
<span class="g">      ;   Commands can be registered to actions in two ways:</span>
<span class="g">      ;</span>
<span class="g">      ;      (1) Add them manually to this settings file, </span>
<span class="g">      ;          then refresh program_launcher.ahk.</span>
<span class="g">      ;</span>
<span class="g">      ;          Press the the hotkey associated with </span>
<span class="g">      ;          [hotkey_for_commandline_popup]</span>
<span class="g">      ;          </span>
<span class="g">      ;          Type &#39;r&#39; or &#39;reload&#39;, and hit enter.</span>
<span class="g">      ;</span>
<span class="g">      ;      (2) Add them using the settings window.</span>
<span class="g">      ;</span>
<span class="g">      ;          Open program_launcher.ahk&#39;s command prompt </span>
<span class="g">      ;          (by default, this hotkey is Ctrl+Win+Space)</span>
<span class="g">      ;          then type &#39;settings&#39; or &#39;config&#39; or &#39;configuration&#39; </span>
<span class="g">      ;          press OK, then the configuration window should appear.</span>
<span class="g">      ;</span>
<span class="g">      ;   Commands can contain:</span>
<span class="g">      ;     (+) spaces*</span>
<span class="g">      ;     (+) symbols</span>
<span class="g">      ;     (+) any printable ASCII character.</span>
<span class="g">      ;     *see note below.</span>
<span class="g">      ;</span>
<span class="g">      ;   Each Command phrase is associated with a single action.</span>
<span class="g">      ;   program_launcher.ahk handles two action types, either :</span>
<span class="g">      ;     (1) launch a specific explorer folder, or</span>
<span class="g">      ;     (2) launch a program (optionally with a passed default path)</span>
<span class="g">      ;  </span>
<span class="g">      ;====================================================================</span>


<span class="g">      ;===========================================================================</span>
<span class="g">      ; Help</span>
<span class="g">      ;===========================================================================</span>
<span class="g">      ;</span>
<span class="g">      ; ------------------------------</span>
<span class="g">      ; How do I back up my settings?</span>
<span class="g">      ; ------------------------------</span>
<span class="g">      ;</span>
<span class="g">      ; (1) Using Windows Explorer</span>
<span class="g">      ;     copy and paste the file &quot;&quot;program_launcher_saved_phrases.ini&quot;&quot; </span>
<span class="g">      ;     (the settings file you&#39;re reading right now) to make a backup.</span>
<span class="g">      ;</span>
<span class="g">      ;     If the reader is unfamiliar, these are the steps: </span>
<span class="g">      ;</span>
<span class="g">      ;       (1.1) Navigate to this file in Windows Explorer.</span>
<span class="g">      ;       (1.2) Select this file by clicking it once.</span>
<span class="g">      ;       (1.3) Press &lt;Ctrl+C&gt; to copy it.</span>
<span class="g">      ;       (1.4) Press &lt;Ctrl+V&gt; to paste it.</span>
<span class="g">      ;             This will create a duplicate copy.</span>
<span class="g">      ;       </span>
<span class="g">      ;       Fun trivia: When you paste the file in step (1.4), </span>
<span class="g">      ;       it does not matter if the file is still selected (or not).</span>
<span class="g">      ;       Windows Explorer ignores what is (or isn&#39;t) selected </span>
<span class="g">      ;       when you tell it to paste files,</span>
<span class="g">      ;       it only cares about which folder you are currently in.</span>
<span class="g">      ;       </span>
<span class="g">      ;       Conversely, Windows Explorer does care about what is selected </span>
<span class="g">      ;       when you copy files in step (1.3), and will copy all selected files.</span>
<span class="g">      ;</span>
<span class="g">      ;</span>
<span class="g">      ; (2) Rename the duplicate file and give it a new name like:</span>
<span class="g">      ;     &quot;&quot;program_launcher_saved_phrases.ini.backup123&quot;&quot;</span>
<span class="g">      ;     or any name you prefer.</span>
<span class="g">      ;   </span>
<span class="g">      ;     As long as the backup&#39;s name doesn&#39;t exactly match</span>
<span class="g">      ;     &quot;&quot;program_launcher_saved_phrases.ini&quot;&quot;, </span>
<span class="g">      ;     the backup will be ignored.</span>
<span class="g">      ;</span>
<span class="g">      ; </span>
<span class="g">      ; ----------------------------------------------------</span>
<span class="g">      ; How to I restore the default settings and commands?</span>
<span class="g">      ; ----------------------------------------------------</span>
<span class="g">      ;</span>
<span class="g">      ; program_launcher.ahk can auto-generate this file.</span>
<span class="g">      ;</span>
<span class="g">      ; NOTE: This step will not auto-generate your custom commands and actions.</span>
<span class="g">      ;       Be sure to make a backup file first. </span>
<span class="g">      ;</span>
<span class="g">      ;   (a) Move or copy</span>
<span class="g">      ;      program_launcher.ahk to a directory without</span>
<span class="g">      ;      program_launcher_saved_phrases.ini.</span>
<span class="g">      ;      </span>
<span class="g">      ;      When you run program_launcher.ahk </span>
<span class="g">      ;      the default version of this settings file will be auto-generated.</span>
<span class="g">      ;</span>
<span class="g">      ;   (b) Alternatively</span>
<span class="g">      ;===========================================================================</span>
<span class="g">      </span>
<span class="g">      </span>
<span class="g">      </span>
<span class="g">      </span>
<span class="g">      </span>
<span class="g">      </span>
<span class="g">   )</span><span class="s">&quot;</span>
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;---------------------------------------------------------------------------------</span>
<span class="c1">   ;    Remove leading tabs from continuation section variable.</span>
<span class="c1">   ;--------------------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">   ;</span>
<span class="c1">   ; To skip this step, </span>
<span class="c1">   ; I could have made the long continuation section above </span>
<span class="c1">   ; flush with the left of the document (with no indentations)</span>
<span class="c1">   ;</span>
<span class="c1">   ; But I like to keep blocks indented. </span>
<span class="c1">   ;</span>
<span class="c1">   ; Here&#39;s the process for the next few lines:</span>
<span class="c1">   ;</span>
<span class="c1">   ;   (1)   Look at the number of tabs at the very beginning </span>
<span class="c1">   ;       of the savefile content variable.</span>
<span class="c1">   ;</span>
<span class="c1">   ;       Save these leading tabs in a variable named detected_leading_tabs</span>
<span class="c1">   ;</span>
<span class="c1">   ;   (2) Get the number of tabs by getting the length of the string.</span>
<span class="c1">   ;</span>
<span class="c1">   ;   (3) For each line in the variable _savefile__default_content</span>
<span class="c1">   ;      remove the number of tabs detected in step (2).</span>
<span class="c1">   ;</span>
<span class="c1">   ;</span>
<span class="c1">   ; Additional step in part (3): </span>
<span class="c1">   ;</span>
<span class="c1">   ;     Convert each default linefeed newline      (&quot;`n&quot;) </span>
<span class="c1">   ;     into a carriage return + linefeed newline  (&quot;`r`n&quot;)</span>
<span class="c1">   ;    </span>
<span class="c1">   ;    Without this step, the RegularExpression doesn&#39;t properly work with the </span>
<span class="c1">   ;    </span>
<span class="c1">   ;       begining of line anchor     (&quot;^&quot;) </span>
<span class="c1">   ;       and end of line anchor      (&quot;$&quot;)</span>
<span class="c1">   ;</span>
<span class="c1">   ; Read more about the necessity of this conversion here:</span>
<span class="c1">   ;    https://autohotkey.com/board/topic/115426-multiline-regexreplace/#entry668977</span>
<span class="c1">   ;--------------------------------------------------------------------------------- </span></DETAILS>
<span class="c1">   </span>
<span class="c1">   ;-------;</span>
<span class="c1">   ;  (1)  ;</span>
<span class="c1">   ;-------;</span>
   <span class="kr">RegExMatch</span><span class="ss">(</span><span class="vc">_savefile__default_content</span><span class="p">,</span> <span class="s">&quot;^([\t]*)&quot;</span><span class="p">,</span> <span class="n">detected_leading_tabs</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">   ;-------;</span>
<span class="c1">   ;  (2)  ;</span>
<span class="c1">   ;-------;</span>
   <span class="n">num_tabs_to_rm</span> <span class="o">:=</span> <span class="kr">StrLen</span><span class="ss">(</span><span class="n">detected_leading_tabs</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">   ;-------;</span>
<span class="c1">   ;  (3)  ;</span>
<span class="c1">   ;-------;</span>
   
   <span class="vc">_savefile__default_content</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="vc">_savefile__default_content</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">`r`n</span><span class="s">&quot;</span><span class="ss">)</span>
   <span class="vc">_savefile__default_content</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="vc">_savefile__default_content</span><span class="p">,</span> <span class="s">&quot;Um)^\t{&quot;</span> <span class="n">num_tabs_to_rm</span> <span class="s">&quot;}(.*)$&quot;</span><span class="p">,</span><span class="s">&quot;$1&quot;</span><span class="ss">)</span>
   
   <span class="k">return</span>
   
<span class="p">}</span></DETAILS>









<span class="nb">#Include</span> <span class="n">program_launcher_settings_window</span><span class="o">.</span><span class="n">ahk</span>
   
   
</pre></div>
</div>
<p></div>
</details>
</div></p>
<p><div class="collapsible_wrapper">
<details class="collapsible_section_via_details"><summary><strong>program_launcher_settings_window.ahk</strong> </summary> <div class="collapsible_codeblock_section"></p>
<div class="highlight-AutoHotkey_CustomLexer notranslate"><div class="highlight"><pre><span></span><span class="c1">            ;-------------------------------------;</span>
<span class="c1">            ;                                     ;</span>
<span class="c1">            ;           PUBLIC DOMAIN             ;</span>
<span class="c1">            ;                                     ;</span>
<span class="c1">            ;       This file is released         ;</span>
<span class="c1">            ;       under the cc0 license.        ;</span>
<span class="c1">            ;                                     ;</span>
<span class="c1">            ;-------------------------------------;</span>
<span class="c1">            ;                                     ;</span>
<span class="c1">            ;   Written by:                       ;</span>
<span class="c1">            ;                    Gamepad-Coder    ;</span>
<span class="c1">            ;                                     ;</span>
<span class="c1">            ;-------------------------------------;</span>


<span class="c1">;-----------------------------------------------------------------------;</span>
<span class="c1">;  program_launcher_settings_window.ahk                                 ;</span>
<span class="c1">;-----------------------------------------------------------------------;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;                                                     version 2         ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;  This file contains the GUI interface for program_launcher.ahk.       ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;  To open this GUI config window:                                      ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;     (1) Run program_launcher.ahk,                                     ;</span>
<span class="c1">;     (2) Use the command to open the settings,                         ;</span>
<span class="c1">;         (by default, the command is &quot;config&quot;, no quotes).             ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;         This script&#39;s code will be used to show the user              ;</span>
<span class="c1">;         a settings window which facilitates modifying                 ;</span>
<span class="c1">;         the settings.ini file.                                        ;</span>
<span class="c1">;                                                                       ;</span>
<span class="c1">;   This file cannot be run in isolation.                               ;</span>
<span class="c1">;   It&#39;s really just the second half of program_launcher.ahk,           ;</span>
<span class="c1">;   but separated into a second file to improve readability.            ;</span>
<span class="c1">;-----------------------------------------------------------------------;</span>


<DETAILS class="leading_tabs_0"><SUMMARY><span class="k">class</span> <span class="n">GuiConfigMain</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>

<span class="c1">   ;----------------------------------------------------------------------</span>
<span class="c1">   ; These text strings are specific to the checkbox at the bottom </span>
<span class="c1">   ; of Tab1 of this window. These vars won&#39;t be altered, only accessed.</span>
<span class="c1">   ;</span>
   <span class="nb">static</span> <span class="n">CheckboxShowAll_TextForChecked</span>  <span class="o">:=</span> <span class="s">&quot;SHOW ALL   (Uncheck to hide disabled commands)   &quot;</span>
   <span class="nb">static</span> <span class="n">CheckboxShowAll_TextForUnchecked</span> <span class="o">:=</span> <span class="s">&quot;SHOW ALL   (Check to also show disabled commands)&quot;</span>
   
   
   <span class="nb">static</span> <span class="vc">_plucked_command</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
   <span class="nb">static</span> <span class="vc">_plucked_action</span>  <span class="o">:=</span> <span class="s">&quot;&quot;</span>
   
   <span class="nb">static</span> <span class="vc">_is_gui_baked</span> <span class="o">:=</span> <span class="nv">false</span>


<DETAILS class="leading_tabs_1"><SUMMARY><span class="nn">__New</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">   ; global </span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------;</span>
<span class="c1">      ; Global vars to use elsewhere</span>
<span class="c1">      ;</span>
      
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Initialize_Gui_gVariables</span><span class="ss">()</span>
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Init_Config_Gui_and_TabControl</span><span class="ss">()</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Init_Config_1st_Tab</span><span class="ss">()</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Init_Config_2nd_Tab</span><span class="ss">()</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Init_Config_3rd_Tab</span><span class="ss">()</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Init_Config_4th_Tab</span><span class="ss">()</span>
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_Action_Buttons_Disable</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;==================================;</span>
<span class="c1">      ; Render + Display main GUI window ;</span>
<span class="c1">      ;==================================;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Show</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      ; _is_MainGui_baked := true </span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">GUI_EVENT_OnSize</span><span class="ss">(</span> <span class="s">&quot;Gui up and running&quot;</span> <span class="ss">)</span>
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Init_ReadProgramArraysIntoGui</span><span class="ss">()</span>
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_is_gui_baked</span> <span class="o">:=</span> <span class="nv">true</span> 
      
      <span class="k">return</span> <span class="nn">this</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nn">__Delete</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">   ; global </span>
<span class="c1">   </span>
<span class="c1">      ; Clear static class members between Config Window instances.</span>
            
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_command</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_action</span>  <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; Clear static function variables in OnSize() function</span>
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">GUI_EVENT_OnSize</span><span class="ss">(</span> <span class="s">&quot;RESET&quot;</span> <span class="ss">)</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_is_gui_baked</span> <span class="o">:=</span> <span class="nv">false</span>
      
      <span class="kr">Gui</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Destroy</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">   ;============================================================</span>
<span class="c1">   ;         GuiConfigMain (Main Window)  </span>
<span class="c1">   ;============================================================</span>

   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Initialize_Gui_gVariables</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      ;-------------------------------------------------------------------------</span>
<span class="c1">      ; </span>
<span class="c1">      ; It&#39;s a good practice to clear global variables </span>
<span class="c1">      ; for GUIs which are created multiple times over the lifespan of a script.</span>
<span class="c1">      ; </span>
<span class="c1">      ;-------------------------------------------------------------------------      </span>
      
      <span class="n">GuiConfigMain_Tabs</span>                              <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">GuiConfigMain_ListViewCmds</span>                      <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain_ButtonNewCmd</span>                      <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain_ButtonEditCmd</span>                     <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain_ButtonDeleteCmd</span>                   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain_CheckboxShowAll</span>                   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">GuiConfigMain_ListViewActions</span>                   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain_ButtonNewAction</span>                   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain_ButtonEditAction</span>                  <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain_ButtonDeleteAction</span>                <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">GuiConfigMain_Settings_ABOUT</span>                    <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain_Settings_ButtonExport</span>             <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain_Settings_ButtonImportAsDisabled</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>  
      <span class="n">GuiConfigMain_Settings_ButtonImportAsEnabled</span>    <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigMain_Settings_Info</span>                     <span class="o">:=</span> <span class="s">&quot;&quot;</span>
       
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Config_Gui_and_TabControl</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      ;========================;</span>
<span class="c1">      ; Create main GUI window ;</span>
<span class="c1">      ;========================;</span>
      
        <span class="n">title_for_GuiConfigMain_Window</span> <span class="o">:=</span> <span class="s">&quot;_program_launcher.ahk - Configuration&quot;</span>
      <span class="n">options_for_GuiConfigMain_Window</span> <span class="o">:=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Label&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_On&quot;</span>
      <span class="n">options_for_GuiConfigMain_Window</span> <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Resize +MinSize420x375&quot;</span>

      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">New</span>
         <span class="p">,</span> <span class="vi">%options_for_GuiConfigMain_Window%</span>
         <span class="p">,</span> <span class="vi">%title_for_GuiConfigMain_Window%</span><span class="c1"></span>


<span class="c1">      ;--------------------------------;</span>
<span class="c1">      ; Ensures future &quot;Gui,&quot; commands </span>
<span class="c1">      ; add specifically to the Gui </span>
<span class="c1">      ; using the name &quot;ConfigMain:&quot;. </span>
<span class="c1">      ;</span>
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Default</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">      ;=========================================================;</span>
<span class="c1">      ; Hidden Button to allow detection of &lt;Enter&gt; key events  ;</span>
<span class="c1">      ;=========================================================;</span>
     
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_ButtonHiddenDefault&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Hidden +Default w0 h0&quot;</span>
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span> <span class="s">&quot;&quot;</span><span class="c1"></span>


<span class="c1">      ;================================</span>
<span class="c1">      ; Add Tab Container with 3 tabs</span>
<span class="c1">      ; - Commands</span>
<span class="c1">      ; - Actions</span>
<span class="c1">      ; - Settings</span>
<span class="c1">      ;================================</span>

         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Commands|Actions|Settings|   ?   &quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_Tabs&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigMain_Tabs&quot;</span>
         
         
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Tab3</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span> <span class="vi">%text%</span>
         
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Config_1st_Tab</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">     ;[1][1][1][1][1][1][1][1][1][1][1][1][1]~</span>
<span class="c1">     ;---------------TAB SWITCH---------------</span>
<span class="c1">     ;</span>
<span class="c1">     ; 1st Tab will receive </span>
<span class="c1">     ; Gui Controls added after this line</span>
<span class="c1">     ;</span>
<span class="c1">     ;---------------TAB SWITCH---------------</span>
<span class="c1">     ;[1][1][1][1][1][1][1][1][1][1][1][1][1]~</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="kp">Tab</span><span class="p">,</span> <span class="mi">1</span><span class="c1">      </span>

<span class="c1">      </span>
<span class="c1">      ;=======================;</span>
<span class="c1">      ; ListView for Commands ;</span>
<span class="c1">      ;=======================;</span>

<span class="c1">        ;------------------------------------------------------------</span>
<span class="c1">        ; Note:</span>
<span class="c1">        ;   The style &quot;LV0x10000&quot; is LVS_EX_DOUBLEBUFFER, </span>
<span class="c1">        ;   and (in some cases) helps reduce flikering upon redrawing</span>
<span class="c1">        ;------------------------------------------------------------</span>
<span class="c1">        ; Read More Here:</span>
<span class="c1">        ;   https://autohotkey.com/board/topic/89323-listview-and-flashing-on-redrawing-or-editing/</span>
<span class="c1">        ;   https://www.autohotkey.com/docs/misc/Styles.htm#ListView</span>
<span class="c1">        ;------------------------------------------------------------</span>
      
      <span class="n">text_column1</span> <span class="o">:=</span> <span class="s">&quot;Command     &quot;</span>
      <span class="n">text_column2</span> <span class="o">:=</span> <span class="s">&quot;|-&gt;&quot;</span>
      <span class="n">text_column3</span> <span class="o">:=</span> <span class="s">&quot;|Action ID&quot;</span>
      <span class="n">text_column4</span> <span class="o">:=</span> <span class="s">&quot;|Action Type&quot;</span>
      <span class="n">text_column5</span> <span class="o">:=</span> <span class="s">&quot;|Action Path&quot;</span>
      <span class="n">text_column6</span> <span class="o">:=</span> <span class="s">&quot;|Action Arg for Programs&quot;</span>
      <span class="n">text</span> <span class="o">:=</span> <span class="n">text_column1</span>
           <span class="o">.</span>  <span class="n">text_column2</span>
           <span class="o">.</span>  <span class="n">text_column3</span>
           <span class="o">.</span>  <span class="n">text_column4</span>
           <span class="o">.</span>  <span class="n">text_column5</span>
           <span class="o">.</span>  <span class="n">text_column6</span>
           
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_ListViewCommands&quot;</span> 
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigMain_ListViewCmds&quot;</span> 
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+checked +ReadOnly +AltSubmit -Multi&quot;</span> 
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;r20 w700&quot;</span> 
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+LV0x10000&quot;</span> 
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">ListView</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">      </span>

<span class="c1">      ;================================;</span>
<span class="c1">      ; Button to create a new Command ;</span>
<span class="c1">      ;================================;</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;[ + ] New Command&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_ButtonNewCmd&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigMain_ButtonNewCmd&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;section&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;================================;</span>
<span class="c1">      ; Button to Edit a Command ;</span>
<span class="c1">      ;================================;</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;[ : ] Edit Selected</span><span class="se">`n</span><span class="s">Command&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_ButtonEditCmd&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigMain_ButtonEditCmd&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;ys&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">      ;================================;</span>
<span class="c1">      ; Button to Delete a Command ;</span>
<span class="c1">      ;================================;</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;[ x ] Delete Selected</span><span class="se">`n</span><span class="s">Command&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_ButtonDeleteCmd&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigMain_ButtonDeleteCmd&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;ys&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;===========================;</span>
<span class="c1">      ; CheckBox to toggle        ;</span>
<span class="c1">      ; - display all             ;</span>
<span class="c1">      ; - or just display enabled ;</span>
<span class="c1">      ;===========================;</span>

         <span class="n">text</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="n">CheckboxShowAll_TextForChecked</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_CheckboxShowAll&quot;</span> 
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigMain_CheckboxShowAll&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;xs y+10&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;Checked&quot;</span> <span class="s">&quot;1&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">CheckBox</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span>
      
      
      <span class="k">return</span> 
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Config_2nd_Tab</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">     ;[2][2][2][2][2][2][2][2][2][2][2][2][2]~</span>
<span class="c1">     ;---------------TAB SWITCH---------------</span>
<span class="c1">     ;</span>
<span class="c1">     ; 2nd Tab will receive </span>
<span class="c1">     ; Gui Controls added after this line</span>
<span class="c1">     ;</span>
<span class="c1">     ;---------------TAB SWITCH---------------</span>
<span class="c1">     ;[2][2][2][2][2][2][2][2][2][2][2][2][2]~</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="kp">Tab</span><span class="p">,</span> <span class="mi">2</span><span class="c1">   </span>


<span class="c1">      ;=======================;</span>
<span class="c1">      ; ListView for Actions ;</span>
<span class="c1">      ;=======================;</span>

      <span class="n">gui_name</span>     <span class="o">:=</span> <span class="s">&quot;ConfigMain&quot;</span>
      <span class="n">goto_name</span>    <span class="o">:=</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_ListViewActions&quot;</span>
      <span class="n">control_name</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_ListViewActions&quot;</span>
      <span class="n">REUSABLE_GUI_CONTROLS</span><span class="o">.</span><span class="nf">create_listview_of_actions</span><span class="ss">(</span> <span class="n">gui_name</span>
         <span class="p">,</span> <span class="n">goto_name</span>
         <span class="p">,</span> <span class="n">control_name</span> <span class="ss">)</span><span class="c1"></span>
<span class="c1">      </span>

<span class="c1">      </span>
<span class="c1">      ;================================;</span>
<span class="c1">      ; Button to create a new Action  ;</span>
<span class="c1">      ;================================;</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;[ + ] New Action &quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_ButtonNewAction&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigMain_ButtonNewAction&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;section&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>


<span class="c1">      ;================================;</span>
<span class="c1">      ; Button to Edit an Action       ;</span>
<span class="c1">      ;================================;</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;[ : ] Edit Selected</span><span class="se">`n</span><span class="s">Action&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_ButtonEditAction&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigMain_ButtonEditAction&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;ys x137&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">      ;================================;</span>
<span class="c1">      ; Button to Delete an Action     ;</span>
<span class="c1">      ;================================;</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;[ x ] Delete Selected</span><span class="se">`n</span><span class="s">Action&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_ButtonDeleteAction&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigMain_ButtonDeleteAction&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;ys&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         </span>
<span class="c1">      ;================================;</span>
<span class="c1">      ; Button to Run an Action        ;</span>
<span class="c1">      ;================================;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="kp">Tab</span><span class="p">,</span> 
      
         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Run selected Action now.&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_ButtonRunAction&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigMain_ButtonRunAction&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;ym x600&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Hidden&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span>
      
      
      <span class="k">return</span> 
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Config_3rd_Tab</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">     ;[3][3][3][3][3][3][3][3][3][3][3][3][3]~</span>
<span class="c1">     ;---------------TAB SWITCH---------------</span>
<span class="c1">     ;</span>
<span class="c1">     ; 3rd Tab will receive </span>
<span class="c1">     ; Gui Controls added after this line</span>
<span class="c1">     ;</span>
<span class="c1">     ;---------------TAB SWITCH---------------</span>
<span class="c1">     ;[3][3][3][3][3][3][3][3][3][3][3][3][3]~</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="kp">Tab</span><span class="p">,</span> <span class="mi">3</span><span class="c1">   </span>
<span class="c1">      </span>


<span class="c1">      ;========================================;</span>
<span class="c1">      ; Button to change Application icon      ;</span>
<span class="c1">      ;========================================;</span>
      
         <span class="n">text</span> <span class="o">:=</span>  <span class="s">&quot;Change Window Icon.&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_Settings_ButtonIcon&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigMain_Settings_ButtonIcon&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+30 x+35&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">         </span>

<span class="c1">      ;========================================;</span>
<span class="c1">      ; Button to create a backup of settings  ;</span>
<span class="c1">      ;========================================;</span>
      
         <span class="n">text</span> <span class="o">:=</span>  <span class="s">&quot;Export a backup file.&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_Settings_ButtonExport&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigMain_Settings_ButtonExport&quot;</span><span class="c1"></span>
<span class="c1">      ; options  .= A_Space &quot;y+12&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+30&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">      </span>
<span class="c1">      ;==========================================;</span>
<span class="c1">      ; Button to import settings (disable cmds) ;</span>
<span class="c1">      ;==========================================;</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Import a backup file (but disable all imported commands).&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_Settings_ButtonImportAsDisabled&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigMain_Settings_ButtonImportAsDisabled&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot; y+12&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;==========================================;</span>
<span class="c1">      ; Button to import settings (enable cmds)  ;</span>
<span class="c1">      ;==========================================;</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Import a backup file (and enable all imported commands).&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigMain.GUI_EVENT_Settings_ButtonImportAsEnabled&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigMain_Settings_ButtonImportAsEnabled&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot; y+12&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>


<span class="c1">      ;=========================================</span>
<span class="c1">      ; Add `Text` Label:</span>
<span class="c1">      ;-----------------------------------------</span>
<span class="c1">      ; Inform User Drag-n-Drop is possible here</span>
<span class="c1">      ;=========================================</span>

         <span class="n">text</span> <span class="o">:=</span>  <span class="s">&quot;&quot;</span>
         <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;  Auto-Save:</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;     Actions, Commands, and Settings are automatically saved </span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;     the moment you change them (add, edit, enable/disable, delete).</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;     Actions, Commands, and Settings are saved to</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;     _program_launcher_settings.ini.</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;  On this tab :</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;     You can make a backup of this settings file,</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;     or add settings into your current save file</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;     by importing data from a backup.&quot;</span><span class="c1"></span>
<span class="c1">         ; text  .= &quot;`n`n`n&quot;</span>
         
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigMain_Settings_Info&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;Border &quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+30 w700 r10&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;x20&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+ReadOnly&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">Font</span><span class="p">,</span><span class="n">s12</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="kr">Edit</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span> <span class="vi">%text%</span> 
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">Font</span>
         

      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Config_4th_Tab</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">     ;[3][3][3][3][3][3][3][3][3][3][3][3][3]~</span>
<span class="c1">     ;---------------TAB SWITCH---------------</span>
<span class="c1">     ;</span>
<span class="c1">     ; 3rd Tab will receive </span>
<span class="c1">     ; Gui Controls added after this line</span>
<span class="c1">     ;</span>
<span class="c1">     ;---------------TAB SWITCH---------------</span>
<span class="c1">     ;[3][3][3][3][3][3][3][3][3][3][3][3][3]~</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="kp">Tab</span><span class="p">,</span> <span class="mi">4</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;=========================================</span>
<span class="c1">      ; Add `Edit` readonly Label: about </span>
<span class="c1">      ;=========================================</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_AboutTab_Get_Text</span><span class="ss">()</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigMain_Settings_ABOUT&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;Border &quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+30&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Readonly&quot;</span>
         
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">Font</span><span class="p">,</span><span class="n">s12</span><span class="p">,</span> <span class="n">Courier</span> <span class="n">New</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="kr">Edit</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span> <span class="vi">%text%</span> 
         
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">Font</span>

      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_ReadProgramArraysIntoGui</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>

<span class="c1">      ; Tells future ListView operations to operate on this specific ListView control</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;------------------;</span>
<span class="c1">      ; syntax reference ; </span>
<span class="c1">      ;-----------------------------------------------------------------;</span>
<span class="c1">      ;   _COMMANDS := { &quot;godot&quot; : {&quot;action_id&quot;:1, &quot;enabled&quot;:true} }    ;</span>
<span class="c1">      ;-----------------------------------------------------------------;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">for</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">cmd_info</span> <span class="ow">in</span> <span class="vc">_COMMANDS</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>

         <span class="n">action</span>      <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">action_type</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">action_path</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">action_arg</span>  <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         
         <span class="n">cmd_action_id</span>  <span class="o">:=</span> <span class="n">cmd_info</span><span class="p">[</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span>
         <span class="n">cmd_is_enabled</span> <span class="o">:=</span> <span class="n">cmd_info</span><span class="p">[</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">         ;------------------------------------------------------</span>
<span class="c1">         ; AutoHotkey Docs, Ternary Operator: </span>
<span class="c1">         ; https://www.autohotkey.com/docs/Variables.htm#ternary</span>
<span class="c1">         ;</span>
         <span class="n">lv_cmd_options</span> <span class="o">:=</span> <span class="ss">(</span><span class="nv">true</span><span class="o">==</span><span class="n">cmd_is_enabled</span><span class="ss">)</span> <span class="o">?</span> <span class="s">&quot;+Check&quot;</span> <span class="o">:</span> <span class="s">&quot;-Check&quot;</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">            </span>
<span class="c1">         ;==================================</span>
<span class="c1">         ; Get the Command&#39;s Action Data</span>
<span class="c1">         ;==================================</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">cmd_action_id</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">action</span> <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">cmd_action_id</span><span class="p">]</span>
            <span class="n">action_type</span> <span class="o">:=</span> <span class="n">action</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span>
            <span class="n">action_path</span> <span class="o">:=</span> <span class="n">action</span><span class="p">[</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
            <span class="n">action_arg</span>  <span class="o">:=</span> <span class="n">action</span><span class="p">[</span><span class="s">&quot;arg&quot;</span><span class="p">]</span><span class="c1"></span>
<span class="c1">            ; msgbox does have action id</span>
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;======================================================</span>
<span class="c1">         ; Add the Command to GuiConfigMain&#39;s Command ListView </span>
<span class="c1">         ;======================================================</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">cmd_action_id</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="ow">and</span> <span class="n">action_type</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="ow">and</span> <span class="n">action_path</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
            <span class="kr">LV_Add</span><span class="ss">(</span><span class="n">lv_cmd_options</span><span class="c1">   ; Check row if Command is enabled</span>
               <span class="p">,</span> <span class="n">cmd</span><span class="c1">                 ; row 1</span>
               <span class="p">,</span> <span class="s">&quot;&quot;</span><span class="c1">                  ; row 2</span>
               <span class="p">,</span> <span class="n">cmd_action_id</span><span class="c1">       ; row 3</span>
               <span class="p">,</span> <span class="n">action_type</span><span class="c1">         ; row 4</span>
               <span class="p">,</span> <span class="n">action_path</span><span class="c1">         ; row 5</span>
               <span class="p">,</span> <span class="n">action_arg</span> <span class="ss">)</span><span class="c1">        ; row 6</span>
            
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;SETTINGS&quot;</span> <span class="o">=</span> <span class="n">cmd_action_id</span>
         <span class="ow">or</span>       <span class="s">&quot;QUIT&quot;</span>     <span class="o">=</span> <span class="n">cmd_action_id</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
            <span class="kr">LV_Add</span><span class="ss">(</span><span class="n">lv_cmd_options</span><span class="c1">   ; Check row if Command is enabled</span>
               <span class="p">,</span> <span class="n">cmd</span><span class="c1">                 ; row 1</span>
               <span class="p">,</span> <span class="s">&quot;&quot;</span><span class="c1">                  ; row 2</span>
               <span class="p">,</span> <span class="n">cmd_action_id</span><span class="c1">       ; row 3</span>
               <span class="p">,</span> <span class="s">&quot;&quot;</span><span class="c1">                  ; row 4</span>
               <span class="p">,</span> <span class="s">&quot;&quot;</span><span class="c1">                  ; row 5</span>
               <span class="p">,</span> <span class="s">&quot;&quot;</span> <span class="ss">)</span><span class="c1">                ; row 6</span>
               
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="c1"> ;error; _____SUMMARY_END_____</span>
            <span class="n">error_msg</span> <span class="o">:=</span>  <span class="s">&quot;Error in Initialization of Main.LV.Cmds </span><span class="se">`n</span><span class="s"> &quot;</span>
            <span class="n">error_msg</span>  <span class="o">.=</span> <span class="s">&quot;cmd_action_id [&quot;</span> <span class="n">cmd_action_id</span> <span class="s">&quot;] </span><span class="se">`n</span><span class="s"> &quot;</span>
            <span class="n">error_msg</span>  <span class="o">.=</span> <span class="s">&quot;action_type   [&quot;</span>  <span class="n">action_type</span>  <span class="s">&quot;] </span><span class="se">`n</span><span class="s"> &quot;</span>
            <span class="n">error_msg</span>  <span class="o">.=</span> <span class="s">&quot;action_path   [&quot;</span>  <span class="n">action_path</span>  <span class="s">&quot;] </span><span class="se">`n</span><span class="s"> &quot;</span>
            <span class="kr">MSGBOX</span><span class="p">,</span> <span class="p">,</span> <span class="n">Error</span><span class="p">,</span> <span class="vi">%error_msg%</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">&quot;Sort&quot;</span><span class="ss">)</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_ReadjustAllCols</span><span class="ss">()</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_ReadjustAllCols</span><span class="ss">()</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">   </span>
<span class="c1">   ;-----------------------------------------------</span>
<span class="c1">   ; &lt;Enter&gt; key pressed.</span>
<span class="c1">   ;-----------------------------------------------</span>
<span class="c1">   ; Crude workaround recommended by the AHK Docs.</span>
<span class="c1">   ;</span>
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ButtonHiddenDefault</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>

<span class="c1">      ;------------------------------------------</span>
<span class="c1">      ; Refreshes the variable GuiConfigMain_Tabs</span>
<span class="c1">      ; which stores the current tab name</span>
<span class="c1">      ;------------------------------------------</span>

      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Submit</span><span class="p">,</span> <span class="n">NoHide</span> 

<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">GuiConfigMain_Tabs</span> <span class="o">==</span> <span class="s">&quot;Commands&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>

<span class="c1">         ;-----------------------------------------------------</span>
<span class="c1">         ; Edit the currently selected Command (if selection)</span>
<span class="c1">         ;-----------------------------------------------------</span>
<span class="c1">         </span>
<span class="c1">         ; GuiConfigMain.Create_Popup_Command()</span>
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Create_Popup</span><span class="ss">(</span><span class="s">&quot;command&quot;</span><span class="ss">)</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">GuiConfigMain_Tabs</span> <span class="o">==</span> <span class="s">&quot;Actions&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>

<span class="c1">         ;-----------------------------------------------------</span>
<span class="c1">         ; Edit the currently selected Action (if selection)</span>
<span class="c1">         ;-----------------------------------------------------</span>
<span class="c1">      </span>
<span class="c1">         ; GuiConfigMain.Create_Popup_Action()</span>
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Create_Popup</span><span class="ss">(</span><span class="s">&quot;action&quot;</span><span class="ss">)</span>
      <span class="p">}</span></DETAILS>
   <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnSize</span><span class="ss">(</span> <span class="n">FLAG</span><span class="o">:=</span><span class="s">&quot;&quot;</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;=====================================================</span>
<span class="c1">      ;         Upon resizing the GUI window, </span>
<span class="c1">      ;        </span>
<span class="c1">      ;         readjust Control :</span>
<span class="c1">      ;           - placement </span>
<span class="c1">      ;           - width  (where applicable) </span>
<span class="c1">      ;           - height (where applicable) </span>
<span class="c1">      ;        </span>
<span class="c1">      ;         to maintain a consistent layout.</span>
<span class="c1">      ;=====================================================</span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------------------------</span>
<span class="c1">      ; Static variables in a function </span>
<span class="c1">      ; will retain their value between function calls.</span>
<span class="c1">      ;-------------------------------------------------</span>
      
      <span class="nb">static</span> <span class="n">is_MainGui_baked</span> <span class="o">:=</span> <span class="nv">false</span> 
      <span class="nb">static</span> <span class="n">GuiHeight</span> 
      <span class="nb">static</span> <span class="n">GuiWidth</span>
      
      <span class="nb">static</span> <span class="n">offset_y_from_tabcontainer</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
      <span class="nb">static</span> <span class="n">ar_offset_from_bottom</span> <span class="o">:=</span> <span class="p">[]</span>
      <span class="nb">static</span> <span class="n">ar_offset_from_right</span>  <span class="o">:=</span> <span class="p">[]</span>
      <span class="nb">static</span> <span class="n">ar_reposition_ctrls</span> <span class="o">:=</span> <span class="p">[</span> <span class="s">&quot;&quot;</span>
            <span class="o">.</span>     <span class="s">&quot;GuiConfigMain_CheckboxShowAll&quot;</span>
               <span class="p">,</span> <span class="s">&quot;GuiConfigMain_ButtonNewCmd&quot;</span> 
               <span class="p">,</span> <span class="s">&quot;GuiConfigMain_ButtonEditCmd&quot;</span> 
               <span class="p">,</span> <span class="s">&quot;GuiConfigMain_ButtonDeleteCmd&quot;</span> 
               <span class="p">,</span> <span class="s">&quot;GuiConfigMain_ButtonNewAction&quot;</span> 
               <span class="p">,</span> <span class="s">&quot;GuiConfigMain_ButtonEditAction&quot;</span> 
               <span class="p">,</span> <span class="s">&quot;GuiConfigMain_ButtonDeleteAction&quot;</span> <span class="p">]</span>      
      <span class="nb">static</span> <span class="n">ar_resize_ctrls</span> <span class="o">:=</span> <span class="p">[</span> <span class="s">&quot;&quot;</span>
            <span class="o">.</span>     <span class="s">&quot;GuiConfigMain_Tabs&quot;</span> 
               <span class="p">,</span> <span class="s">&quot;GuiConfigMain_ListViewCmds&quot;</span>
               <span class="p">,</span> <span class="s">&quot;GuiConfigMain_ListViewActions&quot;</span>
               <span class="p">,</span> <span class="s">&quot;GuiConfigMain_Settings_Info&quot;</span>
               <span class="p">,</span> <span class="s">&quot;GuiConfigMain_Settings_ABOUT&quot;</span> <span class="p">]</span>      
         
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">      </span>
<span class="cm">      GuiConfigMain_Tabs                              := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_ListViewCmds                      := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_ButtonNewCmd                      := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_ButtonEditCmd                     := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_ButtonDeleteCmd                   := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_CheckboxShowAll                   := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_ButtonNewAction                   := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_ButtonEditAction                  := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_ButtonDeleteAction                := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_Settings_ABOUT                    := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_Settings_ButtonExport             := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_Settings_ButtonImportAsDisabled   := &quot;&quot;  </span>
<span class="cm">      GuiConfigMain_Settings_ButtonImportAsEnabled    := &quot;&quot;</span>
<span class="cm">      GuiConfigMain_Settings_Info                     := &quot;&quot;</span>
<span class="cm">      </span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;---------------------------------------------------------------------</span>
<span class="c1">      ; NOTE:</span>
<span class="c1">      ;---------------------------------------------------------------------</span>
<span class="c1">      ;</span>
<span class="c1">      ; The Gui Event &quot;OnSize&quot; is called when a window is first rendered</span>
<span class="c1">      ; but A_GuiHeight and A_GuiWidth aren&#39;t present </span>
<span class="c1">      ; when we call this function manually with </span>
<span class="c1">      ;    </span>
<span class="c1">      ;    GuiConfigMain.GUI_EVENT_OnSize(&quot;Some Flag&quot;)</span>
<span class="c1">      ; </span>
<span class="c1">      ; As soon as these are initialized, we&#39;ll store a copy </span>
<span class="c1">      ; in these function static vars.</span>
<span class="c1">      ; </span>
<span class="c1">      ; This will allow us to reference these dimensions </span>
<span class="c1">      ; when we call this &quot;OnSize&quot; event function manually</span>
<span class="c1">      ;---------------------------------------------------------------------</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="nv">A_GuiHeight</span> 
      <span class="ow">and</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="nv">A_GuiWidth</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">GuiHeight</span> <span class="o">:=</span> <span class="nv">A_GuiHeight</span>
         <span class="n">GuiWidth</span> <span class="o">:=</span> <span class="nv">A_GuiWidth</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">     ;******************************************************************************</span>
<span class="c1">     ;</span>
<span class="c1">     ;                     Manual Function Calls with Flags</span>
<span class="c1">     ;</span>
<span class="c1">     ;******************************************************************************</span>
<span class="c1">      </span>
<span class="c1">      ;==========================================</span>
<span class="c1">      ; Initialize static vars &amp; control offsets</span>
<span class="c1">      ;==========================================</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;Gui up and running&quot;</span> <span class="o">==</span> <span class="n">FLAG</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">is_MainGui_baked</span>  <span class="o">:=</span> <span class="nv">true</span><span class="c1"> </span>
<span class="c1">         </span>
<span class="c1">         ;----------------------------------------------</span>
<span class="c1">         ; Controls in Tab Containers </span>
<span class="c1">         ; have a hidden additional offset </span>
<span class="c1">         ;</span>
<span class="c1">         ; Hacky offset found through trial-and-error </span>
<span class="c1">         ;</span>
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_ListViewCmds&quot;</span>
         <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">TabContainer</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="vi">%c%</span>
         <span class="n">offset_y_from_tabcontainer</span> <span class="o">:=</span> <span class="n">TabContainerY</span> <span class="o">-</span> <span class="mi">6</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;-----------------------------------------------------------------</span>
<span class="c1">         ; For each Control where we only need to adjust its y-coordinate</span>
<span class="c1">         ;-----------------------------------------------------------------</span>
<span class="c1">         ; (1) Find how far away from the bottom it is initially.</span>
<span class="c1">         ; (2) Upon window resize, </span>
<span class="c1">         ;     reposition the y-coordinate to maintain this offset consistently.</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ar_reposition_ctrls</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">ctrl_</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="vi">%c%</span>
            
            <span class="n">offset_from_bottom</span> <span class="o">:=</span> <span class="n">GuiHeight</span> <span class="o">-</span> <span class="ss">(</span><span class="n">ctrl_y</span>  <span class="o">-</span> <span class="n">offset_y_from_tabcontainer</span><span class="ss">)</span>
            <span class="n">ar_offset_from_bottom</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">:=</span> <span class="n">offset_from_bottom</span>               
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;-----------------------------------------------------------------</span>
<span class="c1">         ; For each Control where we only need to stretch the height</span>
<span class="c1">         ;-----------------------------------------------------------------</span>
<span class="c1">         ; (1) Find the amount of space between the bottom of the control </span>
<span class="c1">         ;     and the bottom of the window (all these Controls are </span>
<span class="c1">         ;     positioned at the top of the window, so keep that in mind</span>
<span class="c1">         ;     if altering or reusing this code).</span>
<span class="c1">         ; (2) Upon window resize, stretch Control&#39;s height </span>
<span class="c1">         ;     to maintain this bottom offset consistently.</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ar_resize_ctrls</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">ctrl_</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="vi">%c%</span>
         
            <span class="n">offset_from_bottom</span> <span class="o">:=</span> <span class="n">GuiHeight</span> <span class="o">-</span> <span class="n">ctrl_h</span>
            <span class="n">ar_offset_from_bottom</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">:=</span> <span class="n">offset_from_bottom</span>      
         <span class="p">}</span></DETAILS>
         
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_ButtonRunAction&quot;</span>
         <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">ctrl_</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="vi">%c%</span>
         <span class="n">ar_offset_from_right</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">:=</span> <span class="n">GuiWidth</span> <span class="o">-</span> <span class="n">ctrl_x</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;----------------------------------------------------</span>
<span class="c1">         ; When called manually, </span>
<span class="c1">         ; A_GuiHeight and A_GuiWidth </span>
<span class="c1">         ; will not be populated by AutoHotkey Event handling</span>
<span class="c1">         ;</span>
         <span class="k">return</span> 

      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;RESET&quot;</span> <span class="o">==</span> <span class="n">FLAG</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">is_MainGui_baked</span>  <span class="o">:=</span> <span class="nv">false</span>
         <span class="n">GuiHeight</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">GuiWidth</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="k">return</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">     ;******************************************************************************</span>
<span class="c1">     ;</span>
<span class="c1">     ;                    AutoHotkey Event calls to OnSize()</span>
<span class="c1">     ;</span>
<span class="c1">     ;******************************************************************************</span>

<span class="c1">      ;==========================================</span>
<span class="c1">      ; Adjust size and positioning of Controls</span>
<span class="c1">      ; when Gui Window is resized.</span>
<span class="c1">      ;==========================================</span>
         
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">true</span> <span class="o">==</span> <span class="n">is_MainGui_baked</span><span class="ss">)</span><span class="c1"> ; ensures this is only called after our static vars are initialized</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;---------------------------------</span>
<span class="c1">         ; Adjust y-position of </span>
<span class="c1">         ;</span>
<span class="c1">         ; GuiConfigMain_CheckboxShowAll</span>
<span class="c1">         ; GuiConfigMain_ButtonNewCmd </span>
<span class="c1">         ; GuiConfigMain_ButtonNewAction</span>
<span class="c1">         ;---------------------------------</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ar_reposition_ctrls</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">offset</span> <span class="o">:=</span>  <span class="n">ar_offset_from_bottom</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
            <span class="n">destination_y</span> <span class="o">:=</span> <span class="nv">A_GuiHeight</span> <span class="o">-</span> <span class="n">offset</span><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ; GuiControl, ConfigMain: MoveDraw, %c%, % &quot;y&quot; destination_y</span>
            <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Move</span><span class="p">,</span>     <span class="vi">%c%</span><span class="p">,</span> <span class="o">%</span> <span class="s">&quot;y&quot;</span> <span class="n">destination_y</span>               
         <span class="p">}</span></DETAILS>
         
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_ButtonRunAction&quot;</span>
         <span class="n">offset</span> <span class="o">:=</span>  <span class="n">ar_offset_from_right</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
         <span class="n">destination_x</span> <span class="o">:=</span> <span class="nv">A_GuiWidth</span> <span class="o">-</span> <span class="n">offset</span>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Move</span><span class="p">,</span>     <span class="vi">%c%</span><span class="p">,</span> <span class="o">%</span> <span class="s">&quot;x&quot;</span> <span class="n">destination_x</span><span class="c1">      </span>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">         ;---------------------------------</span>
<span class="c1">         ; Adjust Size of </span>
<span class="c1">         ;</span>
<span class="c1">         ; Tab box </span>
<span class="c1">         ; ListView: Commands </span>
<span class="c1">         ; ListView: Actions</span>
<span class="c1">         ;---------------------------------</span>
         
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_ListViewCmds&quot;</span>
         <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">ctrl_LV_</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="vi">%c%</span>
         <span class="n">offset_LV</span> <span class="o">:=</span>  <span class="n">ar_offset_from_bottom</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
         
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_Tabs&quot;</span>
         <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">ctrl_tab_</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="vi">%c%</span>
         <span class="n">offset_tab</span> <span class="o">:=</span>  <span class="n">ar_offset_from_bottom</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
         
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_Settings_Info&quot;</span>
         <span class="n">offset_info</span> <span class="o">:=</span>  <span class="n">ar_offset_from_bottom</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
         
         <span class="n">options_LV</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">options_tab</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         
            <span class="n">options_tab</span> <span class="o">.=</span> <span class="s">&quot; h&quot;</span> <span class="nv">A_GuiHeight</span> <span class="o">-</span> <span class="n">offset_tab</span>            
            <span class="n">options_LV</span>  <span class="o">.=</span> <span class="s">&quot; h&quot;</span> <span class="nv">A_GuiHeight</span> <span class="o">-</span> <span class="n">offset_LV</span>
            <span class="n">options_info</span> <span class="o">.=</span> <span class="s">&quot; h&quot;</span> <span class="nv">A_GuiHeight</span> <span class="o">-</span> <span class="n">offset_info</span>
            
            <span class="n">options_LV</span>  <span class="o">.=</span> <span class="s">&quot; w&quot;</span> <span class="nv">A_GuiWidth</span> <span class="o">-</span> <span class="ss">(</span><span class="n">ctrl_LV_X</span> <span class="o">*</span> <span class="mi">2</span><span class="ss">)</span>            
            <span class="n">options_tab</span> <span class="o">.=</span> <span class="s">&quot; w&quot;</span> <span class="nv">A_GuiWidth</span> <span class="o">-</span> <span class="ss">(</span><span class="n">ctrl_tab_X</span> <span class="o">*</span> <span class="mi">2</span><span class="ss">)</span>
            
            <span class="n">options_info</span>  <span class="o">.=</span> <span class="s">&quot; w&quot;</span> <span class="nv">A_GuiWidth</span> <span class="o">-</span> <span class="ss">(</span><span class="n">ctrl_LV_X</span> <span class="o">*</span> <span class="mi">2</span><span class="ss">)</span>
            <span class="n">options_about</span> <span class="o">.=</span> <span class="s">&quot; w&quot;</span> <span class="nv">A_GuiWidth</span> <span class="o">-</span> <span class="ss">(</span><span class="n">ctrl_LV_X</span> <span class="o">*</span> <span class="mi">2</span><span class="ss">)</span>
            
         
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_ListViewCmds&quot;</span><span class="c1"></span>
<span class="c1">         ; GuiControl, ConfigMain: MoveDraw,     %c%, %options_LV%</span>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Move</span><span class="p">,</span>     <span class="vi">%c%</span><span class="p">,</span> <span class="vi">%options_LV%</span>
         
         
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_ListViewActions&quot;</span><span class="c1"></span>
<span class="c1">         ; GuiControl, ConfigMain: MoveDraw,     %c%, %options_LV%</span>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Move</span><span class="p">,</span>     <span class="vi">%c%</span><span class="p">,</span> <span class="vi">%options_LV%</span>
      
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_Settings_Info&quot;</span><span class="c1"></span>
<span class="c1">         ; GuiControl, ConfigMain: MoveDraw,     %c%, %options_info%</span>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Move</span><span class="p">,</span>     <span class="vi">%c%</span><span class="p">,</span> <span class="vi">%options_info%</span>
         
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_Settings_ABOUT&quot;</span>
         <span class="n">about_text</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_AboutTab_Get_Text</span><span class="ss">(</span><span class="nv">A_GuiWidth</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">         ; GuiControl, ConfigMain: , %c%, &quot;&quot;</span>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="p">,</span> <span class="vi">%c%</span><span class="p">,</span> <span class="vi">%about_text%</span><span class="c1"></span>
<span class="c1">         ; msgbox %about_text%</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">A_GuiWidth</span> <span class="o">&lt;</span> <span class="mi">585</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            ; GuiControl, ConfigMain: MoveDraw,     %c%, %options_info%</span>
            <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Move</span><span class="p">,</span>     <span class="vi">%c%</span><span class="p">,</span> <span class="vi">%options_about%</span>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Move</span><span class="p">,</span>     <span class="vi">%c%</span><span class="p">,</span> <span class="n">w527</span>
         <span class="p">}</span></DETAILS>
         
         
         
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigMain_Tabs&quot;</span>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">MoveDraw</span><span class="p">,</span>     <span class="vi">%c%</span><span class="p">,</span> <span class="vi">%options_tab%</span><span class="c1"></span>
<span class="c1">         ; GuiControl, ConfigMain: Move,     %c%, %options_tab%</span>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">         ;---------------------------------------------------------------------------------</span>
<span class="c1">         ; Calling these readjust functions here </span>
<span class="c1">         ; will prevent a horizontal scroll bar from appearing when unnecessary.</span>
<span class="c1">         ;</span>
<span class="c1">         ; However, adding these lines causes the ListView headers for the columns </span>
<span class="c1">         ; to frequently fail to repaint (due to rapid MoveDraw calls).</span>
<span class="c1">         ;</span>
<span class="c1">         ;      GuiConfigMain.ListViewActions_ReadjustAllCols()</span>
<span class="c1">         ;      GuiConfigMain.ListViewCommands_ReadjustAllCols()</span>
<span class="c1">         ;---------------------------------------------------------------------------------</span>
         
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnEscape</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnClose</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
         <span class="vc">_o_Gui_Config_Main</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnDropFiles</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      ;---------------------------------------------------------------------</span>
<span class="c1">      ; AutoHotkey Docs for GuiDropFiles</span>
<span class="c1">      ;---------------------------------------------------------------------</span>
<span class="c1">      ; A_EventInfo and ErrorLevel:</span>
<span class="c1">      ;   Both contain the number of files dropped.</span>
<span class="c1">      ;---------------------------------------------------------------------</span>
<span class="c1">      ; A_GuiEvent:</span>
<span class="c1">      ;   Contains the names of the files that were dropped, </span>
<span class="c1">      ;   with each filename except the last terminated by a linefeed (`n).</span>
<span class="c1">      ;---------------------------------------------------------------------</span>
<span class="c1">      ; https://www.autohotkey.com/docs/commands/Gui.htm#GuiDropFiles</span>
<span class="c1">      ;---------------------------------------------------------------------</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Submit</span><span class="p">,</span> <span class="n">NoHide</span> 
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">GuiConfigMain_Tabs</span> <span class="o">==</span> <span class="s">&quot;Actions&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;--------------------------------------------</span>
<span class="c1">         ; Populate GUI data with drag-n-dropped file.</span>
<span class="c1">         ;--------------------------------------------</span>
<span class="c1">         ; User dropped 1 file onto GuiConfigPopup GUI </span>
<span class="c1">         ;--------------------------------------------</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">A_EventInfo</span> <span class="o">==</span> <span class="mi">1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
            <span class="n">is_dragNdrop_valid</span> <span class="o">:=</span> <span class="kr">FileExist</span><span class="ss">(</span><span class="nv">A_GuiEvent</span><span class="ss">)</span>
      
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span>  <span class="n">is_dragNdrop_valid</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_o_Gui_Config_Popup</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="vc">_o_Gui_Config_Popup</span> <span class="o">:=</span> <span class="n">new</span> <span class="nf">GuiConfigPopup</span><span class="ss">(</span><span class="s">&quot;action&quot;</span>
                                                <span class="p">,</span> <span class="s">&quot;add&quot;</span>
                                                <span class="p">,</span> <span class="n">NA_lv_row</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
                                                <span class="p">,</span> <span class="n">silent</span><span class="o">:=</span><span class="nv">true</span><span class="ss">)</span>
                  
<DETAILS open class="control_flow_block leading_tabs_6"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">InStr</span><span class="ss">(</span><span class="n">is_dragNdrop_valid</span><span class="p">,</span> <span class="s">&quot;D&quot;</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                     ; populate as dir </span>
                     
                     <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_RadioFolder</span><span class="p">,</span> <span class="mi">1</span>
                     <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_RadioApp</span>   <span class="p">,</span> <span class="mi">0</span>
                     
                     <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_InputPath</span><span class="p">,</span> <span class="vi">%A_GuiEvent%</span>
                  <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_6"><SUMMARY><span class="k">else</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                     ; populate as file </span>
                     
                     <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_RadioFolder</span><span class="p">,</span> <span class="mi">0</span>
                     <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_RadioApp</span>   <span class="p">,</span> <span class="mi">1</span>
                     
                     <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_InputPath</span><span class="p">,</span> <span class="vi">%A_GuiEvent%</span>
                  <span class="p">}</span></DETAILS>
                  <span class="vc">_o_Gui_Config_Popup</span><span class="o">.</span><span class="nf">Submit_Changes</span><span class="ss">()</span>
                  <span class="vc">_o_Gui_Config_Popup</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
               <span class="p">}</span></DETAILS>
            <span class="p">}</span></DETAILS>
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         ;----------------------------------------------------</span>
<span class="c1">         ; Unsupported.</span>
<span class="c1">         ;----------------------------------------------------</span>
<span class="c1">         ; User dropped more than 1 file onto GuiConfigPopup GUI </span>
<span class="c1">         ;----------------------------------------------------</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="nv">A_EventInfo</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">str_for_usr_output</span> <span class="o">:=</span> <span class="s">&quot;_program_launcher.ahk</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;--------------</span><span class="se">`n</span><span class="s">Oops</span><span class="se">`n</span><span class="s">--------------</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">&quot;&quot;</span><span class="s">Edit a Command</span><span class="se">&quot;&quot;</span><span class="s"> can&#39;t process more than one file.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Ensure you only have one file selected </span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;in Windows Explorer.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Then try to drag-and-drop it onto this window again.</span><span class="se">`n</span><span class="s">&quot;</span>
            
            <span class="kr">MsgBox</span><span class="p">,,</span> <span class="o">%</span> <span class="s">&quot;[X] Can&#39;t process more than one file for a path.&quot;</span><span class="p">,</span> <span class="vi">%str_for_usr_output%</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>


<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_Tabs</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------</span>
<span class="c1">      ; Refreshes the variable GuiConfigMain_Tabs</span>
<span class="c1">      ; which stores the current tab name</span>
<span class="c1">      ;------------------------------------------</span>

      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Submit</span><span class="p">,</span> <span class="n">NoHide</span> 
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">GuiConfigMain_Tabs</span> <span class="o">==</span> <span class="s">&quot;Actions&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="o">-</span><span class="n">Hidden</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonRunAction</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="o">+</span><span class="n">Hidden</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonRunAction</span>
      <span class="p">}</span></DETAILS>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ListViewActions</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------</span>
<span class="c1">      ; If events are being triggered</span>
<span class="c1">      ; while the popup is altering or inserting new entries</span>
<span class="c1">      ; ignore event.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="vc">_o_Gui_Config_Popup</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="k">return</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; msgbox A_EventInfo %A_EventInfo%</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span> <span class="ss">(</span><span class="nv">A_GuiEvent</span> <span class="o">=</span> <span class="s">&quot;DoubleClick&quot;</span><span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; GuiConfigMain.Create_Popup_Action()</span>
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Create_Popup</span><span class="ss">(</span><span class="s">&quot;action&quot;</span><span class="ss">)</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">      ;--------------------------------------</span>
<span class="c1">      ; user has edited first field of a row </span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span> <span class="ss">(</span><span class="nv">A_GuiEvent</span> <span class="o">=</span> <span class="s">&quot;e&quot;</span><span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_ReadjustAllCols</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------</span>
<span class="c1">      ; An Item Changed</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span> <span class="ss">(</span> <span class="s">&quot;I&quot;</span> <span class="o">=</span> <span class="nv">A_GuiEvent</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;===================================================</span>
<span class="c1">         ; ENABLE / DISABLE state changed for a Command</span>
<span class="c1">         ;===================================================</span>
<span class="c1">         </span>
<span class="c1">         ;-------------------------------------------</span>
<span class="c1">         ; Event was either Select (S) or Deselect (s)</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">InStr</span><span class="ss">(</span><span class="nv">ErrorLevel</span><span class="p">,</span> <span class="s">&quot;S&quot;</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ; Tells future ListView operations to operate on this specific ListView control</span>
            <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">            ;-------------------------------------------</span>
<span class="c1">            ; Get Action ID for that row in the ListView </span>
<span class="c1">            ;</span>
            <span class="n">sel_act_id</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
            <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">sel_act_id</span><span class="p">,</span> <span class="nv">A_EventInfo</span><span class="p">,</span> <span class="mi">1</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ;---------------------------------------------------</span>
<span class="c1">            ; If a row is selected, </span>
<span class="c1">            ; ErrorLevel will contain a &quot;S&quot; in its string.</span>
<span class="c1">            ;</span>
<span class="c1">            ; If a row is deselected, </span>
<span class="c1">            ; ErrorLevel will contain a &quot;s&quot; in its string.</span>
<span class="c1">            ;---------------------------------------------------</span>
            
            <span class="n">was_item_selected</span>   <span class="o">:=</span> <span class="kr">InStr</span><span class="ss">(</span><span class="nv">ErrorLevel</span><span class="p">,</span> <span class="s">&quot;S&quot;</span><span class="p">,</span> <span class="n">CaseSensitive</span><span class="o">:=</span><span class="nv">true</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">            ;~ was_item_deselected := InStr(ErrorLevel, &quot;s&quot;, CaseSensitive:=true)</span>
<span class="c1">            </span>
<span class="c1">            </span>
<span class="c1">            ;=====================================================================</span>
<span class="c1">            ;                             WARNING</span>
<span class="c1">            ;=====================================================================</span>
<span class="c1">            ;</span>
<span class="c1">            ;    Additionally using else if(was_item_deselected)... branches:</span>
<span class="c1">            ;  </span>
<span class="c1">            ;       will sometimes (randomly) incorrectly break </span>
<span class="c1">            ;       the &quot;Edit Action&quot; / &quot;Delete Action&quot; buttons </span>
<span class="c1">            ;       when the user has selected a valid, editable Action entry. </span>
<span class="c1">            ;  </span>
<span class="c1">            ;    This is due to rapid calling of ListView </span>
<span class="c1">            ;    event functions, and the lag in response time</span>
<span class="c1">            ;    will sometimes result in the program glitching into a </span>
<span class="c1">            ;    state desynchronized with the logic here.</span>
<span class="c1">            ;  </span>
<span class="c1">            ;    The following if logic was therefore carefully chosen:</span>
<span class="c1">            ;    </span>
<span class="c1">            ;    (A)  It always enables the buttons when a valid entry is selected</span>
<span class="c1">            ;         (without the same event triggering any other code branches)</span>
<span class="c1">            ;  </span>
<span class="c1">            ;    (B)  It only calls disable when either:</span>
<span class="c1">            ;         - all entries are deselected or</span>
<span class="c1">            ;         - an entry for QUIT or SETTINGS is selected</span>
<span class="c1">            ;         (without the same event triggering any other code branches)</span>
<span class="c1">            ;  </span>
<span class="c1">            ;  </span>
<span class="c1">            ;  As great as AutoHotkey is for simple User Interfaces, </span>
<span class="c1">            ;  this is perhaps its biggest shortcoming.</span>
<span class="c1">            ;</span>
<span class="c1">            ;  When you&#39;ve debugged your code, but you&#39;re still </span>
<span class="c1">            ;  encountering unexpected behavior, look to your Event functions.</span>
<span class="c1">            ;=====================================================================</span>
<span class="c1">            </span>
<span class="c1">            </span>
<span class="c1">            ;--------------------------------------------------------------</span>
<span class="c1">            ; If QUIT or SETTINGS selected, disable edit + delete buttons.</span>
<span class="c1">            ; If anything else selected, enable edit + delete buttons.</span>
<span class="c1">            ;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">was_item_selected</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;QUIT&quot;</span>     <span class="o">!=</span> <span class="n">sel_act_id</span> 
               <span class="ow">and</span> <span class="s">&quot;SETTINGS&quot;</span> <span class="o">!=</span> <span class="n">sel_act_id</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_Action_Buttons_Enable</span><span class="ss">()</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">allow_run</span> <span class="o">:=</span> <span class="nv">false</span> 
<DETAILS open class="control_flow_block leading_tabs_6"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;QUIT&quot;</span> <span class="o">==</span> <span class="n">sel_act_id</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                     <span class="n">allow_run</span> <span class="o">:=</span> <span class="nv">true</span>
                  <span class="p">}</span></DETAILS>
                  <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_Action_Buttons_Disable</span><span class="ss">(</span> <span class="n">allow_run</span> <span class="ss">)</span>
               <span class="p">}</span></DETAILS>
            <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ;---------------------------------</span>
<span class="c1">            ; If nothing is selected</span>
<span class="c1">            ; disable edit + delete buttons.</span>
<span class="c1">            ;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">0</span> <span class="o">==</span> <span class="kr">LV_GetNext</span><span class="ss">(</span><span class="mi">0</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_Action_Buttons_Disable</span><span class="ss">()</span>               
            <span class="p">}</span></DETAILS>
            
            
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ListViewCommands</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------</span>
<span class="c1">      ; If events are being triggered</span>
<span class="c1">      ; while the popup is altering or inserting new entries</span>
<span class="c1">      ; ignore event.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="vc">_o_Gui_Config_Popup</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="k">return</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------</span>
<span class="c1">      ; If Gui not initialized yet, </span>
<span class="c1">      ; don&#39;t respond to checkmark events.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="nv">false</span> <span class="o">==</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_is_gui_baked</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="k">return</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------</span>
<span class="c1">      ; User Double-Clicked </span>
<span class="c1">      ; either a row or a blank space.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span> <span class="ss">(</span> <span class="s">&quot;DoubleClick&quot;</span> <span class="o">=</span> <span class="nv">A_GuiEvent</span> <span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Create_Popup</span><span class="ss">(</span><span class="s">&quot;command&quot;</span><span class="ss">)</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">      ;--------------------------------------</span>
<span class="c1">      ; user has edited first field of a row </span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span> <span class="ss">(</span> <span class="s">&quot;e&quot;</span> <span class="o">=</span> <span class="nv">A_GuiEvent</span> <span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_ReadjustAllCols</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">      ;--------------------------</span>
<span class="c1">      ; An Item Changed</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span> <span class="ss">(</span> <span class="s">&quot;I&quot;</span> <span class="o">=</span> <span class="nv">A_GuiEvent</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;===================================================</span>
<span class="c1">         ; ENABLE / DISABLE state changed for a Command</span>
<span class="c1">         ;===================================================</span>
<span class="c1">         </span>
<span class="c1">         ;-------------------------------------------</span>
<span class="c1">         ; Event was either Checkmark (C) or Uncheckmark (c)</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">InStr</span><span class="ss">(</span><span class="nv">ErrorLevel</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span>            <span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ; Tells future ListView operations to operate on this specific ListView control</span>
            <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">            ;-------------------------------------------</span>
<span class="c1">            ; Get command for that row in the ListView </span>
<span class="c1">            ;</span>
            <span class="n">cmd</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
            <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">cmd</span><span class="p">,</span> <span class="nv">A_EventInfo</span><span class="p">,</span><span class="mi">1</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ;---------------------------------------------------</span>
<span class="c1">            ; If a row is selected, </span>
<span class="c1">            ; ErrorLevel will contain a &quot;S&quot; in its string.</span>
<span class="c1">            ;</span>
<span class="c1">            ; If a row is deselected, </span>
<span class="c1">            ; ErrorLevel will contain a &quot;s&quot; in its string.</span>
<span class="c1">            ;---------------------------------------------------</span>
            
            <span class="n">was_item_checked</span> <span class="o">:=</span> <span class="kr">InStr</span><span class="ss">(</span><span class="nv">ErrorLevel</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="p">,</span> <span class="n">CaseSensitive</span><span class="o">:=</span><span class="nv">true</span><span class="ss">)</span>
            <span class="n">was_item_unchecked</span> <span class="o">:=</span> <span class="kr">InStr</span><span class="ss">(</span><span class="nv">ErrorLevel</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="n">CaseSensitive</span><span class="o">:=</span><span class="nv">true</span><span class="ss">)</span>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">was_item_checked</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_EnableCommand</span><span class="ss">(</span> <span class="n">cmd</span> <span class="ss">)</span>
            <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">was_item_unchecked</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_DisableCommand</span><span class="ss">(</span> <span class="n">cmd</span> <span class="ss">)</span>
            <span class="p">}</span></DETAILS>
            
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>


<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ButtonRunAction</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> <span class="n">run_action_id</span>
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_Activate</span><span class="ss">()</span>
      
      <span class="n">which_row</span> <span class="o">:=</span> <span class="kr">LV_GetNext</span><span class="ss">(</span><span class="mi">0</span><span class="ss">)</span>      
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">0</span> <span class="o">!=</span> <span class="n">which_row</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">action_id_is</span><span class="p">,</span> <span class="n">which_row</span><span class="p">,</span> <span class="mi">1</span><span class="ss">)</span>
         <span class="n">run_action_id</span> <span class="o">:=</span> <span class="n">action_id_is</span> 
         <span class="k">gosub</span> <span class="n">RunActionID</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ButtonNewAction</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>

<span class="c1">      ; GuiConfigMain.Create_Popup_Action_Add()</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Create_Popup</span><span class="ss">(</span><span class="s">&quot;action&quot;</span><span class="p">,</span> <span class="s">&quot;add&quot;</span><span class="ss">)</span>

      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ButtonEditAction</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Create_Popup</span><span class="ss">(</span><span class="s">&quot;action&quot;</span><span class="p">,</span> <span class="s">&quot;edit&quot;</span><span class="ss">)</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ButtonDeleteAction</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;===============================================</span>
<span class="c1">      ; Get the row# of the selected ListView item.</span>
<span class="c1">      ;===============================================</span>
      
      <span class="n">which_row</span> <span class="o">:=</span> <span class="kr">LV_GetNext</span><span class="ss">(</span><span class="mi">0</span><span class="ss">)</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">0</span> <span class="o">==</span> <span class="n">which_row</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; User pressed Delete Action button with no selection.</span>
         <span class="k">return</span>
      <span class="p">}</span></DETAILS>
      
      <span class="n">action_id</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">action_id</span><span class="p">,</span> <span class="n">which_row</span><span class="p">,</span> <span class="mi">1</span><span class="ss">)</span>
      
      
      <span class="n">aID</span>   <span class="o">:=</span> <span class="n">action_id</span>
      <span class="n">aType</span> <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">aID</span><span class="p">][</span><span class="s">&quot;type&quot;</span><span class="p">]</span>
      <span class="n">aPath</span> <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">aID</span><span class="p">][</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
      <span class="n">aArg</span>  <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">aID</span><span class="p">][</span><span class="s">&quot;arg&quot;</span><span class="p">]</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;~ ar_cmds_which_use_this_action     := []</span>
      <span class="n">string_cmds_which_use_this_action</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">for</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">cmd_dat</span> <span class="ow">in</span> <span class="vc">_COMMANDS</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">aID</span> <span class="o">==</span> <span class="n">cmd_dat</span><span class="p">[</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            ; msgbox command has aid [%aID%]</span>
<span class="c1">            ;~ ar_cmds_which_use_this_action.Push(cmd)</span>
            <span class="n">string_cmds_which_use_this_action</span> <span class="o">.=</span> <span class="n">cmd</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS>
      
      
      <span class="n">msgbox_type_ok_cancel</span> <span class="o">:=</span> <span class="mi">1</span>
      <span class="n">msgbox_icon_question</span>  <span class="o">:=</span> <span class="mi">32</span>
      <span class="n">msgbox_default_button</span> <span class="o">:=</span> <span class="mi">256</span>
      
      <span class="n">msgbox_options</span> <span class="o">:=</span> <span class="n">msgbox_type_ok_cancel</span>
                  <span class="o">+</span> <span class="n">msgbox_icon_question</span>
                  <span class="o">+</span> <span class="n">msgbox_default_button</span>
      
      
      
      <span class="n">msgbox_prompt</span> <span class="o">:=</span>  <span class="s">&quot;&quot;</span>
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;Delete Action[&quot;</span> <span class="n">aID</span> <span class="s">&quot;] ?</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;    Type:</span><span class="se">`t</span><span class="s">&quot;</span> <span class="n">aType</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;    Path:</span><span class="se">`t</span><span class="s">&quot;</span> <span class="n">aPath</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="ss">(</span><span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="n">aArg</span><span class="ss">)</span> 
                     <span class="o">?</span> <span class="s">&quot;    Arg:</span><span class="se">`t</span><span class="s">&quot;</span> <span class="n">aArg</span> 
                     <span class="o">:</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
      
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;(This Action and any Commands which use it</span><span class="se">`n</span><span class="s">&quot;</span>
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;  will all be erased from your savefile.)</span><span class="se">`n`n</span><span class="s">&quot;</span><span class="c1"></span>
<span class="c1">                  </span>
<span class="c1">      ;~ if( ar_cmds_which_use_this_action.Count() &gt; 0 )</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">StrLen</span><span class="ss">(</span><span class="n">string_cmds_which_use_this_action</span><span class="ss">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;------------------------------------------------------</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;WARNING    </span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;The following Commands use Action[&quot;</span> <span class="n">aID</span> <span class="s">&quot;]</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;and will also be deleted: </span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;------------------------------------------------------</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="n">string_cmds_which_use_this_action</span>
         
      <span class="p">}</span></DETAILS>
                     
      
      <span class="n">msgbox_title</span> <span class="o">:=</span> <span class="s">&quot;DELETE&quot;</span>
      
      <span class="kr">MsgBox</span><span class="p">,</span> <span class="o">%</span> <span class="n">msgbox_options</span><span class="p">,</span> <span class="o">%</span> <span class="n">msgbox_title</span><span class="p">,</span> <span class="vi">%msgbox_prompt%</span>
      
      <span class="k">IfMsgBox</span><span class="p">,</span> <span class="n">Cancel</span>
         <span class="k">return</span> 
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">IfMsgBox</span><span class="p">,</span> <span class="n">OK</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; delete all cmds in string_cmds_which_use_this_action</span>
<span class="c1">         ; delete action</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">StrLen</span><span class="ss">(</span><span class="n">string_cmds_which_use_this_action</span><span class="ss">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="n">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">string_cmds_which_use_this_action</span><span class="p">,</span> <span class="se">`n`n</span>
            <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_DeleteCommand</span><span class="ss">(</span> <span class="nv">A_LoopField</span> <span class="ss">)</span>
            <span class="p">}</span></DETAILS>
         <span class="p">}</span></DETAILS>
         
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_DeleteAction</span><span class="ss">(</span> <span class="n">aID</span> <span class="ss">)</span>
      
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_Action_Buttons_Enable</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_Activate</span><span class="ss">()</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonEditAction</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonDeleteAction</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonRunAction</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_Action_Buttons_Disable</span><span class="ss">(</span> <span class="n">flag_allow_run</span><span class="o">:=</span><span class="nv">false</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_Activate</span><span class="ss">()</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Disable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonEditAction</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Disable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonDeleteAction</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="nv">false</span> <span class="o">==</span> <span class="n">flag_allow_run</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Disable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonRunAction</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonRunAction</span>         
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>


<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ButtonNewCmd</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>

<span class="c1">      ; GuiConfigMain.Create_Popup_Command_Add()</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Create_Popup</span><span class="ss">(</span><span class="s">&quot;command&quot;</span><span class="p">,</span> <span class="s">&quot;add&quot;</span><span class="ss">)</span>
      
   <span class="k">return</span> 
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ButtonEditCmd</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Create_Popup</span><span class="ss">(</span><span class="s">&quot;command&quot;</span><span class="p">,</span> <span class="s">&quot;edit&quot;</span><span class="ss">)</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">; [~] TODO: new option checkbox: Show confirmation warning before deleting an Action or Command.</span>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ButtonDeleteCmd</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;===============================================</span>
<span class="c1">      ; Get the row# of the selected ListView item.</span>
<span class="c1">      ;===============================================</span>
      
      <span class="n">which_row</span> <span class="o">:=</span> <span class="kr">LV_GetNext</span><span class="ss">(</span><span class="mi">0</span><span class="ss">)</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">0</span> <span class="o">==</span> <span class="n">which_row</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; User pressed Delete Command button with no selection.</span>
         <span class="k">return</span>
      <span class="p">}</span></DETAILS>
      
      <span class="n">cmd_txt</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">cmd_txt</span><span class="p">,</span> <span class="n">which_row</span><span class="p">,</span> <span class="mi">1</span><span class="ss">)</span>
      
      <span class="n">msgbox_type_ok_cancel</span> <span class="o">:=</span> <span class="mi">1</span>
      <span class="n">msgbox_icon_question</span>  <span class="o">:=</span> <span class="mi">32</span>
      <span class="n">msgbox_default_button</span> <span class="o">:=</span> <span class="mi">256</span>
      
      <span class="n">msgbox_options</span> <span class="o">:=</span> <span class="n">msgbox_type_ok_cancel</span>
                  <span class="o">+</span> <span class="n">msgbox_icon_question</span>
                  <span class="o">+</span> <span class="n">msgbox_default_button</span>
      
      <span class="n">msgbox_prompt</span> <span class="o">:=</span>  <span class="s">&quot;&quot;</span>
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;Delete the following Command?</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`t</span><span class="s">&quot;</span> <span class="n">cmd_txt</span> <span class="s">&quot;</span><span class="se">`n`n`n</span><span class="s">&quot;</span>
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;( This Command will be erased from your savefile,</span><span class="se">`n</span><span class="s">&quot;</span>
      <span class="n">msgbox_prompt</span>  <span class="o">.=</span> <span class="s">&quot;  but its Action will not be removed. )</span><span class="se">`n`n</span><span class="s">&quot;</span>
      
      <span class="n">msgbox_title</span> <span class="o">:=</span> <span class="s">&quot;DELETE&quot;</span>
      <span class="kr">MsgBox</span><span class="p">,</span> <span class="o">%</span> <span class="n">msgbox_options</span><span class="p">,</span> <span class="o">%</span> <span class="n">msgbox_title</span><span class="p">,</span> <span class="vi">%msgbox_prompt%</span>
      
      <span class="k">IfMsgBox</span><span class="p">,</span> <span class="n">Cancel</span>
         <span class="k">return</span> 
         
      <span class="k">IfMsgBox</span><span class="p">,</span> <span class="n">OK</span>
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_DeleteCommand</span><span class="ss">(</span> <span class="n">cmd_txt</span> <span class="ss">)</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_Command_Buttons_Enable</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonEditCommand</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonDeleteCommand</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_Command_Buttons_Disable</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Disable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonEditCommand</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Disable</span><span class="p">,</span> <span class="n">GuiConfigMain_ButtonDeleteCommand</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_CheckboxShowAll</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>

<span class="c1">      ;----------------------------------------------------</span>
<span class="c1">      ; Change label depending on state.</span>
<span class="c1">      ;----------------------------------------------------</span>
<span class="c1">      ;</span>
<span class="c1">      ; When Checkbox is on, </span>
<span class="c1">      ;</span>
<span class="c1">      ; - ListView will display: </span>
<span class="c1">      ;   all Commands</span>
<span class="c1">      ;</span>
<span class="c1">      ; - GuiConfigMain_CheckboxShowAll will display text:</span>
<span class="c1">      ;   SHOW ALL   (Uncheck to hide disabled commands)</span>
<span class="c1">      ;</span>
<span class="c1">      ; When Checkbox is off </span>
<span class="c1">      ;</span>
<span class="c1">      ; - ListView will display: </span>
<span class="c1">      ;   only enabled Commands</span>
<span class="c1">      ;</span>
<span class="c1">      ; - GuiConfigMain_CheckboxShowAll will display text:</span>
<span class="c1">      ;   SHOW ALL   (Check to also show disabled commands)</span>
<span class="c1">      ;</span>
<span class="c1">      ;----------------------------------------------------</span>
      
      <span class="kr">GuiControlGet</span><span class="p">,</span><span class="n">show_all_state</span><span class="p">,,</span> <span class="n">GuiConfigMain_CheckboxShowAll</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">show_all_state</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">txt</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="n">CheckboxShowAll_TextForChecked</span>
         
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_ShowAll</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">txt</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="n">CheckboxShowAll_TextForUnchecked</span>
         
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_ShowOnlyEnabled</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS>
      
      <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigMain_CheckboxShowAll</span><span class="p">,</span> <span class="vi">%txt%</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_Settings_ButtonIcon</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
   
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="vc">_o_Gui_Config_IconPicker</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="vc">_o_Gui_Config_IconPicker</span> <span class="o">:=</span> <span class="n">new</span> <span class="nf">GuiConfigIconPicker</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_Settings_ButtonExport</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_Settings_ButtonImportAsDisabled</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_Settings_ButtonImportAsEnabled</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
   


<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">ListViewActions_Activate</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">      ;</span>
<span class="c1">      ; Word of warning:</span>
<span class="c1">      ; In this current implementation, OnSize() </span>
<span class="c1">      ; will readjust the columns on a resize </span>
<span class="c1">      ; (to prevent horizontal scrollbar when not needed).</span>
<span class="c1">      ;</span>
<span class="c1">      ; Be sure to call ListViewActions_Activate() </span>
<span class="c1">      ;  or             ListViewCommands_Activate</span>
<span class="c1">      ; before any AutoHotkey ListView function.</span>
<span class="c1">      ;--------------------------------------------</span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------------------------------------------;</span>
<span class="c1">      ; This line ensures &quot;Gui, &quot; commands operate on the main GUI window  ;</span>
<span class="c1">      ;--------------------------------------------------------------------;</span>
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Default</span><span class="c1"></span>

<span class="c1">      ;---------------------------------------------------;</span>
<span class="c1">      ; This line ensures ListView commands &quot;LV_..()&quot;     ;</span>
<span class="c1">      ; operate on this specific ListView                 ;</span>
<span class="c1">      ;---------------------------------------------------;</span>
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">ListView</span><span class="p">,</span> <span class="n">GuiConfigMain_ListViewActions</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">ListViewActions_ReadjustAllCols</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      ; see notes above in GuiConfigMain.ListViewCommands_ReadjustAllCols()</span>
<span class="c1">      </span>
<span class="c1">      ; Tells future ListView operations to operate on this specific ListView control</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; Adjust all column widths to fit all contents without trailing &quot;...&quot;</span>
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">3</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>


<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">ListViewActions_AddNewAction</span><span class="ss">(</span> <span class="n">p_actionID</span><span class="p">,</span> <span class="n">p_actionType</span><span class="p">,</span> <span class="n">p_actionPath</span><span class="p">,</span> <span class="n">p_actionArg</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">      </span>
<span class="c1">      ; msgBOX id[%p_actionID%] type[%p_actionType%] path[%p_actionPath%] ar[%p_actionArg%]</span>
<span class="c1">      </span>
<span class="c1">      ; Tells future ListView operations to operate on this specific ListView control</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_Activate</span><span class="ss">()</span>
      
      <span class="n">options</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> </span>
<span class="c1">      </span>
<span class="c1">      ; msgBOX %success%</span>
      
      <span class="kr">LV_Add</span><span class="ss">(</span> <span class="n">options</span>
         <span class="p">,</span> <span class="n">p_actionID</span>
         <span class="p">,</span> <span class="n">p_actionType</span>
         <span class="p">,</span> <span class="n">p_actionPath</span>
         <span class="p">,</span> <span class="n">p_actionArg</span> <span class="ss">)</span>
      
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>


<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">      ;</span>
<span class="c1">      ; Word of warning:</span>
<span class="c1">      ; In this current implementation, OnSize() </span>
<span class="c1">      ; will readjust the columns on a resize </span>
<span class="c1">      ; (to prevent horizontal scrollbar when not needed).</span>
<span class="c1">      ;</span>
<span class="c1">      ; Be sure to call ListViewActions_Activate() </span>
<span class="c1">      ;  or             ListViewCommands_Activate</span>
<span class="c1">      ; before any AutoHotkey ListView function.</span>
<span class="c1">      ;--------------------------------------------</span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------------------------------------------;</span>
<span class="c1">      ; This line ensures &quot;Gui, &quot; commands operate on the main GUI window  ;</span>
<span class="c1">      ;--------------------------------------------------------------------;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Default</span><span class="c1"></span>

<span class="c1">      ;---------------------------------------------------;</span>
<span class="c1">      ; This line ensures ListView commands &quot;LV_..()&quot;     ;</span>
<span class="c1">      ; operate on this specific ListView                 ;</span>
<span class="c1">      ;---------------------------------------------------;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">ListView</span><span class="p">,</span> <span class="n">GuiConfigMain_ListViewCmds</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;----------------------------------------------------------------</span>
<span class="c1">      ; see:                                                          </span>
<span class="c1">      ; https://www.autohotkey.com/docs/commands/Gui.htm#MultiWin     </span>
<span class="c1">      ; https://www.autohotkey.com/docs/commands/Gui.htm#Default      </span>
<span class="c1">      ; https://www.autohotkey.com/docs/commands/ListView.htm#BuiltIn </span>
<span class="c1">      ;----------------------------------------------------------------</span>

      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">ListViewCommands_ReadjustAllCols</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>

<span class="c1">      ;-----------------------------------------------------------</span>
<span class="c1">      ; These lines ensure the next ListView function (&quot;LV_...()&quot;)</span>
<span class="c1">      ; will specifically use GuiConfigMain&#39;s ListView for Commands</span>
<span class="c1">      ;-----------------------------------------------------------</span>
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------------------------------------------</span>
<span class="c1">      ; AutoHotkey Docs for ListView, ModifyCol, AutoHdr</span>
<span class="c1">      ;-------------------------------------------------------------------</span>
<span class="c1">      ; AutoHdr: </span>
<span class="c1">      ;   Adjusts the column&#39;s width to fit </span>
<span class="c1">      ;   its contents and the column&#39;s header text, </span>
<span class="c1">      ;   whichever is wider. </span>
<span class="c1">      ;-------------------------------------------------------------------</span>
<span class="c1">      ; https://www.autohotkey.com/docs/commands/ListView.htm#LV_ModifyCol</span>
<span class="c1">      ;-------------------------------------------------------------------</span>
      
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">3</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">5</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
      <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">6</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>


<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">ListViewCommands_ShowOnlyEnabled</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1">   </span>
<span class="c1">   </span>
<span class="c1">      ;------------------------------------------------------------------------------</span>
<span class="c1">      ; Tells future ListView operations to operate on this specific ListView control</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span>
      
      <span class="n">i_lv_rows</span> <span class="o">:=</span> <span class="kr">LV_GetCount</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      ;-----------------------</span>
<span class="c1">      ; iterate ListView items</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">while</span><span class="ss">(</span><span class="n">i_lv_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ;----------------------------------</span>
<span class="c1">         ; get the cmd in each ListView row</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">i_lv_rows</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;-----------------------------------------</span>
<span class="c1">         ; ensure cmd is present in _COMMANDS array </span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_COMMANDS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">cmd</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            ; msgbox has key [%cmd%]</span>
<span class="c1">            ; if the Command is disabled,  </span>
<span class="c1">            ; then remove that Command&#39;s ListView entry</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">false</span> <span class="o">==</span> <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">cmd</span><span class="p">][</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="kr">LV_Delete</span><span class="ss">(</span> <span class="n">i_lv_rows</span> <span class="ss">)</span>
            <span class="p">}</span></DETAILS>
            
         <span class="p">}</span></DETAILS>
         
         <span class="n">i_lv_rows</span> <span class="o">:=</span> <span class="n">i_lv_rows</span> <span class="o">-</span> <span class="mi">1</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">ListViewCommands_ShowAll</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      ;------------------------------------------------------------------------------</span>
<span class="c1">      ; Tells future ListView operations to operate on this specific ListView control</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span>
      
      <span class="n">ar_enabled</span> <span class="o">:=</span> <span class="p">{}</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------</span>
<span class="c1">      ; iterate ListView items</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="n">Loop</span> <span class="o">%</span> <span class="kr">LV_GetCount</span><span class="ss">()</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ;----------------------------------</span>
<span class="c1">         ; get the cmd in each ListView row</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">cmd</span><span class="p">,</span> <span class="nv">A_Index</span><span class="ss">)</span>
         
         <span class="n">ar_enabled</span><span class="p">[</span><span class="n">cmd</span><span class="p">]</span> <span class="o">:=</span> <span class="nv">true</span>
      <span class="p">}</span></DETAILS>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">for</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">cmd_data</span> <span class="ow">in</span> <span class="vc">_COMMANDS</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span> <span class="n">ar_enabled</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">cmd</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="k">continue</span>
         <span class="p">}</span></DETAILS>
         
         <span class="n">lv_cmd_options</span> <span class="o">:=</span> <span class="ss">(</span><span class="nv">true</span><span class="o">==</span><span class="n">cmd_data</span><span class="p">[</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span><span class="ss">)</span> <span class="o">?</span> <span class="s">&quot;+Check&quot;</span> <span class="o">:</span> <span class="s">&quot;-Check&quot;</span>
         
         <span class="n">cmd_action_id</span>  <span class="o">:=</span> <span class="n">cmd_data</span><span class="p">[</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span>
         <span class="n">action_type</span>    <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">cmd_action_id</span><span class="p">][</span><span class="s">&quot;type&quot;</span><span class="p">]</span>
         <span class="n">action_path</span>    <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">cmd_action_id</span><span class="p">][</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
         <span class="n">action_arg</span>     <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">cmd_action_id</span><span class="p">][</span><span class="s">&quot;arg&quot;</span><span class="p">]</span>
         
         <span class="kr">LV_Add</span><span class="ss">(</span><span class="n">lv_cmd_options</span><span class="c1">   ; Check row if Command is enabled</span>
            <span class="p">,</span> <span class="n">cmd</span><span class="c1">                 ; row 1</span>
            <span class="p">,</span> <span class="s">&quot;&quot;</span><span class="c1">                  ; row 2</span>
            <span class="p">,</span> <span class="n">cmd_action_id</span><span class="c1">       ; row 3</span>
            <span class="p">,</span> <span class="n">action_type</span><span class="c1">         ; row 4</span>
            <span class="p">,</span> <span class="n">action_path</span><span class="c1">         ; row 5</span>
            <span class="p">,</span> <span class="n">action_arg</span> <span class="ss">)</span><span class="c1">        ; row 6</span>
                  
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">ListViewCommands_UpdateAllWhichUseAction</span><span class="ss">(</span> <span class="n">p_actionID</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>   
   
      <span class="n">aID</span>   <span class="o">:=</span> <span class="n">p_actionID</span>
      <span class="n">aType</span> <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">aID</span><span class="p">][</span><span class="s">&quot;type&quot;</span><span class="p">]</span>
      <span class="n">aPath</span> <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">aID</span><span class="p">][</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
      <span class="n">aArg</span>  <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">aID</span><span class="p">][</span><span class="s">&quot;arg&quot;</span><span class="p">]</span>
      
      <span class="kr">msgBOX</span> <span class="n">id</span><span class="p">[</span><span class="vi">%aID%</span><span class="p">]</span> <span class="n">type</span><span class="p">[</span><span class="vi">%aType%</span><span class="p">]</span> <span class="n">path</span><span class="p">[</span><span class="vi">%aPath%</span><span class="p">]</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; Tells future ListView operations to operate on this specific ListView control</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; iterate ListView items</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="n">Loop</span> <span class="o">%</span> <span class="kr">LV_GetCount</span><span class="ss">()</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; get the cmd in each ListView row</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">cmd</span><span class="p">,</span> <span class="nv">A_Index</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ; ensure cmd is present in _COMMANDS array </span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_COMMANDS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">cmd</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">            ; if the Command uses this updated Action </span>
<span class="c1">            ; then update that Command&#39;s ListView entry with updated Action config</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">aID</span> <span class="o">==</span> <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">cmd</span><span class="p">][</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">               </span>
<span class="c1">               ;------------------------------------------------------</span>
<span class="c1">               ; AutoHotkey Docs, Ternary Operator: </span>
<span class="c1">               ; https://www.autohotkey.com/docs/Variables.htm#ternary</span>
<span class="c1">               ;</span>
               <span class="n">lv_cmd_options</span> <span class="o">:=</span> <span class="ss">(</span><span class="nv">true</span><span class="o">==</span><span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">cmd</span><span class="p">][</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span><span class="ss">)</span> <span class="o">?</span> <span class="s">&quot;+Check&quot;</span> <span class="o">:</span> <span class="s">&quot;-Check&quot;</span>
               
               <span class="kr">LV_Modify</span><span class="ss">(</span><span class="nv">A_Index</span>
                  <span class="p">,</span> <span class="n">lv_cmd_options</span><span class="c1">     ; no options</span>
                  <span class="p">,</span> <span class="n">cmd</span><span class="c1">                 ; row 1</span>
                  <span class="p">,</span><span class="c1">                     ; row 2 is always empty</span>
                  <span class="p">,</span> <span class="n">aID</span><span class="c1">                 ; row 3</span>
                  <span class="p">,</span> <span class="n">aType</span><span class="c1">               ; row 4</span>
                  <span class="p">,</span> <span class="n">aPath</span><span class="c1">               ; row 5</span>
                  <span class="p">,</span> <span class="n">aArg</span>        <span class="ss">)</span><span class="c1">       ; row 6        </span>
                  
            <span class="p">}</span></DETAILS>
            
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span> 
   <span class="p">}</span></DETAILS>



   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Create_Popup</span><span class="ss">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">purpose</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1">      </span>
<span class="c1">   </span>
<span class="c1">      ; Parameters</span>
<span class="c1">      ;----------------------------------------------------</span>
<span class="c1">      ; mode    is either:    &quot;command&quot;  or  &quot;action&quot;</span>
<span class="c1">      ; purpose is either:        &quot;add&quot;  or  &quot;edit&quot;</span>
<span class="c1">      ;----------------------------------------------------</span>
      
      <span class="n">plural</span> <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;command&quot;</span><span class="o">=</span><span class="n">mode</span><span class="ss">)</span> <span class="o">?</span> <span class="s">&quot;Commands&quot;</span>   <span class="o">:</span> <span class="s">&quot;Actions&quot;</span>
      <span class="n">caps</span>   <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;command&quot;</span><span class="o">=</span><span class="n">mode</span><span class="ss">)</span> <span class="o">?</span> <span class="s">&quot;Command&quot;</span>    <span class="o">:</span> <span class="s">&quot;Action&quot;</span>
      <span class="n">AR</span>     <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;command&quot;</span><span class="o">=</span><span class="n">mode</span><span class="ss">)</span> <span class="o">?</span> <span class="s">&quot;_COMMANDS&quot;</span>  <span class="o">:</span> <span class="s">&quot;_ACTIONS&quot;</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------------------</span>
<span class="c1">      ; Here, ensure the next ListView function (&quot;LV_...()&quot;)</span>
<span class="c1">      ; will specifically use the appropriate ListView in GuiConfigMain</span>
<span class="c1">      ;-----------------------------------------------------------------</span>
      
      
<DETAILS class="leading_tabs_4"><SUMMARY><span class="c1">;====================================================================</span>
<span class="c1">            ;</span>
<span class="c1">            ; Note:</span>
<span class="c1">            ;</span>
<span class="c1">            ; AutoHotkey Info : Dynamically Calling + Function References</span>
<span class="c1">            ;</span>
<span class="c1">            ;==================================================================== </span></SUMMARY>
<span class="c1">            ;</span>
<span class="c1">            ; The line `GuiConfigMain[fn]()` will call one of these two functions</span>
<span class="c1">            ;</span>
<span class="c1">            ;    GuiConfigMain.ListViewCommands_Activate()</span>
<span class="c1">            ;    GuiConfigMain.ListViewActions_Activate()</span>
<span class="c1">            ;====================================================================</span>
<span class="c1">            ;</span>
<span class="c1">            ; Read more about how this works: </span>
<span class="c1">            ;</span>
<span class="c1">            ;    https://www.autohotkey.com/boards/viewtopic.php?t=6354</span>
<span class="c1">            ;    https://www.autohotkey.com/docs/Objects.htm#Function_References</span>
<span class="c1">            ;    https://www.autohotkey.com/docs/Objects.htm#Usage_Objects </span>
<span class="c1">            ;      -&gt; end of first section begins with `x.y[z]()` example.</span>
<span class="c1">            ;==================================================================== </span></DETAILS>
<span class="c1">            ;</span>
      <span class="n">fn</span> <span class="o">:=</span> <span class="s">&quot;ListView&quot;</span> <span class="n">plural</span> <span class="s">&quot;_Activate&quot;</span>
      <span class="n">GuiConfigMain</span><span class="p">[</span><span class="n">fn</span><span class="p">]</span><span class="ss">()</span>
         
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
<DETAILS class="leading_tabs_3"><SUMMARY><span class="c1">;-----------------------------------------------------------</span>
<span class="c1">         ; If LV_GetNext(0) succeeds, then a row is selected. </span>
<span class="c1">         ;----------------------------------------------------------- </span></SUMMARY>
<span class="c1">         ; The user either hit &lt;Enter&gt; or double-clicked that row.</span>
<span class="c1">         ; An &quot;Edit Action/Command&quot; popup will appear for this item.</span>
<span class="c1">         ;</span>
<span class="c1">         ;-----------------------------------------------------------</span>
<span class="c1">         ; If LV_GetNext(0) fails, then there is no selection.</span>
<span class="c1">         ;-----------------------------------------------------------</span>
<span class="c1">         ; The user either hit &lt;Enter&gt; w/o a selection or </span>
<span class="c1">         ; double-clicked a blank area, not a row.</span>
<span class="c1">         ; A &quot;New Action/Command&quot; popup will appear.</span>
<span class="c1">         ;----------------------------------------------------------- </span></DETAILS>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">0</span> <span class="o">!=</span> <span class="kr">LV_GetNext</span><span class="ss">(</span><span class="mi">0</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">purpose</span> <span class="o">:=</span> <span class="s">&quot;edit&quot;</span>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">purpose</span> <span class="o">:=</span> <span class="s">&quot;add&quot;</span>            
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">mode</span>
      <span class="ow">or</span>  <span class="s">&quot;action&quot;</span>  <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;=============================================</span>
<span class="c1">         ;   Create Popup to Add a (Command or Action)</span>
<span class="c1">         ;=============================================</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;add&quot;</span> <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">            ;------------------------------------------</span>
<span class="c1">            ; Create Popup, </span>
<span class="c1">            ; if this global var is empty.</span>
<span class="c1">            ;------------------------------------------</span>
<span class="c1">            ;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_o_Gui_Config_Popup</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="vc">_o_Gui_Config_Popup</span> <span class="o">:=</span> <span class="n">new</span> <span class="nf">GuiConfigPopup</span><span class="ss">(</span><span class="n">mode</span><span class="p">,</span> <span class="s">&quot;add&quot;</span><span class="ss">)</span>
            <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="c1"> ;error; _____SUMMARY_END_____</span>
               <span class="kr">MsgBox</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>  <span class="p">[</span> <span class="n">PROGRAM</span> <span class="n">ERROR</span> <span class="p">],</span> <span class="o">%</span> <span class="s">&quot;Whoops, big bug, a Popup is already open!</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="p">}</span></DETAILS>
            
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         ;=============================================</span>
<span class="c1">         ;   Create Popup to Edit a (Command or Action)</span>
<span class="c1">         ;=============================================</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> 
         <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;edit&quot;</span> <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            </span>
<span class="c1">            ;===============================================</span>
<span class="c1">            ; Get the row# of the selected ListView item.</span>
<span class="c1">            ;===============================================</span>
            
            <span class="n">which_row</span> <span class="o">:=</span> <span class="kr">LV_GetNext</span><span class="ss">(</span><span class="mi">0</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            </span>
<span class="c1">            ;================================</span>
<span class="c1">            ; Exit if no selection to edit.</span>
<span class="c1">            ;================================</span>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="mi">0</span> <span class="o">==</span> <span class="n">which_row</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               
               <span class="k">return</span><span class="c1">   ; User pressed &quot;Edit Selected...&quot; Button</span>
<span class="c1">                      ; with no selection. </span>
<span class="c1">                      ; Ignore. </span>
            <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            </span>
<span class="c1">            ;===============================================</span>
<span class="c1">            ; Get the selected row&#39;s 1st column, either: </span>
<span class="c1">            ;   - the Action&#39;s  ID</span>
<span class="c1">            ;   - the Command&#39;s text</span>
<span class="c1">            ;===============================================</span>
            
            <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">aID_or_cmd</span><span class="p">,</span> <span class="n">which_row</span><span class="p">,</span> <span class="mi">1</span><span class="ss">)</span>
            
            
<DETAILS class="leading_tabs_4"><SUMMARY><span class="c1">;--------------------------------------------------------------</span>
<span class="c1">            ; AutoHotkey Info, using a %variable_name% stored in a string</span>
<span class="c1">            ;-------------------------------------------------------------- </span></SUMMARY>
<span class="c1">            ; Here, I&#39;d like to showcase a language feature of AutoHotkey, </span>
<span class="c1">            ; </span>
<span class="c1">            ; where you can %resolve% a variable stored in a string </span>
<span class="c1">            ; in order to dynamically change the variable a line uses.</span>
<span class="c1">            ;</span>
<span class="c1">            ; </span>
<span class="c1">            ; The following logic :</span>
<span class="c1">            ; </span>
<span class="c1">            ;    AR := (&quot;command&quot; == mode) ? &quot;_COMMANDS&quot; : &quot;_ACTIONS&quot;</span>
<span class="c1">            ;</span>
<span class="c1">            ;    if( %AR%.HasKey(aID_or_cmd) ){ .. }</span>
<span class="c1">            ;    </span>
<span class="c1">            ; serves to dynamically turn this if branch </span>
<span class="c1">            ; into the following:</span>
<span class="c1">            ;    </span>
<span class="c1">            ;    if(  _ACTIONS.HasKey(row_cmd) ){ .. }</span>
<span class="c1">            ;    if( _COMMANDS.HasKey(row_cmd) ){ .. }</span>
<span class="c1">            ;    </span>
<span class="c1">            ;--------------------------------------------------------------</span>
<span class="c1">            ;    </span>
<span class="c1">            ; However, the following if branch </span>
<span class="c1">            ; can alternatively be replaced with this instead :</span>
<span class="c1">            ; </span>
<span class="c1">            ;    if(&quot;command&quot; == mode){</span>
<span class="c1">            ;       valid_key := _COMMANDS.HasKey(row_cmd)</span>
<span class="c1">            ;    }</span>
<span class="c1">            ;    if(&quot;action&quot; == mode){</span>
<span class="c1">            ;       valid_key := _ACTIONS.HasKey(row_cmd)</span>
<span class="c1">            ;    }</span>
<span class="c1">            ;    if( valid_key ){ ... }</span>
<span class="c1">            ;</span>
<span class="c1">            ;--------------------------------------------------------------</span>
<span class="c1">            ; AutoHotkey docs:</span>
<span class="c1">            ;</span>
<span class="c1">            ; https://www.autohotkey.com/docs/Functions.htm#DynCall</span>
<span class="c1">            ; https://www.autohotkey.com/docs/Variables.htm#operators</span>
<span class="c1">            ;               (see %Var% in the operators table ^)</span>
<span class="c1">            ;-------------------------------------------------------------- </span></DETAILS>
<span class="c1">            </span>
<span class="c1">            ;===============================================</span>
<span class="c1">            ; Ensure the row is still valid in main array</span>
<span class="c1">            ;===============================================</span>
            
            <span class="n">AR</span> <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span> <span class="o">?</span> <span class="s">&quot;_COMMANDS&quot;</span> <span class="o">:</span> <span class="s">&quot;_ACTIONS&quot;</span>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vi">%AR%</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span> <span class="n">aID_or_cmd</span> <span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">               </span>
<span class="c1">               </span>
<span class="c1">               ;===============================================</span>
<span class="c1">               ; Store the (Action or Command)&#39;s ListView data </span>
<span class="c1">               ; for the Popup to access.</span>
<span class="c1">               ;===============================================</span>
               
               <span class="n">row_dat</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Get_Associative_Array_Of_Selected_LV_Row_Data</span><span class="ss">(</span><span class="n">which_row</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">               </span>
<span class="c1">               </span>
<span class="c1">               ;==============================================================</span>
<span class="c1">               ; Pluck command for editing </span>
<span class="c1">               ;   ( more details in Pluck_Selected_Command_From_COMMANDS() )</span>
<span class="c1">               ;==============================================================               </span>
<span class="c1">               </span>
<span class="c1">               ;-------------------------------------------------------------</span>
<span class="c1">               ; Call either </span>
<span class="c1">               ;</span>
<span class="c1">               ;       GuiConfigMain.Pluck_Selected_Command_From_COMMANDS() </span>
<span class="c1">               ;    or GuiConfigMain.Pluck_Selected_Action_From_ACTIONS()</span>
<span class="c1">               ;</span>
<span class="c1">               ;-------------------------------------------------------------</span>
<span class="c1">               ; See above note on Dynamically Calling Function References </span>
<span class="c1">               ;-------------------------------------------------------------</span>
               
               <span class="n">fn</span> <span class="o">:=</span> <span class="s">&quot;Pluck_Selected_&quot;</span> <span class="n">caps</span> <span class="s">&quot;_From&quot;</span> <span class="n">AR</span> 
               <span class="n">GuiConfigMain</span><span class="p">[</span><span class="n">fn</span><span class="p">]</span><span class="ss">(</span> <span class="n">aID_or_cmd</span> <span class="ss">)</span><span class="c1"></span>
<span class="c1">               </span>
<span class="c1">               </span>
<span class="c1">               ;=======================================;</span>
<span class="c1">               ;     Create Popup  :  Command Edit     ;</span>
<span class="c1">               ;=======================================;</span>
               
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_o_Gui_Config_Popup</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="vc">_o_Gui_Config_Popup</span> <span class="o">:=</span> <span class="n">new</span> <span class="nf">GuiConfigPopup</span><span class="ss">(</span><span class="n">mode</span><span class="p">,</span> <span class="s">&quot;edit&quot;</span><span class="p">,</span> <span class="n">row_dat</span><span class="ss">)</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="c1"> ;then bug; _____SUMMARY_END_____</span>
                  <span class="kr">MsgBox</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>  <span class="p">[</span> <span class="n">PROGRAM</span> <span class="n">ERROR</span> <span class="p">],</span> <span class="o">%</span> <span class="s">&quot;Whoops, a Popup is already open.</span><span class="se">`n</span><span class="s">&quot;</span>
               <span class="p">}</span></DETAILS>
               
            <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="c1"> ;then bug; _____SUMMARY_END_____</span>
               <span class="n">debug_out</span> <span class="o">:=</span> <span class="s">&quot;mode[&quot;</span> <span class="n">mode</span> <span class="s">&quot;] purpose[&quot;</span> <span class="n">purpose</span> <span class="s">&quot;] </span><span class="se">`n</span><span class="s">&quot;</span>
               <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;Trying to open config Popup window, </span><span class="se">`n</span><span class="s">&quot;</span>
               <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;but array &quot;</span> <span class="n">AR</span> <span class="s">&quot; does not have key[&quot;</span> <span class="n">aID_or_cmd</span> <span class="s">&quot;], </span><span class="se">`n</span><span class="s">&quot;</span>
               <span class="kr">msgbox</span> <span class="vi">%debug_out%</span>
            <span class="p">}</span></DETAILS>
            
         <span class="p">}</span></DETAILS>
      
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
   
   
    
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Pluck_Selected_Command_From_COMMANDS</span><span class="ss">(</span><span class="n">p_row_cmd</span><span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;-------------------------------------------------------------------------</span>
<span class="c1">   ; Note</span>
<span class="c1">   ;-------------------------------------------------------------------------</span>
<span class="c1">   ;</span>
<span class="c1">   ; _COMMANDS and _ACTIONS, keys + values, and edit Popups : </span>
<span class="c1">   ;</span>
<span class="c1">   ;   On creating a Popup with purpose &quot;edit&quot;, </span>
<span class="c1">   ;   for either popup mode &quot;action&quot; or popup mode &quot;command&quot;</span>
<span class="c1">   ;   remove the entry from _ACTIONS or _COMMANDS.</span>
<span class="c1">   ;</span>
<span class="c1">   ;   Later after either (user cancels or user submits) the popup,</span>
<span class="c1">   ;   add the key + value back into _ACTIONS or _COMMANDS </span>
<span class="c1">   ;   (which is potentially the same, or potentially entirely modified).</span>
<span class="c1">   ;</span>
<span class="c1">   ;------------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">   ; Why this implementation?</span>
<span class="c1">   ;-------------------------------------------------------------------------</span>
<span class="c1">   ;</span>
<span class="c1">   ; Short answer:</span>
<span class="c1">   ;</span>
<span class="c1">   ;   As with all algorithms, there&#39;s many ways to accomplish the same thing.</span>
<span class="c1">   ;   I liked the simplicity of implementation of this direction most.</span>
<span class="c1">   ;</span>
<span class="c1">   ;-------------------------------------------------------------------------</span>
<span class="c1">   ;</span>
<span class="c1">   ; Explanation:</span>
<span class="c1">   ;</span>
<span class="c1">   ;   When a preexisting Action or Command is edited, </span>
<span class="c1">   ;   this implementation removes it from the main internal array </span>
<span class="c1">   ;   which holds all the _ACTIONS{} or _COMMANDS{} at runtime.</span>
<span class="c1">   ;</span>
<span class="c1">   ;   Later, when a popup submits the user&#39;s edited changes, </span>
<span class="c1">   ;   first the app checks the _COMMANDS or _ACTIONS array for conflicts</span>
<span class="c1">   ;   (depending on whether the _popup_mode is &quot;command&quot; or &quot;action&quot;).</span>
<span class="c1">   ;   </span>
<span class="c1">   ;   Since no two Commands will ever have the same text, and </span>
<span class="c1">   ;   since no two Actions will ever have exactly the same path data, and</span>
<span class="c1">   ;   since the app always removes the edited key value pair from </span>
<span class="c1">   ;   _COMMANDS or _ARRAYS before editing, </span>
<span class="c1">   ;   this not-a-duplicate verification can use the same logic </span>
<span class="c1">   ;   as the logic for adding a new Command or Action.</span>
<span class="c1">   ;</span>
<span class="c1">   ; Benefit:</span>
<span class="c1">   ;</span>
<span class="c1">   ;   For instance, if the user edits a Command, and renames the Command, </span>
<span class="c1">   ;   there&#39;s no need for additional logic which checks _COMMANDS </span>
<span class="c1">   ;   for the old command key, compares it to what is potentially a new key </span>
<span class="c1">   ;   then additionally checks for preexisting other Commands with the same key.</span>
<span class="c1">   ;</span>
<span class="c1">   ;   In this current implementation, since we remove the key upfront,</span>
<span class="c1">   ;   if the key doesn&#39;t exist, </span>
<span class="c1">   ;      then we can immediately add it in, </span>
<span class="c1">   ;      regardless of whether it&#39;s edited or brand new.</span>
<span class="c1">   ;</span>
<span class="c1">   ;   If the Command keeps the same name and only changes the Action configuration</span>
<span class="c1">   ;   then the key which was plucked from _COMMANDS can be added back in </span>
<span class="c1">   ;   with a slightly different value for the corresponding Action data to trigger.</span>
<span class="c1">   ;   And no other logic is needed other than `if(!_COMMANDS.HasKey(cmd))`.</span>
<span class="c1">   ;</span>
<span class="c1">   ; Tradeoff:</span>
<span class="c1">   ;</span>
<span class="c1">   ;   This current design choice potentially has the drawback </span>
<span class="c1">   ;   of being unintuitive at a glance, </span>
<span class="c1">   ;   but the benefit of the simplicity of verification logic </span>
<span class="c1">   ;   was appealing enough to me to go this route. </span>
<span class="c1">   ;</span>
<span class="c1">   ;------------------------------------------------------------------------- </span></DETAILS>
   
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;=================================================================</span>
<span class="c1">      ; Pluck and save current row&#39;s command data                       </span>
<span class="c1">      ; from _COMMANDS array                                            </span>
<span class="c1">      ; into _plucked_command variable.                                 </span>
<span class="c1">      ;================================================================= </span></SUMMARY>
<span class="c1">      ; How _plucked_command will be used:                              </span>
<span class="c1">      ;                                                                 </span>
<span class="c1">      ;   If user cancels,                                              </span>
<span class="c1">      ;     when GuiConfigPopup is closed                               </span>
<span class="c1">      ;     GUI_EVENT_GuiConfigPopup_OnClose will use _plucked_command  </span>
<span class="c1">      ;     to restore the command to the _COMMANDS array.              </span>
<span class="c1">      ;                                                                 </span>
<span class="c1">      ;   If user submits an edited command,                          </span>
<span class="c1">      ;     we&#39;ll assign new command data to the _COMMANDS array,       </span>
<span class="c1">      ;     and make _plucked_command empty to prevent                  </span>
<span class="c1">      ;       GUI_EVENT_GuiConfigPopup_OnClose from restoring it.         </span>
<span class="c1">      ;================================================================= </span></DETAILS>
      
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_command</span> <span class="o">:=</span> <span class="p">{</span> <span class="s">&quot;&quot;</span> 
         <span class="o">.</span>   <span class="s">&quot;command&quot;</span><span class="o">:</span>   <span class="n">p_row_cmd</span>
           <span class="p">,</span> <span class="s">&quot;enabled&quot;</span><span class="o">:</span>   <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">p_row_cmd</span><span class="p">][</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span>
           <span class="p">,</span> <span class="s">&quot;action_id&quot;</span><span class="o">:</span> <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">p_row_cmd</span><span class="p">][</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span> <span class="p">}</span><span class="c1">   </span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------------</span>
<span class="c1">      ; Deletes from the array storing all our Commands. </span>
<span class="c1">      ;-----------------------------------------------------------</span>
<span class="c1">      ; Doing this allows both Popup-&gt;EditCmd + Popup-&gt;AddCmd </span>
<span class="c1">      ; to use the same logic (_COMMANDS.HasKey()) to ensure</span>
<span class="c1">      ; the user&#39;s input won&#39;t become a duplicate entry.</span>
<span class="c1">      ;      </span>
      <span class="vc">_COMMANDS</span><span class="o">.</span><span class="kp">Delete</span><span class="ss">(</span><span class="n">p_row_cmd</span><span class="ss">)</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Discard_Plucked_Command</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;----------------------------------------</span>
<span class="c1">      ; Remove backup of (now) edited command</span>
<span class="c1">      ;----------------------------------------</span>
<span class="c1">      ; Making this variable empty will prevent </span>
<span class="c1">      ;</span>
<span class="c1">      ;   GUI_EVENT_GuiConfigPopup_OnClose and</span>
<span class="c1">      ;   GUI_EVENT_GuiConfigPopup_OnEscape</span>
<span class="c1">      ;</span>
<span class="c1">      ; from automatically restoring </span>
<span class="c1">      ; the old version of this Command</span>
<span class="c1">      ;</span>
<span class="c1">      ; when the GuiConfigPopup GUI is closed.</span>
<span class="c1">      ;----------------------------------------</span>
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_command</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Restore_Plucked_Command_If_User_Cancelled</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;-----------------------------------------------------------</span>
<span class="c1">      ; If user cancelled out of the GuiConfigPopup GUI</span>
<span class="c1">      ; then restore the original Command to the _COMMANDS array.</span>
<span class="c1">      ;-----------------------------------------------------------</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_command</span> <span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">cmd</span>        <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_command</span><span class="p">[</span><span class="s">&quot;command&quot;</span><span class="p">]</span>
         <span class="n">is_enabled</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_command</span><span class="p">[</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span>
         <span class="n">aID</span>        <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_command</span><span class="p">[</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span>
         
         <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">cmd</span><span class="p">]</span> <span class="o">:=</span> <span class="p">{</span> <span class="s">&quot;action_id&quot;</span><span class="o">:</span><span class="n">aID</span><span class="p">,</span> <span class="s">&quot;enabled&quot;</span><span class="o">:</span><span class="n">is_enabled</span> <span class="p">}</span>
         
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_command</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Pluck_Selected_Action_From_ACTIONS</span><span class="ss">(</span><span class="n">p_action_id</span><span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;------------------------------------------------------------</span>
<span class="c1">      ; same as GuiConfigMain.Pluck_Selected_Command_From_COMMANDS</span>
<span class="c1">      ;------------------------------------------------------------</span>
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_action</span> <span class="o">:=</span> <span class="p">{</span> <span class="s">&quot;&quot;</span>
         <span class="o">.</span>   <span class="s">&quot;action_id&quot;</span>  <span class="o">:</span> <span class="n">p_action_id</span>
           <span class="p">,</span> <span class="s">&quot;action_type&quot;</span><span class="o">:</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">p_action_id</span><span class="p">][</span><span class="s">&quot;type&quot;</span><span class="p">]</span>
           <span class="p">,</span> <span class="s">&quot;action_path&quot;</span><span class="o">:</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">p_action_id</span><span class="p">][</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
           <span class="p">,</span> <span class="s">&quot;action_arg&quot;</span> <span class="o">:</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">p_action_id</span><span class="p">][</span><span class="s">&quot;arg&quot;</span><span class="p">]</span>   <span class="p">}</span>
           
      <span class="vc">_ACTIONS</span><span class="o">.</span><span class="kp">Delete</span><span class="ss">(</span><span class="n">p_action_id</span><span class="ss">)</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Discard_Plucked_Action</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_action</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Restore_Plucked_Action_If_User_Cancelled</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">      ;-----------------------------------------------------------</span>
<span class="c1">      ; If user cancelled out of the GuiConfigPopup GUI</span>
<span class="c1">      ; then restore the original Command to the _COMMANDS array.</span>
<span class="c1">      ;-----------------------------------------------------------</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_action</span> <span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">aID</span>   <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_action</span><span class="p">[</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span>
         <span class="n">aType</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_action</span><span class="p">[</span><span class="s">&quot;action_type&quot;</span><span class="p">]</span>
         <span class="n">aPath</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_action</span><span class="p">[</span><span class="s">&quot;action_path&quot;</span><span class="p">]</span>
         <span class="n">aArg</span>  <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_action</span><span class="p">[</span><span class="s">&quot;action_arg&quot;</span><span class="p">]</span>
         
         <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">aID</span><span class="p">]</span> <span class="o">:=</span> <span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="n">aType</span><span class="p">,</span> <span class="s">&quot;path&quot;</span><span class="o">:</span><span class="n">aPath</span><span class="p">,</span> <span class="s">&quot;arg&quot;</span><span class="o">:</span><span class="n">aArg</span><span class="p">}</span>
         
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_action</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS><span class="c1"></span>


<span class="c1">   ;-------------------------------------------------------------------</span>
<span class="c1">   ; Only called for &quot;edit&quot; Popups, either mode (&quot;action&quot; or &quot;command&quot;)</span>
<span class="c1">   ;</span>
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Get_Associative_Array_Of_Selected_LV_Row_Data</span><span class="ss">(</span> <span class="n">selected_row</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
   <span class="nb">local</span>  <span class="n">got_cmd</span><span class="p">,</span> <span class="n">got_cmd_is_enabled</span> 
   <span class="nb">local</span>  <span class="n">got_actionId</span><span class="p">,</span> <span class="n">got_actionType</span><span class="p">,</span> <span class="n">got_actionType</span><span class="p">,</span> <span class="n">got_actionArg</span>
   
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;-----------------------------------------------------</span>
<span class="c1">      ; Parameter: selected_row</span>
<span class="c1">      ;----------------------------------------------------- </span></SUMMARY>
<span class="c1">      ;</span>
<span class="c1">      ; - ListView row ID (integer)</span>
<span class="c1">      ;   for the active ListView in GuiConfigMain</span>
<span class="c1">      ;   (either a row in GuiConfigMain_ListViewActions</span>
<span class="c1">      ;                 or GuiConfigMain_ListViewCmds).</span>
<span class="c1">      ;</span>
<span class="c1">      ; - This function will copy that row&#39;s data,</span>
<span class="c1">      ;   for the &quot;edit&quot; Popup to read.</span>
<span class="c1">      ;</span>
<span class="c1">      ; - When the &quot;edit&quot; Popup &quot;Submits&quot; its data </span>
<span class="c1">      ;   it modifies the ListView row with this ID</span>
<span class="c1">      ;   to reflect the edited action or command.</span>
<span class="c1">      ; </span>
<span class="c1">      ;----------------------------------------------------- </span></DETAILS>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;========================================================</span>
<span class="c1">      ; Create the associative array to hold the row&#39;s data in</span>
<span class="c1">      ; for Popup to reference</span>
<span class="c1">      ;========================================================</span>
      
      <span class="n">row_dat</span> <span class="o">:=</span> <span class="p">{}</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;========================================</span>
<span class="c1">      ; Refresh the variable GuiConfigMain_Tabs</span>
<span class="c1">      ; which stores the current tab name</span>
<span class="c1">      ;========================================</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span><span class="n">Submit</span><span class="p">,</span> <span class="n">NoHide</span><span class="c1"> </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;========================================</span>
<span class="c1">      ; Copy selected ListView Row&#39;s data </span>
<span class="c1">      ;========================================</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;Actions&quot;</span> <span class="o">==</span> <span class="n">GuiConfigMain_Tabs</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_Activate</span><span class="ss">()</span>
         
         <span class="n">got_cmd</span>            <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> ; not used for this type of config popup </span>
         <span class="n">got_cmd_is_enabled</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> ; not used for this type of config popup </span>
         
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">got_actionID</span><span class="p">,</span>   <span class="n">selected_row</span><span class="p">,</span><span class="mi">1</span><span class="ss">)</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">got_actionType</span><span class="p">,</span> <span class="n">selected_row</span><span class="p">,</span><span class="mi">2</span><span class="ss">)</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">got_actionPath</span><span class="p">,</span> <span class="n">selected_row</span><span class="p">,</span><span class="mi">3</span><span class="ss">)</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">got_actionArg</span><span class="p">,</span>  <span class="n">selected_row</span><span class="p">,</span><span class="mi">4</span><span class="ss">)</span>
         
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;Commands&quot;</span> <span class="o">==</span> <span class="n">GuiConfigMain_Tabs</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span>
         
<DETAILS class="leading_tabs_3"><SUMMARY><span class="c1">;-----------------------------------------------------------------</span>
<span class="c1">         ; AutoHotkey Docs:</span>
<span class="c1">         ;----------------------------------------------------------------- </span></SUMMARY>
<span class="c1">         ; LV_GetNext(StartingRowNumber, RowType)</span>
<span class="c1">         ;</span>
<span class="c1">         ;    &quot;... the search begins at the row after StartingRowNumber&quot;</span>
<span class="c1">         ;</span>
<span class="c1">         ;    &quot;If RowType is omitted, </span>
<span class="c1">         ;     the function searches for the next selected/highlighted row. </span>
<span class="c1">         ;     Otherwise, specify &quot;C&quot; or &quot;Checked&quot; to find the next checked row; </span>
<span class="c1">         ;     or &quot;F&quot; or &quot;Focused&quot; to find the focused row ...&quot;</span>
<span class="c1">         ;</span>
<span class="c1">         ; https://www.autohotkey.com/docs/commands/ListView.htm#LV_GetNext</span>
<span class="c1">         ;----------------------------------------------------------------- </span></DETAILS>
         <span class="n">got_cmd_is_enabled</span> <span class="o">:=</span> <span class="kr">LV_GetNext</span><span class="ss">(</span><span class="n">selected_row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="ss">)</span>
         
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">got_cmd</span><span class="p">,</span>        <span class="n">selected_row</span><span class="p">,</span><span class="mi">1</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">         ; column 2 is just an arrow &quot;-&gt;&quot; to visually separate cmd cols from action cols</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">got_actionID</span><span class="p">,</span>   <span class="n">selected_row</span><span class="p">,</span><span class="mi">3</span><span class="ss">)</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">got_actionType</span><span class="p">,</span> <span class="n">selected_row</span><span class="p">,</span><span class="mi">4</span><span class="ss">)</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">got_actionPath</span><span class="p">,</span> <span class="n">selected_row</span><span class="p">,</span><span class="mi">5</span><span class="ss">)</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">got_actionArg</span><span class="p">,</span>  <span class="n">selected_row</span><span class="p">,</span><span class="mi">6</span><span class="ss">)</span>
            
      
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      </span>
<span class="c1">      ;==========================================================</span>
<span class="c1">      ; Initialize the row_dat array with the ListView Row data </span>
<span class="c1">      ;==========================================================</span>
   
      <span class="n">row_dat</span><span class="p">[</span><span class="s">&quot;LV_id&quot;</span><span class="p">]</span>               <span class="o">:=</span> <span class="n">selected_row</span>
      <span class="n">row_dat</span><span class="p">[</span><span class="s">&quot;row_cmd&quot;</span><span class="p">]</span>             <span class="o">:=</span> <span class="n">got_cmd</span>
      <span class="n">row_dat</span><span class="p">[</span><span class="s">&quot;row_cmd_is_enabled&quot;</span><span class="p">]</span>  <span class="o">:=</span> <span class="n">got_cmd_is_enabled</span>
      <span class="n">row_dat</span><span class="p">[</span><span class="s">&quot;row_actionID&quot;</span><span class="p">]</span>        <span class="o">:=</span> <span class="n">got_actionId</span>
      <span class="n">row_dat</span><span class="p">[</span><span class="s">&quot;row_actionType&quot;</span><span class="p">]</span>      <span class="o">:=</span> <span class="n">got_actionType</span>
      <span class="n">row_dat</span><span class="p">[</span><span class="s">&quot;row_actionPath&quot;</span><span class="p">]</span>      <span class="o">:=</span> <span class="n">got_actionPath</span>
      <span class="n">row_dat</span><span class="p">[</span><span class="s">&quot;row_actionArg&quot;</span><span class="p">]</span>       <span class="o">:=</span> <span class="n">got_actionArg</span>
      
      <span class="k">return</span> <span class="n">row_dat</span>
   <span class="p">}</span></DETAILS>
   
   
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_EnableCommand</span><span class="ss">(</span> <span class="n">cmd</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
   
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_COMMANDS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">cmd</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
         <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">cmd</span><span class="p">][</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">:=</span> <span class="nv">true</span>
         
         <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Savefile__Enable_Command</span><span class="ss">(</span> <span class="n">cmd</span> <span class="ss">)</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_DisableCommand</span><span class="ss">(</span> <span class="n">cmd</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_COMMANDS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">cmd</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
         <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">cmd</span><span class="p">][</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span> <span class="o">:=</span> <span class="nv">false</span>
         
         <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Savefile__Disable_Command</span><span class="ss">(</span> <span class="n">cmd</span> <span class="ss">)</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;----------------------------------------------</span>
<span class="c1">         ; If user has chosen to hide disabled commands</span>
<span class="c1">         ; (in GuiConfigMain&#39;s Commands ListView), </span>
<span class="c1">         ;</span>
<span class="c1">         ; then hide this Command too.</span>
<span class="c1">         ;----------------------------------------------</span>
         
         <span class="kr">GuiControlGet</span><span class="p">,</span><span class="n">show_all_state</span><span class="p">,,</span> <span class="n">GuiConfigMain_CheckboxShowAll</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">false</span> <span class="o">==</span> <span class="n">show_all_state</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_ShowOnlyEnabled</span><span class="ss">()</span>
         <span class="p">}</span></DETAILS>
                  
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_DeleteCommand</span><span class="ss">(</span> <span class="n">cmd_to_delete</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; iterate ListView items</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="n">Loop</span> <span class="o">%</span> <span class="kr">LV_GetCount</span><span class="ss">()</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; get the cmd in each ListView row</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">cmd</span><span class="p">,</span> <span class="nv">A_Index</span><span class="p">,</span> <span class="mi">1</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ; ensure cmd is present in _COMMANDS array </span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_COMMANDS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">cmd</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">cmd_to_delete</span> <span class="o">==</span> <span class="n">cmd</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="kr">LV_Delete</span><span class="ss">(</span> <span class="nv">A_Index</span> <span class="ss">)</span>
               
               <span class="n">p1</span> <span class="o">:=</span> <span class="s">&quot;command&quot;</span>
               <span class="n">p2</span> <span class="o">:=</span> <span class="s">&quot;delete&quot;</span>
               <span class="n">p3</span> <span class="o">:=</span> <span class="n">cmd</span>
               <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Savefile</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span> <span class="ss">)</span>
               <span class="k">break</span>
            <span class="p">}</span></DETAILS>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_DeleteAction</span><span class="ss">(</span> <span class="n">action_id_to_delete</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
   
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; iterate ListView items</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="n">Loop</span> <span class="o">%</span> <span class="kr">LV_GetCount</span><span class="ss">()</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; get the ID in each ListView row</span>
         <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">actionID</span><span class="p">,</span> <span class="nv">A_Index</span><span class="p">,</span> <span class="mi">1</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ; ensure ID is present in _ACTIONS array </span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">actionID</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">action_id_to_delete</span> <span class="o">==</span> <span class="n">actionID</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="kr">LV_Delete</span><span class="ss">(</span> <span class="nv">A_Index</span> <span class="ss">)</span>
               
               <span class="n">p1</span> <span class="o">:=</span> <span class="s">&quot;action&quot;</span>
               <span class="n">p2</span> <span class="o">:=</span> <span class="s">&quot;delete&quot;</span>
               <span class="n">p3</span> <span class="o">:=</span> <span class="n">action_id_to_delete</span>
               <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Savefile</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span> <span class="ss">)</span>
               
               <span class="k">break</span>
            <span class="p">}</span></DETAILS>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>


<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_Change_to_Settings_Tab</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
   
      <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Commands|Actions|Settings||   ?   &quot;</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="n">Choose</span><span class="p">,</span> <span class="n">GuiConfigMain_Tabs</span><span class="p">,</span> <span class="mi">3</span>
      
      <span class="k">return</span> 
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_Settings_SetIcon</span><span class="ss">(</span> <span class="n">icon_id</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> <span class="vc">_ICON_INDEX</span>
   
      <span class="n">setting</span> <span class="o">:=</span> <span class="p">{</span><span class="s">&quot;setting_name&quot;</span><span class="o">:</span><span class="s">&quot;icon&quot;</span><span class="p">,</span> <span class="s">&quot;new_value&quot;</span><span class="o">:</span><span class="n">icon_id</span><span class="p">}</span>
      
      <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Savefile</span><span class="ss">(</span>  <span class="s">&quot;setting&quot;</span>
                           <span class="p">,</span> <span class="s">&quot;edit&quot;</span>
                           <span class="p">,</span> <span class="n">NA_actionCommand</span> <span class="o">:=</span><span class="s">&quot;&quot;</span>
                           <span class="p">,</span> <span class="n">NA_commandName</span>   <span class="o">:=</span><span class="s">&quot;&quot;</span>
                           <span class="p">,</span> <span class="n">setting</span> <span class="ss">)</span>
      <span class="vc">_ICON_INDEX</span> <span class="o">:=</span> <span class="n">icon_id</span> 
      
      <span class="kr">Menu</span><span class="p">,</span> <span class="n">Tray</span><span class="p">,</span> <span class="n">Icon</span><span class="p">,</span> <span class="n">Shell32</span><span class="o">.</span><span class="n">dll</span><span class="p">,</span> <span class="vi">%_ICON_INDEX%</span>
      
      <span class="k">gosub</span> <span class="n">ReloadConfigurationWindow</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Fn_AboutTab_Get_Text</span><span class="ss">(</span><span class="n">g_width</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      <span class="mi">12</span><span class="n">spaces</span> <span class="o">:=</span> <span class="s">&quot;           &quot;</span>
      <span class="mi">3</span><span class="n">nl</span>      <span class="o">:=</span> <span class="s">&quot;</span><span class="se">`n`n`n</span><span class="s">&quot;</span>
      <span class="mi">2</span><span class="n">nl</span>      <span class="o">:=</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="mi">1</span><span class="n">nl</span>      <span class="o">:=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
      
      <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="n">g_width</span> 
      <span class="ow">and</span> <span class="n">g_width</span> <span class="o">&lt;</span> <span class="mi">585</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="mi">12</span><span class="n">spaces</span> <span class="o">:=</span> <span class="s">&quot;    &quot;</span>
      <span class="p">}</span></DETAILS>
      
      
      
         <span class="n">text</span>  <span class="o">:=</span>  <span class="s">&quot;&quot;</span>
         <span class="n">text</span>   <span class="o">.=</span> <span class="mi">12</span><span class="n">spaces</span>   
         <span class="n">text</span>   <span class="o">.=</span> <span class="mi">12</span><span class="n">spaces</span> <span class="s">&quot;   gamepad-coder.github.io &quot;</span>
         <span class="n">text</span>   <span class="o">.=</span>    <span class="mi">3</span><span class="n">nl</span>
         <span class="n">text</span>   <span class="o">.=</span> <span class="mi">12</span><span class="n">spaces</span>  <span class="s">&quot;===========================&quot;</span> <span class="mi">12</span><span class="n">spaces</span>
         <span class="n">text</span>   <span class="o">.=</span>    <span class="mi">2</span><span class="n">nl</span>
         <span class="n">text</span>   <span class="o">.=</span> <span class="mi">12</span><span class="n">spaces</span>  <span class="s">&quot;   _program_launcher.ahk&quot;</span>
         <span class="n">text</span>   <span class="o">.=</span>    <span class="mi">2</span><span class="n">nl</span>
         <span class="n">text</span>   <span class="o">.=</span> <span class="mi">12</span><span class="n">spaces</span>  <span class="s">&quot;===========================&quot;</span>
         <span class="n">text</span>   <span class="o">.=</span>    <span class="mi">2</span><span class="n">nl</span>
         <span class="n">text</span>   <span class="o">.=</span> <span class="mi">12</span><span class="n">spaces</span>  <span class="s">&quot;License:&quot;</span>
         <span class="n">text</span>   <span class="o">.=</span>    <span class="mi">1</span><span class="n">nl</span>
         <span class="n">text</span>   <span class="o">.=</span> <span class="mi">12</span><span class="n">spaces</span>  <span class="s">&quot;Community Commons Zero&quot;</span>
         <span class="n">text</span>   <span class="o">.=</span>    <span class="mi">2</span><span class="n">nl</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; msgBOX text is `n%text%</span>
      
      <span class="k">return</span> <span class="n">text</span>
   <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">   ;============================================================</span>
<span class="c1">   ;         end of class:</span>
<span class="c1">   ;         GuiConfigMain (Main Window)  </span>
<span class="c1">   ;============================================================</span>
<span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_0"><SUMMARY><span class="k">class</span> <span class="n">GuiConfigIconPicker</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>

<span class="c1">   ;-----------------------------------------------------</span>
<span class="c1">   ; Preload &quot;ImageList&quot; of system icons upon app start </span>
<span class="c1">   ; to prevent lag when this window is launched</span>
<span class="c1">   ; (stored in _LV_IconList).</span>
<span class="c1">   ;-----------------------------------------------------</span>
   
   <span class="nb">static</span> <span class="vc">_LV_IconList</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> ; Used across multiple window instances.</span>
   <span class="nb">static</span> <span class="vc">_icon_chosen</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> ; Unique per window instance</span>
   

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nn">__New</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
      
      <span class="n">options_for_Popup</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;+Label&quot;</span> <span class="s">&quot;GuiConfigIconPicker.GUI_EVENT_On&quot;</span>
      <span class="n">options_for_Popup</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Resize&quot;</span>
      <span class="n">options_for_Popup</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+MinSize300x475&quot;</span>
      
      <span class="n">title_for_Popup_Window</span> <span class="o">:=</span> <span class="s">&quot;Select Icon for Program Launcher :&quot;</span>
        
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">IconConfig</span><span class="o">:</span><span class="n">New</span>
         <span class="p">,</span> <span class="vi">%options_for_Popup%</span> 
         <span class="p">,</span>   <span class="vi">%title_for_Popup_Window%</span><span class="c1"></span>


<span class="c1">      ; Preload fn should be run during config window launch to (potentially) reduce lag.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="vc">_LV_IconList</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="nf">Preload_IconList</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS>
      
      <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="nf">Init_AddControls</span><span class="ss">()</span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;--------------------------------------------------------------;</span>
<span class="c1">      ; Temporarily disable GuiConfigMain while this popup exists.   ;</span>
<span class="c1">      ;--------------------------------------------------------------; </span></SUMMARY>
<span class="c1">      ;                                                              ;</span>
<span class="c1">      ; GuiConfigIconPicker will be a child window of GuiConfigMain, ;</span>
<span class="c1">      ; which will prevent GuiConfigMain                             ;</span>
<span class="c1">      ; from displaying on top of this popup.                        ;</span>
<span class="c1">      ;--------------------------------------------------------------; </span></DETAILS>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">IconConfig</span><span class="o">:+</span><span class="n">OwnerConfigMain</span>
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">IconConfig</span><span class="o">:</span> <span class="n">Show</span>
      
      <span class="kr">Gui</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="o">+</span><span class="n">Disabled</span>

      <span class="k">return</span> <span class="nn">this</span>
      
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nn">__Delete</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">   </span>
<span class="c1">      ;---------------------------------------</span>
<span class="c1">      ; Clear static class member variable </span>
<span class="c1">      ;---------------------------------------</span>
      
      <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="vc">_icon_chosen</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------------------</span>
<span class="c1">      ; Re-enable GuiConfigMain, </span>
<span class="c1">      ; now that GuiConfigIconPicker no longer needs prioritized focus.</span>
<span class="c1">      ;-----------------------------------------------------------------</span>
      
      <span class="kr">Gui</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="o">-</span><span class="n">Disabled</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------</span>
<span class="c1">      ; Destroy GuiConfigIconPicker Window</span>
<span class="c1">      ;------------------------------------</span>
      
      <span class="kr">Gui</span> <span class="n">IconConfig</span><span class="o">:</span> <span class="n">Destroy</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
      
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Preload_IconList</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;----------------------------------------------------------</span>
<span class="c1">      ; Source:</span>
<span class="c1">      ;    &quot;TreeView Large Icons - Is it possible?&quot;</span>
<span class="c1">      ;   https://www.autohotkey.com/boards/viewtopic.php?t=65043</span>
<span class="c1">      ;----------------------------------------------------------</span>
      
      <span class="n">option_use_large_images</span> <span class="o">:=</span> <span class="nv">true</span>
      <span class="n">ImageListID_large</span> <span class="o">:=</span> <span class="kr">IL_Create</span><span class="ss">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">,</span> <span class="n">option_use_large_images</span><span class="ss">)</span><span class="c1"> </span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------------------</span>
<span class="c1">      ; Load the ImageList with system icons.</span>
<span class="c1">      ;--------------------------------------------</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="n">Loop</span> <span class="mi">329</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">IL_Add</span><span class="ss">(</span><span class="n">ImageListID_large</span><span class="p">,</span> <span class="s">&quot;shell32.dll&quot;</span><span class="p">,</span> <span class="nv">A_Index</span><span class="ss">)</span>
      <span class="p">}</span></DETAILS>
      
      <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="vc">_LV_IconList</span> <span class="o">:=</span> <span class="n">ImageListID_large</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_AddControls</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
   
        <span class="n">text</span>  <span class="o">:=</span> <span class="s">&quot;Use Selected Icon&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigIconPicker.GUI_EVENT_Button&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Default&quot;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">IconConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span> <span class="vi">%text%</span>
      
        <span class="n">text</span>  <span class="o">:=</span>  <span class="s">&quot;Use Selected Icon&quot;</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span>    <span class="s">&quot;GuiConfigIconPicker.GUI_EVENT_TreeView&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>    <span class="s">&quot;GuiConfigIconPicker_TreeView&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;hwnd&quot;</span> <span class="s">&quot;HwndIconPickerTreeView&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;ImageList&quot;</span> <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="vc">_LV_IconList</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">IconConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">TreeView</span>
         <span class="p">,</span> <span class="vi">%options%</span>

      <span class="n">select_this_one</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
      <span class="kr">TV_Delete</span><span class="ss">()</span>
      <span class="n">parent_id</span> <span class="o">:=</span> <span class="mi">0</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="n">Loop</span> <span class="mi">329</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">tv_id</span> <span class="o">:=</span> <span class="kr">TV_Add</span><span class="ss">(</span><span class="s">&quot;Icon &quot;</span> <span class="nv">A_Index</span><span class="p">,</span> <span class="vi">%parent_id%</span><span class="p">,</span> <span class="s">&quot;Icon&quot;</span> <span class="nv">A_Index</span><span class="ss">)</span> 
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">A_Index</span> <span class="o">==</span> <span class="vc">_ICON_INDEX</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">select_this_one</span> <span class="o">:=</span> <span class="n">tv_id</span> 
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">select_this_one</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">TV_Modify</span><span class="ss">(</span> <span class="n">select_this_one</span> <span class="ss">)</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>      
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnEscape</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
      <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="nf">GUI_EVENT_OnClose</span><span class="ss">()</span>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnClose</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;------------------------------------------------------;</span>
<span class="c1">      ; Call the Destructor method for class GuiConfigPopup. ;</span>
<span class="c1">      ;------------------------------------------------------; </span></SUMMARY>
<span class="c1">      ;                                                      ;</span>
<span class="c1">      ; GuiConfigPopup.__Delete() will:                      ;</span>
<span class="c1">      ;                                                      ;</span>
<span class="c1">      ; - push or revert changes                             ;</span>
<span class="c1">      ; - restore control to GuiConfigMain                   ;</span>
<span class="c1">      ; - delete and free any vars this object is using      ;</span>
<span class="c1">      ; - destroy the popup GUI                              ;</span>
<span class="c1">      ;------------------------------------------------------; </span></DETAILS>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------------------</span>
<span class="c1">      ; AutoHotkey Info </span>
<span class="c1">      ;-----------------------------------------------------------------</span>
<span class="c1">      ; obj := &quot;&quot; </span>
<span class="c1">      ;   Calls the object&#39;s __Delete() class destrutor </span>
<span class="c1">      ;   if this is the last variable referencing the object instance </span>
<span class="c1">      ;   (in this case, it is).</span>
<span class="c1">      ;-----------------------------------------------------------------</span>
      
      <span class="vc">_o_Gui_Config_IconPicker</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="k">return</span>
      
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnSize</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> <span class="n">HwndIconPickerTreeView</span>
   
      <span class="n">control_padding</span> <span class="o">:=</span> <span class="mi">10</span>
      
      <span class="n">op_w</span> <span class="o">:=</span> <span class="nv">A_GuiWidth</span>
      <span class="n">op_h</span> <span class="o">:=</span> <span class="nv">A_GuiHeight</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;; padding, probably</span>
      <span class="n">op_w</span> <span class="o">:=</span> <span class="n">op_w</span> <span class="o">-</span><span class="ss">(</span><span class="mi">2</span><span class="o">*</span><span class="n">control_padding</span> <span class="ss">)</span>
      <span class="n">op_h</span> <span class="o">:=</span> <span class="n">op_h</span> <span class="o">-</span><span class="ss">(</span><span class="mi">2</span><span class="o">*</span><span class="n">control_padding</span> <span class="ss">)</span> <span class="o">-</span> <span class="mi">20</span>
      
      <span class="n">op_x</span> <span class="o">:=</span> <span class="n">control_padding</span>
      <span class="n">op_y</span> <span class="o">:=</span> <span class="n">control_padding</span> <span class="o">+</span> <span class="mi">20</span>
      
      <span class="n">c1</span> <span class="o">:=</span> <span class="n">HwndIconPickerTreeView</span>
      <span class="n">options_movedraw</span> <span class="o">:=</span> <span class="s">&quot;H&quot;</span> <span class="o">.</span> <span class="n">op_h</span> <span class="o">.</span> <span class="s">&quot; &quot;</span> <span class="o">.</span> <span class="s">&quot;W&quot;</span> <span class="o">.</span> <span class="n">op_w</span> <span class="o">.</span> <span class="s">&quot; &quot;</span>
      <span class="n">options_movedraw</span> <span class="o">.=</span> <span class="s">&quot;X&quot;</span> <span class="o">.</span> <span class="n">op_x</span> <span class="o">.</span> <span class="s">&quot; &quot;</span> <span class="o">.</span> <span class="s">&quot;Y&quot;</span> <span class="o">.</span> <span class="n">op_y</span>
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">MoveDraw</span><span class="p">,</span> <span class="vi">%c1%</span><span class="p">,</span> <span class="o">%</span> <span class="n">options_movedraw</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_Button</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
      <span class="n">icon_id</span> <span class="o">:=</span> <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="vc">_icon_chosen</span>
      <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="nf">SubmitIcon</span><span class="ss">(</span> <span class="n">icon_id</span> <span class="ss">)</span>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_TreeView</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;---------------------------------------------------------------</span>
<span class="c1">      ; If event triggered because user double-clicked </span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span> <span class="ss">(</span> <span class="s">&quot;DoubleClick&quot;</span> <span class="o">=</span> <span class="nv">A_GuiEvent</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;------------------------------------------------------------</span>
<span class="c1">         ; Extract the icon number from selected TreeView Item&#39;s text.</span>
<span class="c1">         ;</span>
         <span class="n">icon_id</span> <span class="o">:=</span> <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="nf">Get_IconID_From_TreeViewID</span><span class="ss">(</span> <span class="nv">A_EventInfo</span> <span class="ss">)</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;---------------------------------------</span>
<span class="c1">         ; Submit icon choice upon double-click</span>
<span class="c1">         ;</span>
         <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="nf">SubmitIcon</span><span class="ss">(</span> <span class="n">icon_id</span> <span class="ss">)</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      ;---------------------------------------------------------------</span>
<span class="c1">      ; If event triggered because of TreeView item selection changed </span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span> <span class="ss">(</span> <span class="s">&quot;S&quot;</span> <span class="o">==</span> <span class="nv">A_GuiEvent</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;------------------------------------------------------------</span>
<span class="c1">         ; Extract the icon number from selected TreeView Item&#39;s text.</span>
<span class="c1">         ;</span>
         <span class="n">icon_id</span> <span class="o">:=</span> <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="nf">Get_IconID_From_TreeViewID</span><span class="ss">(</span> <span class="nv">A_EventInfo</span> <span class="ss">)</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;--------------------------------------------------</span>
<span class="c1">         ; Store icon choice (referenced by submit button).</span>
<span class="c1">         ;</span>
         <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="vc">_icon_chosen</span> <span class="o">:=</span> <span class="n">icon_id</span>
         
      <span class="p">}</span></DETAILS>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">SubmitIcon</span><span class="ss">(</span> <span class="n">icon_id</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="n">icon_id</span> 
      <span class="ow">and</span>  <span class="mi">0</span> <span class="o">!=</span> <span class="n">icon_id</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;-----------------------------------------------------</span>
<span class="c1">         ; Tell main Gui to update settings to use this icon.</span>
<span class="c1">         ;</span>
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Fn_Settings_SetIcon</span><span class="ss">(</span> <span class="n">icon_id</span> <span class="ss">)</span><span class="c1"> </span>
<span class="c1">         </span>
<span class="c1">         ;---------------------------</span>
<span class="c1">         ; Close Icon Config Window.</span>
<span class="c1">         ;</span>
         <span class="n">GuiConfigIconPicker</span><span class="o">.</span><span class="nf">GUI_EVENT_OnClose</span><span class="ss">()</span>
         
      <span class="p">}</span></DETAILS>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Get_IconID_From_TreeViewID</span><span class="ss">(</span> <span class="n">TreeViewItemID</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------------------------</span>
<span class="c1">      ; TreeView IDs are not linear, </span>
<span class="c1">      ; so we know which TreeView Item was clicked or selected,</span>
<span class="c1">      ; but we don&#39;t know what its position is within the treeview.</span>
<span class="c1">      ;</span>
<span class="c1">      ; So we need to extract the Icon ID </span>
<span class="c1">      ; from the selected TreeView Item&#39;s text. </span>
<span class="c1">      ;------------------------------------------------------------</span>
      
      <span class="n">icon_id</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> </span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------------------</span>
<span class="c1">      ; First, we get the text of the selected TreeView Item </span>
<span class="c1">      ;</span>
      <span class="kr">TV_GetText</span><span class="ss">(</span><span class="n">tv_text</span><span class="p">,</span> <span class="nv">A_EventInfo</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------------------------------</span>
<span class="c1">      ; Next we remove the leading &quot;Icon &quot; to store </span>
<span class="c1">      ; only the trailing number at the end of the TreeView Item&#39;s text</span>
<span class="c1">      ;</span>
      <span class="n">icon_id</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="n">tv_text</span><span class="p">,</span> <span class="s">&quot;^Icon[ ]*&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="ss">)</span>
      
      
      <span class="k">return</span> <span class="n">icon_id</span>
   <span class="p">}</span></DETAILS>

<span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_0"><SUMMARY><span class="k">class</span> <span class="n">GuiConfigPopup</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>

   <span class="nb">static</span> <span class="vc">_popup_mode</span>    <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> ; either:   &quot;command&quot; or &quot;action&quot;</span>
   <span class="nb">static</span> <span class="vc">_popup_purpose</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> ; either:   &quot;add&quot;     or &quot;edit&quot;</span>
   
   <span class="nb">static</span> <span class="vc">_LV_RowData_FromMainGui</span> <span class="o">:=</span> <span class="p">{}</span>
   

   <span class="nb">static</span> <span class="vc">_isPathValid</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>   
   <span class="nb">static</span> <span class="vc">_LV_selected_action_id</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"> ; for Command </span>

<span class="c1">   </span>
<span class="c1">   ;-------------------------------------------------------------------------------</span>
<span class="c1">   ; storing all the different text branches for this submit button </span>
<span class="c1">   ; inside this associative array </span>
<span class="c1">   ;</span>
<span class="c1">   ; can access using : </span>
<span class="c1">   ; a := GuiConfigPopup.text[&quot;action_popup&quot;][&quot;add&quot;]</span>
<span class="c1">   ; b := GuiConfigPopup.text[&quot;command_popup&quot;][&quot;edit&quot;][&quot;tab2&quot;]</span>
<span class="c1">   ;</span>
   <span class="nb">static</span> <span class="n">text</span> <span class="o">:=</span> <span class="p">{</span>    <span class="s">&quot;&quot;</span> 
      <span class="o">.</span> <span class="s">&quot;action_popup&quot;</span>

         <span class="o">:</span><span class="p">{</span>  <span class="s">&quot;add&quot;</span>  <span class="o">:</span> <span class="s">&quot;Add NEW ACTION!&quot;</span> 
            <span class="p">,</span><span class="s">&quot;edit&quot;</span> <span class="o">:</span> <span class="s">&quot;Change this action!&quot;</span><span class="p">}</span>  
         
      <span class="p">,</span> <span class="s">&quot;command_popup&quot;</span>
      
         <span class="o">:</span><span class="p">{</span>  <span class="s">&quot;add&quot;</span>
               <span class="o">:</span><span class="p">{</span> <span class="s">&quot;tab1&quot;</span>
                  <span class="o">:</span>   <span class="s">&quot;Add NEW ACTION and </span><span class="se">`n</span><span class="s">&quot;</span> 
                    <span class="o">.</span> <span class="s">&quot;assign to NEW COMMAND! &quot;</span>
                 <span class="p">,</span><span class="s">&quot;tab2&quot;</span>
                  <span class="o">:</span>   <span class="s">&quot;Use Action[] and </span><span class="se">`n</span><span class="s">&quot;</span> 
                    <span class="o">.</span> <span class="s">&quot;assign to NEW COMMAND!&quot;</span><span class="p">}</span>
         
            <span class="p">,</span><span class="s">&quot;edit&quot;</span>
               <span class="o">:</span><span class="p">{</span> <span class="s">&quot;tab1&quot;</span>
                  <span class="o">:</span>   <span class="s">&quot;Add NEW ACTION and </span><span class="se">`n</span><span class="s">&quot;</span> 
                    <span class="o">.</span> <span class="s">&quot;   assign to this command!    &quot;</span>
                 <span class="p">,</span><span class="s">&quot;tab2&quot;</span>
                  <span class="o">:</span>   <span class="s">&quot;Use Action[] and </span><span class="se">`n</span><span class="s">&quot;</span> 
                    <span class="o">.</span> <span class="s">&quot;   assign to this command!    &quot;</span> <span class="p">}</span>    <span class="p">}</span> <span class="p">}</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">   </span>
<span class="c1">   ;[~]</span>
<span class="c1">   ;======================================================================================</span>
<span class="c1">   ;         This class, GuiConfigPopup, is a grouping of functionality for </span>
<span class="c1">   ;         the popup config windows (GUIS) generated for GuiConfigMain&#39;s first tab,</span>
<span class="c1">   ;         - &quot;Edit a Command&quot; or</span>
<span class="c1">   ;         - &quot;New Command&quot;</span>
<span class="c1">   ;         </span>
<span class="c1">   ;         Contained below is all the functionality needed</span>
<span class="c1">   ;         to process input &amp; respond to UI events, </span>
<span class="c1">   ;</span>
<span class="c1">   ;         and are grouped here primarily for organizational cleanliness.</span>
<span class="c1">   ;</span>
<span class="c1">   ;         To make this app simple to understand, </span>
<span class="c1">   ;         I initially tried to use labels exclusively instead of functions or classes.</span>
<span class="c1">   ;         However, </span>
<span class="c1">   ;         this led to a long long stream of labels with no clear visual oranization.</span>
<span class="c1">   ;         </span>
<span class="c1">   ;         </span>
<span class="c1">   ;======================================================================================</span>

<span class="c1">   </span>

<span class="c1">   ;====================================================;</span>
<span class="c1">   ; Creates the GUI to edit a command                  ;</span>
<span class="c1">   ;   When:                                            ;</span>
<span class="c1">   ;     - User double-clicks a Command or              ;</span>
<span class="c1">   ;     - User selects a Command and presses &lt;Enter&gt;   ;</span>
<span class="c1">   ;   in GuiConfigMain&#39;s Tab &quot;Commands&quot;                      ;</span>
<span class="c1">   ;====================================================;</span>
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nn">__New</span><span class="ss">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">purpose</span><span class="p">,</span> <span class="n">row_data_if_editing</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">silent</span><span class="o">:=</span><span class="nv">false</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
      
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span>              <span class="o">:=</span> <span class="n">mode</span> 
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_purpose</span>           <span class="o">:=</span> <span class="n">purpose</span>
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_RowData_FromMainGui</span>  <span class="o">:=</span> <span class="n">row_data_if_editing</span>
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* Syntax reference: </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">         </span>
<span class="cm">            row_dat[&quot;LV_id&quot;]               := selected_row</span>
<span class="cm">            row_dat[&quot;row_cmd&quot;]             := got_cmd</span>
<span class="cm">            row_dat[&quot;row_cmd_is_enabled&quot;]  := got_cmd_is_enabled</span>
<span class="cm">            row_dat[&quot;row_actionID&quot;]        := got_actionId</span>
<span class="cm">            row_dat[&quot;row_actionType&quot;]      := got_actionType</span>
<span class="cm">            row_dat[&quot;row_actionPath&quot;]      := got_actionPath</span>
<span class="cm">            row_dat[&quot;row_actionArg&quot;]       := got_actionArg</span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS>
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Initialize_Gui_gVariables</span><span class="ss">()</span>
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Init_Config_GuiWindow_Options</span><span class="ss">()</span>      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Init_AddControls_1</span><span class="ss">()</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Init_AddControls_2_Both_ConfigNewAction</span><span class="ss">()</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Init_AddControls_3_Cmd_SecondTab</span><span class="ss">()</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Init_AddControls_4_Both_SubmitButton</span><span class="ss">()</span>

      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;--------------------------------------------------------------------;</span>
<span class="c1">      ; Note:                                                              ;</span>
<span class="c1">      ;--------------------------------------------------------------------; </span></SUMMARY>
<span class="c1">      ;                                                                    ;</span>
<span class="c1">      ;   The name &quot;PopupConfig&quot; is arbitrarily used here                  ;</span>
<span class="c1">      ;   to tell commands like                                            ;</span>
<span class="c1">      ;                                                                    ;</span>
<span class="c1">      ;     - &quot;Gui, ArbitraryGuiName:Add, ..&quot; and                          ;</span>
<span class="c1">      ;     - &quot;GuiControl, ArbitraryGuiName: %stringSubCommand%            ;</span>
<span class="c1">      ;       , ArbitraryControlName, %someVar%&quot;                           ;</span>
<span class="c1">      ;                                                                    ;</span>
<span class="c1">      ;   which GUI they should specifically operate upon.                 ;</span>
<span class="c1">      ;                                                                    ;</span>
<span class="c1">      ;   This &quot;PopupConfig&quot; just a name, not a variable                   ;</span>
<span class="c1">      ;   and should not be confused with:                                 ;</span>
<span class="c1">      ;                                                                    ;</span>
<span class="c1">      ;     - &quot;GuiConfigPopup&quot;,                                            ;</span>
<span class="c1">      ;        which is the class organizing all these functions together  ;</span>
<span class="c1">      ;                                                                    ;</span>
<span class="c1">      ;     - nor with &quot;_o_Gui_Config_Popup&quot;,                              ;</span>
<span class="c1">      ;       which is an instatiated object of the class &quot;GuiConfigPopup&quot;.;</span>
<span class="c1">      ;                                                                    ;</span>
<span class="c1">      ;--------------------------------------------------------------------; </span></DETAILS>
<span class="c1">      </span>
<span class="c1">      ;==========================================================;</span>
<span class="c1">      ; Render + Display GuiConfigPopup&#39;s GUI window             ;</span>
<span class="c1">      ;==========================================================;</span>
<span class="c1">      </span>
<span class="c1">      ;----------------------------------------------------------;</span>
<span class="c1">      ; Temporarily disable GuiConfigMain while                  ;</span>
<span class="c1">      ; this popup exists (so the ListView order                 ;</span>
<span class="c1">      ; cannot be changed/rearranged while editing)              ;</span>
<span class="c1">      ;                                                          ;</span>
<span class="c1">      ; GuiConfigPopup will be a child window of GuiConfigMain,  ;</span>
<span class="c1">      ; which will prevent GuiConfigMain                         ;</span>
<span class="c1">      ; from displaying on top of this popup.                    ;</span>
<span class="c1">      ;==========================================================;</span>

      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:+</span><span class="n">OwnerConfigMain</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">false</span> <span class="o">==</span> <span class="n">silent</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="n">Show</span>
         
         <span class="kr">Gui</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="o">+</span><span class="n">Disabled</span>
      
      <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">      </span>
<span class="c1">      ;---------------------------------------------------------------</span>
<span class="c1">      ; Manual call to OnSize() with this flag:</span>
<span class="c1">      ;    Initializes the functions static variables which </span>
<span class="c1">      ;    store previous window width and height between Event calls.</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_EVENT_OnSize</span><span class="ss">(</span><span class="s">&quot;Gui up and running&quot;</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;----------------------------------</span>
<span class="c1">      ; Fine tuning of Control Widths </span>
<span class="c1">      ; and </span>
<span class="c1">      ; initializes the label reporting </span>
<span class="c1">      ; whether the file path is valid</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Init_Config_Controls_After_Render</span><span class="ss">()</span>
      
      
      <span class="k">return</span> <span class="nn">this</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nn">__Delete</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">      </span>
<span class="c1">      ; If PopupCommand successfully edited a command, this will be ignored.</span>
<span class="c1">      ; If PopupCommand was cancelled by User, then this will restore the command.</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Restore_Plucked_Action_If_User_Cancelled</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Restore_Plucked_Command_If_User_Cancelled</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------------------------</span>
<span class="c1">      ; Clear instance class member vars </span>
<span class="c1">      ;</span>
<span class="c1">      ;  (used for storing gui&#39;s recent size &amp; comparing </span>
<span class="c1">      ;  to current w+h upon gui window &quot;OnSize()&quot; event)</span>
<span class="c1">      ;--------------------------------------------------</span>
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span>    <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_purpose</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_EVENT_OnSize</span><span class="ss">(</span><span class="s">&quot;RESET&quot;</span><span class="ss">)</span>
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_isPathValid</span>                 <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_selected_action_id</span>       <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">            </span>
<span class="c1">      ;---------------------------------------------------</span>
<span class="c1">      ; Readjust main GUI&#39;s ListView columns for Commands </span>
<span class="c1">      ;---------------------------------------------------</span>
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_ReadjustAllCols</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------------------------------</span>
<span class="c1">      ; Re-enable GuiConfigMain, </span>
<span class="c1">      ; now that GuiConfigPopup no longer needs prioritized focus.</span>
<span class="c1">      ;--------------------------------------------------------</span>
      
      <span class="kr">Gui</span> <span class="n">ConfigMain</span><span class="o">:</span> <span class="o">-</span><span class="n">Disabled</span>
      <span class="kr">Gui</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="n">Destroy</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Initialize_Gui_gVariables</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>   
      
      <span class="n">GuiConfigPopup_Cmd_InputCommandName</span>          <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigPopup_Cmd_Tabs</span>                      <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1">      ; see footnote[1]</span>
      <span class="n">GuiConfigPopup_Cmd_Tab2_ListViewActions</span>      <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">GuiConfigPopup_ActionConfig_TextDragAndDrop</span>  <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigPopup_ActionConfig_RadioFolder</span>      <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigPopup_ActionConfig_RadioApp</span>         <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigPopup_ActionConfig_InputPath</span>        <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigPopup_ActionConfig_LabelVerified</span>    <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">GuiConfigPopup_ButtonSubmit</span>                  <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;-------------------------------------------------------------------------</span>
<span class="c1">      ; footnote[1]</span>
<span class="c1">      ;-------------------------------------------------------------------------</span>
<span class="c1">      ; GuiConfigPopup_Cmd_Tabs</span>
<span class="c1">      ;------------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">      ; Used for dynamically changing the submit button for Add|Edit Command.</span>
<span class="c1">      ; If not cleared here, it will persist between popups, </span>
<span class="c1">      ; and exiting an &quot;Edit Command&quot; popup on the 2nd tab </span>
<span class="c1">      ; would glitch future &quot;Add Command&quot; or &quot;Edit Command&quot; popups</span>
<span class="c1">      ;   (causing the text for the second tab&#39;s submit button </span>
<span class="c1">      ;   to display incorrectly on the 1st tab)</span>
<span class="c1">      ; when they open (by default) to the 1st tab.</span>
<span class="c1">      ;</span>
<span class="c1">      ; Hence it&#39;s a good practice to clear global variables </span>
<span class="c1">      ; for GUIs which are created multiple times over the lifespan of a script.</span>
<span class="c1">      ;------------------------------------------------------------------------- </span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Config_GuiWindow_Options</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;========================================================</span>
<span class="c1">      ; Configure a GUI popup to [Add|Edit] a [Command|Action]</span>
<span class="c1">      ;========================================================</span>
      
         <span class="n">minsize</span> <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span> 
                     <span class="o">?</span> <span class="s">&quot;+MinSize340x567&quot;</span> 
                     <span class="o">:</span> <span class="s">&quot;+MinSize275x425&quot;</span>
                     
         <span class="n">options_for_Popup</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;+Label&quot;</span> <span class="s">&quot;GuiConfigPopup.GUI_EVENT_On&quot;</span>
         <span class="n">options_for_Popup</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Resize&quot;</span>
         <span class="n">options_for_Popup</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="n">minsize</span>
         
         <span class="n">title_mode</span>    <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span> 
                        <span class="o">?</span> <span class="s">&quot;COMMAND&quot;</span> 
                        <span class="o">:</span> <span class="s">&quot;ACTION&quot;</span>
         <span class="n">title_purpose</span> <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;add&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_purpose</span><span class="ss">)</span>
                        <span class="o">?</span> <span class="s">&quot;add new!&quot;</span>
                        <span class="o">:</span> <span class="s">&quot;edit...&quot;</span>
         
         <span class="n">title_for_Popup_Window</span> <span class="o">:=</span> <span class="n">title_mode</span> <span class="s">&quot;  -  &quot;</span> <span class="n">title_purpose</span>
           
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">New</span>
            <span class="p">,</span> <span class="vi">%options_for_Popup%</span> 
            <span class="p">,</span>   <span class="vi">%title_for_Popup_Window%</span>
            
      <span class="k">return</span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;----------------------------------------------------------------------</span>
<span class="c1">      ; AutoHotkey Info : Ternary Operator</span>
<span class="c1">      ;---------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">      ; myVar := (ifThisEvalsToTrue) ? thenAssignThis : otherwiseAssignThis</span>
<span class="c1">      ;----------------------------------------------------------------------</span>
<span class="c1">      ; https://www.autohotkey.com/docs/Variables.htm#ternary</span>
<span class="c1">      ;---------------------------------------------------------------------- </span></DETAILS>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_AddControls_1</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;=======================================================;</span>
<span class="c1">      ; These Controls:                                       ;</span>
<span class="c1">      ;=======================================================;</span>
<span class="c1">      ;   - `Text` Label &quot;Command:&quot; for input field           ;</span>
<span class="c1">      ;   - `Edit` Input field for Command                    ;</span>
<span class="c1">      ;   - `Tab3` Tab container for action selection         ;</span>
<span class="c1">      ;      to assign to Command                             ;</span>
<span class="c1">      ;                                                       ;</span>
<span class="c1">      ;=======================================================;</span>
<span class="c1">      ; are only present for these Popups:                    ;</span>
<span class="c1">      ;=======================================================;</span>
<span class="c1">      ;   - Command Add                              </span>
<span class="c1">      ;   - Command Edit                             </span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;===================================</span>
<span class="c1">         ; Add `Text` labled &quot;Command:&quot; and  </span>
<span class="c1">         ; Add `Edit` user input for Command </span>
<span class="c1">         ;===================================</span>

<span class="c1">            ;-----------------------------------------</span>
<span class="c1">            ; Label &quot;Command:&quot; before user input field </span>
<span class="c1">            ;-----------------------------------------</span>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;add&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Type the text for your new Command :&quot;</span>
            <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span><span class="s">&quot;edit&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Command :&quot;</span>
            <span class="p">}</span></DETAILS>
            
            <span class="n">options</span> <span class="o">:=</span> <span class="s">&quot;y+15 cBlue&quot;</span>
            
            <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span>
               <span class="p">,</span> <span class="vi">%options%</span>
               <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ;--------------------------------------</span>
<span class="c1">            ; User input field </span>
<span class="c1">            ;--------------------------------------</span>
<span class="c1">            </span>
<span class="c1">               ;-----------------------------------------</span>
<span class="c1">               ; If editing a command, </span>
<span class="c1">               ;   then this `Edit` Control uses </span>
<span class="c1">               ;   var LV Row&#39;s command as initial text</span>
<span class="c1">               ;</span>
               <span class="n">text</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_RowData_FromMainGui</span><span class="p">[</span><span class="s">&quot;row_cmd&quot;</span><span class="p">]</span>
            <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigPopup_Cmd_InputCommandName&quot;</span>
            <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;-Multi -WantTab&quot;</span>
            <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;w500&quot;</span>
            <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+10&quot;</span>
            
            
            <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="kr">Edit</span>
               <span class="p">,</span> <span class="vi">%options%</span>
               <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>

<span class="c1">            ;------------------------------------------</span>
<span class="c1">            ; Label &quot;Choose the Action it will trigger&quot; </span>
<span class="c1">            ; after Command input area</span>
<span class="c1">            ; just before Tab container for Actions</span>
<span class="c1">            ;------------------------------------------</span>
            
               <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Choose the Action it will trigger :&quot;</span> 
            <span class="n">options</span> <span class="o">:=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+20 cBlue&quot;</span>
            <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span>
               <span class="p">,</span> <span class="vi">%options%</span>
               <span class="p">,</span> <span class="vi">%text%</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">         ;================================</span>
<span class="c1">         ; Add Tab Container with 2 tabs</span>
<span class="c1">         ; - Add New Action</span>
<span class="c1">         ; - Use Existing Action</span>
<span class="c1">         ;================================</span>

               <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Add New Action|Use Existing Action&quot;</span>
            <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigPopup_Cmd_Tabs&quot;</span>
            <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigPopup.GUI_EVENT_Cmd_TabChanged&quot;</span>
            <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;w500&quot;</span>
            <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+10&quot;</span><span class="c1"></span>
<span class="c1">               </span>
<span class="c1">               </span>
<span class="c1">            ; Gui, PopupConfig:Add, Tab3, w600 h500 vGuiConfigPopup_Cmd_Tabs</span>
            <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Tab3</span>
               <span class="p">,</span> <span class="vi">%options%</span>
               <span class="p">,</span>    <span class="vi">%text%</span>
         
      <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">      ;===============================================================;</span>
<span class="c1">      ; This &quot;Text&quot; Control labeled &quot;Create/Configure Action:&quot;        ;</span>
<span class="c1">      ; is only present for these Popups:                             ;</span>
<span class="c1">      ;===============================================================;</span>
<span class="c1">      ;   - Action Add</span>
<span class="c1">      ;   - Action Edit</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span><span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
         <span class="n">row_actionID</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_RowData_FromMainGui</span><span class="p">[</span><span class="s">&quot;row_actionID&quot;</span><span class="p">]</span>
         
            <span class="n">text</span> <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;add&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_purpose</span><span class="ss">)</span>
                   <span class="o">?</span> <span class="s">&quot;Create a new Action :&quot;</span>
                   <span class="o">:</span> <span class="s">&quot;Configure Action[&quot;</span> <span class="n">row_actionID</span> <span class="s">&quot;] :&quot;</span>
                   
         <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;cBlue&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+15&quot;</span>
         
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span>
            <span class="p">,</span> <span class="vi">%options%</span>
            <span class="p">,</span> <span class="vi">%text%</span>
      <span class="p">}</span></DETAILS>
      <span class="k">return</span>
      
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_AddControls_2_Both_ConfigNewAction</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;=========================================================================;</span>
<span class="c1">      ; The following Controls:                                                 ;</span>
<span class="c1">      ;   - `Text` Control informing about &quot;Drag-n-Drop&quot;                        ;</span>
<span class="c1">      ;   - `Radio` Control choice between &quot;Open Folder&quot; or &quot;Open Application&quot;  ;</span>
<span class="c1">      ;   - series of Controls to choose Action&#39;s Path (to folder or app)       ;</span>
<span class="c1">      ;=========================================================================;</span>
<span class="c1">      ; are present for all Popups:                                             ;</span>
<span class="c1">      ;=========================================================================;</span>
<span class="c1">      ;   - Action Add                                                          ;</span>
<span class="c1">      ;   - Action Edit                                                         ;</span>
<span class="c1">      ;   - Command Add                                                         ;</span>
<span class="c1">      ;   - Command Edit                                                        ;</span>
<span class="c1">      ;=========================================================================;</span>
      
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">        ;----------------------------TAB SWITCH----------------------------</span>
<span class="c1">        ;</span>
<span class="c1">        ; `Tab` present for Command Add &amp; Command Edit.</span>
<span class="c1">        ;</span>
<span class="c1">        ; GuiConfigPopup&#39;s </span>
<span class="c1">        ; 1st Tab will receive Gui Controls added after the following line:</span>

         <span class="kr">Gui</span><span class="p">,</span> <span class="kp">Tab</span><span class="p">,</span> <span class="mi">1</span><span class="c1">      </span>

<span class="c1">        ;</span>
<span class="c1">        ;----------------------------TAB SWITCH----------------------------</span>
        
      <span class="p">}</span></DETAILS><span class="c1"></span>

<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;=========================================</span>
<span class="c1">      ; Add `Text` Label:</span>
<span class="c1">      ;-----------------------------------------</span>
<span class="c1">      ; Inform User Drag-n-Drop is possible here</span>
<span class="c1">      ;=========================================</span>

            <span class="n">text</span> <span class="o">:=</span>  <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;Note:</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;   You can drag and drop a single file or folder   </span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;onto of any portion of this window</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;to populate the fields below.&quot;</span>
            <span class="n">text</span>  <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
         
         <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_TextDragAndDrop&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;Border Center&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+20&quot;</span>
            
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span>
            <span class="p">,</span> <span class="vi">%options%</span>
            <span class="p">,</span> <span class="vi">%text%</span><span class="c1"> </span>



<span class="c1">      ;===============================</span>
<span class="c1">      ; Add `Radio` choice: </span>
<span class="c1">      ;    () Open Folder</span>
<span class="c1">      ;    () Open Application</span>
<span class="c1">      ;===============================</span>

<span class="c1">         ;-----------------------------------------</span>
<span class="c1">         ; Display &quot;Type:&quot; before radio choice </span>
<span class="c1">         ;-----------------------------------------</span>
         
            <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Action Type :&quot;</span>
         <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;y+20&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;cTeal&quot;</span>
            
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span>
            <span class="p">,</span><span class="vi">%options%</span>
            <span class="p">,</span> <span class="vi">%text%</span>

         <span class="n">row_actionType</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_RowData_FromMainGui</span><span class="p">[</span><span class="s">&quot;row_actionType&quot;</span><span class="p">]</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;-----------------------------------------</span>
<span class="c1">         ; `Radio` choice: Open Folder</span>
<span class="c1">         ;-----------------------------------------</span>

            <span class="n">text</span>   <span class="o">:=</span> <span class="s">&quot;Open Folder&quot;</span> 
         <span class="n">options</span>   <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigPopup.GUI_EVENT_ActionConfig_RadioChanged&quot;</span> 
         <span class="n">options</span>    <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigPopup_ActionConfig_RadioFolder&quot;</span><span class="c1"> </span>
<span class="c1">         ; options    .= A_Space &quot;y+15&quot; </span>
         <span class="n">options</span>    <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+10&quot;</span> 
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;folder&quot;</span> <span class="o">=</span> <span class="n">row_actionType</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">options</span>   <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Checked&quot;</span> 
         <span class="p">}</span></DETAILS>
         
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Radio</span>
            <span class="p">,</span> <span class="vi">%options%</span>
            <span class="p">,</span> <span class="vi">%text%</span><span class="c1"></span>

<span class="c1">         ;-----------------------------------------</span>
<span class="c1">         ; `Radio` choice: Open Application</span>
<span class="c1">         ;-----------------------------------------</span>

            <span class="n">text</span>      <span class="o">:=</span> <span class="s">&quot;Open Application&quot;</span> 
         <span class="n">options</span>      <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigPopup.GUI_EVENT_ActionConfig_RadioChanged&quot;</span> 
         <span class="n">options</span>       <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span>           <span class="s">&quot;GuiConfigPopup_ActionConfig_RadioApp&quot;</span> 
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;app&quot;</span> <span class="o">=</span> <span class="n">row_actionType</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">options</span>   <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Checked&quot;</span> 
         <span class="p">}</span></DETAILS>
         
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Radio</span>
            <span class="p">,</span> <span class="vi">%options%</span>
            <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>



<span class="c1">      ;================================================================</span>
<span class="c1">      ; Add Controls to Configure Action&#39;s Path </span>
<span class="c1">      ;----------------------------------------------------------------</span>
<span class="c1">      ;   - `Text`   : Display &quot;Path&quot; </span>
<span class="c1">      ;   - `Button` : Open file or folder picker</span>
<span class="c1">      ;   - `Edit`   : Input field for path (to Folder or Application)</span>
<span class="c1">      ;   - `Text`   : Display &quot;(valid folder)&quot; or &quot;(valid path)&quot;</span>
<span class="c1">      ;================================================================</span>

            <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Path :&quot;</span><span class="c1"></span>
<span class="c1">         ; options :=  A_Space &quot;y+30&quot;</span>
         <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;y+20&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;cTeal&quot;</span>
         
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span>
            <span class="p">,</span> <span class="vi">%options%</span>
            <span class="p">,</span>    <span class="vi">%text%</span>
         
         
            <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Browse&quot;</span>
         <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigPopup.GUI_EVENT_ActionConfig_BrowseButton&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;-Default&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;section&quot;</span><span class="c1"></span>
<span class="c1">         ; options  .= A_Space &quot;y+15&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+10&quot;</span>
         
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
            <span class="p">,</span> <span class="vi">%options%</span>
            <span class="p">,</span>    <span class="vi">%text%</span>


            <span class="n">text</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_RowData_FromMainGui</span><span class="p">[</span><span class="s">&quot;row_actionPath&quot;</span><span class="p">]</span>
         <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigPopup.GUI_EVENT_ActionConfig_InputPath&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_InputPath&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;-Multi -WantTab&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;ys w400&quot;</span>

         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="kr">Edit</span>
            <span class="p">,</span> <span class="vi">%options%</span>
            <span class="p">,</span>    <span class="vi">%text%</span><span class="c1"></span>

<span class="c1">            ;--------------------------------------------------</span>
<span class="c1">            ; The &quot;(valid folder)&quot; &quot;(valid file)&quot; label </span>
<span class="c1">            ;  will be dynamically populated every time </span>
<span class="c1">            ;  the path is checked for an existing file/folder.</span>
<span class="c1">            ; </span>
            <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
         <span class="n">options</span> <span class="o">:=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_LabelVerified&quot;</span>
         <span class="n">options</span> <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;w120&quot;</span>
         
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span>
            <span class="p">,</span> <span class="vi">%options%</span><span class="c1"></span>


<span class="c1">      ;================================================================</span>
<span class="c1">      ; Add Controls to Configure Action&#39;s Arguments if App </span>
<span class="c1">      ;----------------------------------------------------------------</span>
<span class="c1">      ;   - `Text`   : Display &quot;Arguments&quot; </span>
<span class="c1">      ;   - `Edit`   : Input field for Arguments to call App with</span>
<span class="c1">      ;================================================================</span>

            <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;Arguments :&quot;</span>
         <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_LabelArguments1&quot;</span><span class="c1"></span>
<span class="c1">         ; options  .= A_Space &quot;y+30&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+17&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;xs&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;cTeal&quot;</span>
         
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span>
            <span class="p">,</span> <span class="vi">%options%</span>
            <span class="p">,</span>    <span class="vi">%text%</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;app&quot;</span> <span class="o">=</span> <span class="n">row_actionType</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">text</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_RowData_FromMainGui</span><span class="p">[</span><span class="s">&quot;row_actionArg&quot;</span><span class="p">]</span>
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ; options :=  A_Space &quot;g&quot; &quot;GuiConfigPopup.GUI_EVENT_ActionConfig_Arguments&quot;</span>
         <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_InputArguments&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;-Multi -WantTab&quot;</span><span class="c1"></span>
<span class="c1">         ; options  .= A_Space &quot;ys w390&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;w457&quot;</span>

         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="kr">Edit</span>
            <span class="p">,</span> <span class="vi">%options%</span>
            <span class="p">,</span>    <span class="vi">%text%</span>
            
            
      
            <span class="n">text</span> <span class="o">:=</span> <span class="s">&quot;  ( Optional: for advanced use. See tutorial in Savefile. )  &quot;</span> 
         <span class="n">options</span> <span class="o">:=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_LabelArguments2&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;section&quot;</span><span class="c1"></span>
<span class="c1">         ; options  .= A_Space &quot;+Border&quot;</span>
         <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;h30&quot;</span><span class="c1"></span>
<span class="c1">         ; options  .= A_Space &quot;cTeal&quot;</span>
         
            
         <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span>
            <span class="p">,</span> <span class="vi">%options%</span>
            <span class="p">,</span>    <span class="vi">%text%</span>
            
      <span class="k">return</span> 
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_AddControls_3_Cmd_SecondTab</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;========================================================;</span>
<span class="c1">      ; This `ListView` displaying all current Actions         ;</span>
<span class="c1">      ; is only present in these Popups:                       ;</span>
<span class="c1">      ;========================================================;</span>
<span class="c1">      ;   - Command Add </span>
<span class="c1">      ;   - Command Edit </span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">        ;----------------------------TAB SWITCH----------------------------</span>
<span class="c1">        ;</span>
<span class="c1">        ; `Tab` present for Command Add &amp; Command Edit.</span>
<span class="c1">        ;</span>
<span class="c1">        ; GuiConfigPopup&#39;s </span>
<span class="c1">        ; 2nd Tab will receive Gui Controls added after the following line:</span>

         <span class="kr">Gui</span><span class="p">,</span> <span class="kp">Tab</span><span class="p">,</span> <span class="mi">2</span><span class="c1">   </span>

<span class="c1">        ;</span>
<span class="c1">        ;----------------------------TAB SWITCH----------------------------</span>
<span class="c1">        </span>
<span class="c1">      </span>
<span class="c1">         ;==========================================</span>
<span class="c1">         ; Add `ListView` to choose existing Action </span>
<span class="c1">         ;==========================================</span>

         
         <span class="n">gui_name</span>     <span class="o">:=</span> <span class="s">&quot;PopupConfig&quot;</span>
         <span class="n">goto_name</span>    <span class="o">:=</span> <span class="s">&quot;GuiConfigPopup.GUI_EVENT_Cmd_Tab2_ListViewActions&quot;</span>
         <span class="n">control_name</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigPopup_Cmd_Tab2_ListViewActions&quot;</span>
         <span class="n">REUSABLE_GUI_CONTROLS</span><span class="o">.</span><span class="nf">create_listview_of_actions</span><span class="ss">(</span> <span class="n">gui_name</span>
            <span class="p">,</span> <span class="n">goto_name</span>
            <span class="p">,</span> <span class="n">control_name</span> <span class="ss">)</span>
         
         <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
         <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
         <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">3</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
         <span class="kr">LV_ModifyCol</span><span class="ss">(</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;AutoHdr&quot;</span><span class="ss">)</span>
         
      <span class="p">}</span></DETAILS>

      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_AddControls_4_Both_SubmitButton</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">        ;----------------------------TAB SWITCH----------------------------</span>
<span class="c1">        ;</span>
<span class="c1">        ; `Tab` present for Command Add &amp; Command Edit only.</span>
<span class="c1">        ;</span>
<span class="c1">        ; GuiConfigPopup will place Gui Controls added after </span>
<span class="c1">        ; the following line below the Tab Container:</span>

         <span class="kr">Gui</span><span class="p">,</span> <span class="kp">Tab</span><span class="p">,</span><span class="c1"></span>

<span class="c1">        ;</span>
<span class="c1">        ;----------------------------TAB SWITCH----------------------------</span>
      
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;=========================================================================;</span>
<span class="c1">      ; The `Button` Control named GuiConfigPopup_ButtonSubmit                  ;</span>
<span class="c1">      ; is present for all Popups:                                              ;</span>
<span class="c1">      ;=========================================================================;</span>
<span class="c1">      ;   - Action Add                                                          ;</span>
<span class="c1">      ;   - Action Edit                                                         ;</span>
<span class="c1">      ;   - Command Add                                                         ;</span>
<span class="c1">      ;   - Command Edit                                                        ;</span>
<span class="c1">      ;=========================================================================;</span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;---------------------------------------------------------------</span>
<span class="c1">      ;  About the Submit Button&#39;s Functionality</span>
<span class="c1">      ;--------------------------------------------------------------- </span></SUMMARY>
<span class="c1">      ; If all the options the user enters into the above Controls </span>
<span class="c1">      ; are valid paths &amp; non-duplicate Command names</span>
<span class="c1">      ; this button will either: </span>
<span class="c1">      ;</span>
<span class="c1">      ;   - Add a new Action or</span>
<span class="c1">      ;   - Automatically assign </span>
<span class="c1">      ;     a preexisting identical Action</span>
<span class="c1">      ;</span>
<span class="c1">      ; Then (for Commands)</span>
<span class="c1">      ;</span>
<span class="c1">      ;   1. This command:ID pair will be added</span>
<span class="c1">      ;      to internal _COMMANDS array as:</span>
<span class="c1">      ;      - a totally new entry, or</span>
<span class="c1">      ;      - a restored entry, or</span>
<span class="c1">      ;      - a modified entry).</span>
<span class="c1">      ;</span>
<span class="c1">      ;   2. The Command (in the first &quot;Edit&quot; input box)</span>
<span class="c1">      ;      can now be used to trigger this Action.</span>
<span class="c1">      ;</span>
<span class="c1">      ;   3. Then this &quot;GuiConfigPopup&quot; Gui will close.</span>
<span class="c1">      ;</span>
<span class="c1">      ; Or Then (for Actions)</span>
<span class="c1">      ;</span>
<span class="c1">      ;   1. If edited, the updated Action will be added to _ACTIONS </span>
<span class="c1">      ;      and any Commands referencing that ID will now trigger it.</span>
<span class="c1">      ;</span>
<span class="c1">      ;   2. If added, the new Action will be added to _ACTIONS </span>
<span class="c1">      ;      but it will need to be assigned to a Command </span>
<span class="c1">      ;      before it can be triggered.</span>
<span class="c1">      ;</span>
<span class="c1">      ;--------------------------------------------------------------- </span></DETAILS>

<span class="c1">      ;==========================================</span>
<span class="c1">      ; Add `Button` to Submit Command or Action </span>
<span class="c1">      ;==========================================</span>
      
         <span class="n">text</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">get_submit_button_text</span><span class="ss">()</span>
      <span class="n">options</span> <span class="o">:=</span>  <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;GuiConfigPopup.GUI_EVENT_ButtonSubmit&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="s">&quot;GuiConfigPopup_ButtonSubmit&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+Default&quot;</span>
      <span class="n">options</span>  <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;y+20 xm&quot;</span>
         
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Button</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span>


      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Init_Config_Controls_After_Render</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;==================================================</span>
<span class="c1">      ; stretch the info label&#39;s width </span>
<span class="c1">      ;==================================================</span>
<span class="c1">      ; </span>
<span class="c1">      ;  present in all Popups:                       </span>
<span class="c1">      ;</span>
<span class="c1">      ;   - Action  Add </span>
<span class="c1">      ;   - Action  Edit </span>
<span class="c1">      ;   - Command Add </span>
<span class="c1">      ;   - Command Edit </span>
<span class="c1">      ;----------------------------</span>
      
      <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_TextDragAndDrop&quot;</span>
      <span class="n">w</span> <span class="o">:=</span> <span class="mi">470</span> 
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">w</span> <span class="o">:=</span> <span class="n">w</span> <span class="o">-</span> <span class="mi">15</span>
      <span class="p">}</span></DETAILS>
      
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="n">MoveDraw</span><span class="p">,</span> <span class="vi">%c%</span><span class="p">,</span> <span class="n">w</span><span class="vi">%w%</span><span class="c1"> </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;==================================================</span>
<span class="c1">      ; stretch ListView on any Command Popup&#39;s 2nd Tab</span>
<span class="c1">      ;==================================================</span>
<span class="c1">      ; </span>
<span class="c1">      ;  present in Popups:                       </span>
<span class="c1">      ;</span>
<span class="c1">      ;   - Command Add </span>
<span class="c1">      ;   - Command Edit </span>
<span class="c1">      ;----------------------------</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigPopup_Cmd_Tab2_ListViewActions&quot;</span>
         <span class="n">w</span> <span class="o">:=</span> <span class="mi">470</span><span class="c1"> ; - 50</span>
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="n">MoveDraw</span><span class="p">,</span> <span class="vi">%c%</span><span class="p">,</span> <span class="n">w</span><span class="vi">%w%</span> 
         
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;====================================================</span>
<span class="c1">      ; If the action&#39;s path is okay, </span>
<span class="c1">      ; make the GuiConfigPopup_ActionConfig_LabelVerified</span>
<span class="c1">      ; control display the text &quot;(Valid)&quot; </span>
<span class="c1">      ;====================================================</span>
<span class="c1">      ;</span>
<span class="c1">      ;  present in all Popups:                       </span>
<span class="c1">      ;</span>
<span class="c1">      ;   - Action  Add </span>
<span class="c1">      ;   - Action  Edit </span>
<span class="c1">      ;   - Command Add </span>
<span class="c1">      ;   - Command Edit </span>
<span class="c1">      ;----------------------------</span>
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_FN_LabelPathVerified_CheckAndRefresh</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------------------------------------------------</span>
<span class="c1">      ; When a folder is the Action type, </span>
<span class="c1">      ; don&#39;t display the fields to input Arguments for opening an executable.</span>
<span class="c1">      ;-------------------------------------------------------------------------</span>
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_FN_ToggleArgumentsIfNotApp</span><span class="ss">()</span>
      
      <span class="k">return</span> 
   <span class="p">}</span></DETAILS>





<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnSize</span><span class="ss">(</span><span class="n">FLAG</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;=================================</span>
<span class="c1">      ; Adjust Size of </span>
<span class="c1">      ;</span>
<span class="c1">      ; Tab box </span>
<span class="c1">      ; Input Box: Command Name </span>
<span class="c1">      ; Input Box: Action Path </span>
<span class="c1">      ; Label: About Drag and Drop</span>
<span class="c1">      ;=================================</span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;------------------------------------------------------------</span>
<span class="c1">      ; OnSize() will be called once when the Gui is rendered</span>
<span class="c1">      ;------------------------------------------------------------ </span></SUMMARY>
<span class="c1">      ; </span>
<span class="c1">      ; Every time this function is called automatically due </span>
<span class="c1">      ;  to an AutoHotkey event triggering OnSize(), </span>
<span class="c1">      ;  this function&#39;s static vars will persistently remember  </span>
<span class="c1">      ;  the Gui&#39;s last size before a resize event.</span>
<span class="c1">      ;</span>
<span class="c1">      ; We&#39;ll ignore the resizing branch during the first call, </span>
<span class="c1">      ;  (a) because all the Controls are properly placed</span>
<span class="c1">      ;  (b) because the user hasn&#39;t resized the window yet.</span>
<span class="c1">      ;</span>
<span class="c1">      ;</span>
<span class="c1">      ; Then all subsequent calls will get the &quot;delta&quot; height value </span>
<span class="c1">      ;  (representing the amount of change in height)</span>
<span class="c1">      ;  comparing the current size to the previous size.</span>
<span class="c1">      ;</span>
<span class="c1">      ; This is especially useful to easily calculate y-coordinates</span>
<span class="c1">      ; but with rapid calls, sometimes AutoHotkey can&#39;t keep up </span>
<span class="c1">      ; and a bit of deviations in consistency will appear.</span>
<span class="c1">      ;</span>
<span class="c1">      ; When possible, it&#39;s better to use absolute positionings </span>
<span class="c1">      ;  and offsets, but this delta method works well enough</span>
<span class="c1">      ;  considering its ease.</span>
<span class="c1">      ;</span>
<span class="c1">      ; Shout-out to AutoXYWH:</span>
<span class="c1">      ;  https://www.autohotkey.com/boards/viewtopic.php?f=6&amp;t=1079</span>
<span class="c1">      ;------------------------------------------------------------ </span></DETAILS>
      
      
      <span class="nb">static</span> <span class="n">previous_width</span>
      <span class="nb">static</span> <span class="n">previous_height</span>
      <span class="nb">static</span> <span class="n">is_baked</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">     ;******************************************************************************</span>
<span class="c1">     ;</span>
<span class="c1">     ;                     Manual Function Calls with Flags</span>
<span class="c1">     ;</span>
<span class="c1">     ;******************************************************************************</span>
<span class="c1">      </span>
<span class="c1">      ;==========================================</span>
<span class="c1">      ; Initialize static vars &amp; control offsets</span>
<span class="c1">      ;==========================================</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;Gui up and running&quot;</span> <span class="o">==</span> <span class="n">FLAG</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">is_baked</span> <span class="o">:=</span> <span class="nv">true</span>
         <span class="k">return</span><span class="c1"> ; A_GuiWidth isn&#39;t populated when OnSize() is called manually.</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;RESET&quot;</span> <span class="o">==</span> <span class="n">FLAG</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">is_baked</span> <span class="o">:=</span> <span class="nv">false</span>
         <span class="k">return</span><span class="c1"> ; in process of calling __Delete() for this popup gui instance.</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">     ;******************************************************************************</span>
<span class="c1">     ;</span>
<span class="c1">     ;                    AutoHotkey Event calls to OnSize()</span>
<span class="c1">     ;</span>
<span class="c1">     ;******************************************************************************</span>
     
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">true</span> <span class="o">==</span>  <span class="n">is_baked</span> <span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="n">ar_ctrls</span> <span class="o">:=</span> <span class="p">[</span> <span class="s">&quot;GuiConfigPopup_Cmd_InputCommandName&quot;</span>
                  <span class="p">,</span> <span class="s">&quot;GuiConfigPopup_Cmd_Tabs&quot;</span>
                  <span class="p">,</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_InputPath&quot;</span> 
                  <span class="p">,</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_TextDragAndDrop&quot;</span> 
                  <span class="p">,</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_InputArguments&quot;</span> 
                  <span class="p">,</span> <span class="s">&quot;GuiConfigPopup_Cmd_Tab2_ListViewActions&quot;</span> 
                  <span class="p">,</span> <span class="s">&quot;GuiConfigPopup_ButtonSubmit&quot;</span> <span class="p">]</span>
      
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ar_ctrls</span>
         <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
<DETAILS class="leading_tabs_4"><SUMMARY><span class="c1">;------------------------------------------------------------</span>
<span class="c1">            ; Note on algorithm, past and present.</span>
<span class="c1">            ;------------------------------------------------------------ </span></SUMMARY>
<span class="c1">            ; I replaced my previous implementation using:</span>
<span class="c1">            ;</span>
<span class="c1">            ;   delta_w := A_GuiWidth  - previous_width</span>
<span class="c1">            ;</span>
<span class="c1">            ; with the following offsets I found through </span>
<span class="c1">            ; trial-and-error.</span>
<span class="c1">            ;</span>
<span class="c1">            ; These seemingly arbitrary offsets </span>
<span class="c1">            ; take the Gui&#39;s Client Area&#39;s Width (A_GuiWidth)</span>
<span class="c1">            ; and subtract the margins </span>
<span class="c1">            ; and (where applicable) the tab container&#39;s offset.</span>
<span class="c1">            ;</span>
<span class="c1">            ;------------------------------------------------------------</span>
<span class="c1">            ; Gui&#39;s Client Area:</span>
<span class="c1">            ;   The window&#39;s area available to control placement.</span>
<span class="c1">            ; </span>
<span class="c1">            ;   the Y coordinates start below the title bar</span>
<span class="c1">            ;    and (if applicable) menu bar.      </span>
<span class="c1">            ;   The X coordinates start to to the right </span>
<span class="c1">            ;    of the leftmost window style borders (if they exist).</span>
<span class="c1">            ;------------------------------------------------------------</span>
<span class="c1">            ; AutoHotkey Docs:</span>
<span class="c1">            ;   https://www.autohotkey.com/docs/commands/Gui.htm#GuiSize</span>
<span class="c1">            ;   https://www.autohotkey.com/docs/Variables.htm#GuiWidth</span>
<span class="c1">            ;------------------------------------------------------------ </span></DETAILS>
<span class="c1">            </span>
<span class="c1">            </span>
<span class="c1">            ;========================================================</span>
<span class="c1">            ; Stretch the width of these Controls </span>
<span class="c1">            ; by taking the overall width and subtracting the margins</span>
<span class="c1">            ;========================================================</span>
            
            <span class="n">w</span> <span class="o">:=</span> <span class="nv">A_GuiWidth</span> <span class="o">-</span> <span class="mi">20</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_TextDragAndDrop&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">               </span>
<span class="c1">               ;---------------------------------------------</span>
<span class="c1">               ; This layout is reused in:</span>
<span class="c1">               ;   All Command Popups [Add or Edit] on Tab 1</span>
<span class="c1">               ;   All Action Popups  [Add or Edit]</span>
<span class="c1">               ;</span>
<span class="c1">               ; However, the Actions layout </span>
<span class="c1">               ; is not embedded inside a Tab container,</span>
<span class="c1">               ; so the offsets will differ.</span>
<span class="c1">               ;---------------------------------------------</span>
               
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">w</span> <span class="o">:=</span> <span class="n">w</span> <span class="o">-</span> <span class="mi">2</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">w</span> <span class="o">:=</span> <span class="n">w</span> <span class="o">-</span> <span class="mi">30</span>
               <span class="p">}</span></DETAILS>
            <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_InputPath&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">               </span>
<span class="c1">               ;---------------------</span>
<span class="c1">               ;   Same as above </span>
<span class="c1">               ;---------------------</span>
               
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">w</span> <span class="o">:=</span> <span class="n">w</span> <span class="o">-</span> <span class="mi">57</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">w</span> <span class="o">:=</span> <span class="n">w</span> <span class="o">-</span> <span class="mi">100</span>
               <span class="p">}</span></DETAILS>
            <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_InputArguments&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  ; w := w - 67</span>
                  <span class="n">w</span> <span class="o">:=</span> <span class="n">w</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  ; w := w - 110</span>
                  <span class="n">w</span> <span class="o">:=</span> <span class="n">w</span> <span class="o">-</span> <span class="mi">43</span>
               <span class="p">}</span></DETAILS>
               
            <span class="p">}</span></DETAILS>
<DETAILS class="leading_tabs_4"><SUMMARY><span class="c1">;========================================================</span>
<span class="c1">            ; Stretch the height for Tab container + ListViews</span>
<span class="c1">            ; Reposition y-coordinate for buttons.</span>
<span class="c1">            ;======================================================== </span></SUMMARY>
<span class="c1">            ; </span>
<span class="c1">            ; Most of the controls are only stretching their width, </span>
<span class="c1">            ; but some need to </span>
<span class="c1">            ;   - change their y-coordinate </span>
<span class="c1">            ;   - or stretch their height in addition to their width</span>
<span class="c1">            ;     (i.e. Tab Container and ListView)</span>
<span class="c1">            ;</span>
<span class="c1">            ; This branch will </span>
<span class="c1">            ;   - calculate these specific needs </span>
<span class="c1">            ;   - move the Control, </span>
<span class="c1">            ;   - then continue the for loop.</span>
<span class="c1">            ;======================================================== </span></DETAILS>
<span class="c1">            ;</span>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">else</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">               ;-----------------------------------------</span>
<span class="c1">               ; output: ctrl_X, ctrl_Y, ctrl_W, ctrl_H</span>
<span class="c1">               ;</span>
               <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">ctrl_</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="vi">%c%</span>
               <span class="n">delta_h</span> <span class="o">:=</span> <span class="nv">A_GuiHeight</span> <span class="o">-</span> <span class="n">previous_height</span>
               
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&quot;GuiConfigPopup_Cmd_Tabs&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">h</span> <span class="o">:=</span> <span class="n">delta_h</span> <span class="o">+</span> <span class="n">ctrl_H</span>
                  <span class="n">w</span> <span class="o">:=</span> <span class="nv">A_GuiWidth</span> <span class="o">-</span> <span class="mi">20</span> 
                  <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="n">MoveDraw</span><span class="p">,</span> <span class="vi">%c%</span><span class="p">,</span> <span class="n">w</span><span class="vi">%w%</span> <span class="n">h</span><span class="vi">%h%</span>
                  
                  <span class="k">continue</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&quot;GuiConfigPopup_Cmd_Tab2_ListViewActions&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">h</span> <span class="o">:=</span> <span class="n">delta_h</span> <span class="o">+</span> <span class="n">ctrl_H</span>
                  <span class="n">w</span> <span class="o">:=</span> <span class="nv">A_GuiWidth</span> <span class="o">-</span> <span class="mi">50</span>
                  <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="n">MoveDraw</span><span class="p">,</span> <span class="vi">%c%</span><span class="p">,</span> <span class="n">w</span><span class="vi">%w%</span> <span class="n">h</span><span class="vi">%h%</span>
                  
                  <span class="k">continue</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&quot;GuiConfigPopup_ButtonSubmit&quot;</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
                  <span class="n">y</span> <span class="o">:=</span> <span class="n">ctrl_Y</span> <span class="o">+</span> <span class="n">delta_h</span>
                  <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="n">MoveDraw</span><span class="p">,</span> <span class="vi">%c%</span><span class="p">,</span> <span class="n">y</span><span class="vi">%y%</span> 
                  
                  <span class="k">continue</span>
               <span class="p">}</span></DETAILS>
            <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ;========================================================</span>
<span class="c1">            ; For all controls which just need their width stretched </span>
<span class="c1">            ;========================================================</span>
<span class="c1">            </span>
<span class="c1">            ;-----------------------------------------</span>
<span class="c1">            ; output: ctrl_X, ctrl_Y, ctrl_W, ctrl_H</span>
<span class="c1">            ;</span>
            <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">ctrl_</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="vi">%c%</span>
            
            <span class="n">w</span> <span class="o">:=</span> <span class="ss">(</span><span class="n">w</span><span class="o">&gt;</span><span class="mi">150</span><span class="ss">)</span> <span class="o">?</span> <span class="n">w</span> <span class="o">:</span> <span class="n">ctrl_W</span>
            <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="n">MoveDraw</span><span class="p">,</span> <span class="vi">%c%</span><span class="p">,</span> <span class="n">w</span><span class="vi">%w%</span> 
            
            
         <span class="p">}</span></DETAILS>
         
         
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------------------</span>
<span class="c1">      ; These function-scoped static variables </span>
<span class="c1">      ; will remember their values between calls</span>
<span class="c1">      ;</span>
      <span class="n">previous_width</span> <span class="o">:=</span> <span class="nv">A_GuiWidth</span>
      <span class="n">previous_height</span> <span class="o">:=</span> <span class="nv">A_GuiHeight</span>
      
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnEscape</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="vc">_o_Gui_Config_Popup</span><span class="o">.</span><span class="nf">GUI_EVENT_OnClose</span><span class="ss">()</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnClose</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;------------------------------------------------------;</span>
<span class="c1">      ; Call the Destructor method for class GuiConfigPopup. ;</span>
<span class="c1">      ;------------------------------------------------------; </span></SUMMARY>
<span class="c1">      ;                                                      ;</span>
<span class="c1">      ; GuiConfigPopup.__Delete() will:                      ;</span>
<span class="c1">      ;                                                      ;</span>
<span class="c1">      ; - push or revert changes                             ;</span>
<span class="c1">      ; - restore control to GuiConfigMain                   ;</span>
<span class="c1">      ; - delete and free any vars this object is using      ;</span>
<span class="c1">      ; - destroy the popup GUI                              ;</span>
<span class="c1">      ;------------------------------------------------------; </span></DETAILS>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------------------</span>
<span class="c1">      ; AutoHotkey Info </span>
<span class="c1">      ;-----------------------------------------------------------------</span>
<span class="c1">      ; obj := &quot;&quot; </span>
<span class="c1">      ;   Calls the object&#39;s __Delete() class destrutor </span>
<span class="c1">      ;   if this is the last variable referencing the object instance </span>
<span class="c1">      ;   (in this case, it is).</span>
<span class="c1">      ;-----------------------------------------------------------------</span>
<span class="c1">      ;</span>
      <span class="vc">_o_Gui_Config_Popup</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_OnDropFiles</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;---------------------------------------------------------------------</span>
<span class="c1">      ; AutoHotkey Docs for GuiDropFiles</span>
<span class="c1">      ;--------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">      ; A_EventInfo and ErrorLevel:</span>
<span class="c1">      ;   Both contain the number of files dropped.</span>
<span class="c1">      ;---------------------------------------------------------------------</span>
<span class="c1">      ; A_GuiEvent:</span>
<span class="c1">      ;   Contains the names of the files that were dropped, </span>
<span class="c1">      ;   with each filename except the last terminated by a linefeed (`n).</span>
<span class="c1">      ;---------------------------------------------------------------------</span>
<span class="c1">      ; https://www.autohotkey.com/docs/commands/Gui.htm#GuiDropFiles</span>
<span class="c1">      ;--------------------------------------------------------------------- </span></DETAILS>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Submit</span><span class="p">,</span> <span class="n">NoHide</span> 
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span>
      <span class="ow">or</span>  <span class="s">&quot;Add New Action&quot;</span> <span class="o">==</span> <span class="n">GuiConfigPopup_Cmd_Tabs</span> <span class="ss">)</span>
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ;--------------------------------------------</span>
<span class="c1">         ; Populate GUI data with drag-n-dropped file.</span>
<span class="c1">         ;--------------------------------------------</span>
<span class="c1">         ; User dropped 1 file onto GuiConfigPopup GUI </span>
<span class="c1">         ;--------------------------------------------</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">A_EventInfo</span> <span class="o">==</span> <span class="mi">1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
            <span class="n">is_dragNdrop_valid</span> <span class="o">:=</span> <span class="kr">FileExist</span><span class="ss">(</span><span class="nv">A_GuiEvent</span><span class="ss">)</span>
      
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span>  <span class="n">is_dragNdrop_valid</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">InStr</span><span class="ss">(</span><span class="n">is_dragNdrop_valid</span><span class="p">,</span> <span class="s">&quot;D&quot;</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  ; populate as dir </span>
                  
                  <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_RadioFolder</span><span class="p">,</span> <span class="mi">1</span>
                  <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_RadioApp</span>   <span class="p">,</span> <span class="mi">0</span>
                  
                  <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_InputPath</span><span class="p">,</span> <span class="vi">%A_GuiEvent%</span>
               <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_5"><SUMMARY><span class="k">else</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">                  ; populate as file </span>
                  
                  <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_RadioFolder</span><span class="p">,</span> <span class="mi">0</span>
                  <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_RadioApp</span>   <span class="p">,</span> <span class="mi">1</span>
                  
                  <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_InputPath</span><span class="p">,</span> <span class="vi">%A_GuiEvent%</span>
               <span class="p">}</span></DETAILS>
            
            <span class="p">}</span></DETAILS>
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         ;----------------------------------------------------</span>
<span class="c1">         ; Unsupported.</span>
<span class="c1">         ;----------------------------------------------------</span>
<span class="c1">         ; User dropped more than 1 file onto GuiConfigPopup GUI </span>
<span class="c1">         ;----------------------------------------------------</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="nv">A_EventInfo</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">str_for_usr_output</span> <span class="o">:=</span> <span class="s">&quot;_program_launcher.ahk</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;--------------</span><span class="se">`n</span><span class="s">Oops</span><span class="se">`n</span><span class="s">--------------</span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">&quot;&quot;</span><span class="s">Edit a Command</span><span class="se">&quot;&quot;</span><span class="s"> can&#39;t process more than one file.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Ensure you only have one file selected </span><span class="se">`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;in Windows Explorer.</span><span class="se">`n`n</span><span class="s">&quot;</span>
            <span class="n">str_for_usr_output</span> <span class="o">.=</span> <span class="s">&quot;Then try to drag-and-drop it onto this window again.</span><span class="se">`n</span><span class="s">&quot;</span>
            
            <span class="kr">MsgBox</span><span class="p">,,</span> <span class="o">%</span> <span class="s">&quot;[X] Can&#39;t process more than one file for a path.&quot;</span><span class="p">,</span> <span class="vi">%str_for_usr_output%</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>





<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_Cmd_TabChanged</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_FN_ButtonSubmit_Refresh_Text</span><span class="ss">()</span>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ActionConfig_RadioChanged</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_FN_LabelPathVerified_CheckAndRefresh</span><span class="ss">()</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_FN_ToggleArgumentsIfNotApp</span><span class="ss">()</span>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ActionConfig_BrowseButton</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_FN_LabelPathVerified_CheckAndRefresh</span><span class="ss">()</span>
      
      <span class="n">is_folder_chosen</span> <span class="o">:=</span> <span class="n">GuiConfigPopup_ActionConfig_RadioFolder</span>
      <span class="n">is_app_chosen</span>    <span class="o">:=</span> <span class="n">GuiConfigPopup_ActionConfig_RadioApp</span>
      <span class="n">user_chose_path</span>  <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">row_actionPath</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_RowData_FromMainGui</span><span class="p">[</span><span class="s">&quot;row_actionPath&quot;</span><span class="p">]</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">is_folder_chosen</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">SplitPath</span><span class="p">,</span> <span class="n">row_actionPath</span><span class="p">,,</span> <span class="n">dir</span>
         <span class="kr">FileSelectFolder</span><span class="p">,</span> <span class="n">user_chose_path</span><span class="p">,</span> <span class="o">*</span><span class="vi">%dir%</span><span class="p">,,</span> <span class="n">Select</span> <span class="n">Folder</span> <span class="n">To</span> <span class="n">Open</span> <span class="n">With</span> <span class="n">Command</span>
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">is_app_chosen</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">FileSelectFile</span><span class="p">,</span> <span class="n">user_chose_path</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="vi">%row_actionPath%</span><span class="p">,</span> <span class="n">Select</span> <span class="n">Program</span> <span class="n">To</span> <span class="n">Open</span> <span class="n">With</span> <span class="n">Command</span>
      <span class="p">}</span></DETAILS>
      
      <span class="kr">GuiControl</span><span class="p">,,</span> <span class="n">GuiConfigPopup_ActionConfig_InputPath</span><span class="p">,</span> <span class="vi">%user_chose_path%</span>
      <span class="k">return</span> 
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ActionConfig_InputPath</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; Display (Valid Folder) or (Valid File) if it exists</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_FN_LabelPathVerified_CheckAndRefresh</span><span class="ss">()</span>      
      
      <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">pathSoFar</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="p">,</span> <span class="n">GuiConfigPopup_ActionConfig_InputPath</span>
      
      <span class="n">match_without_quotes</span> <span class="o">:=</span> <span class="s">&quot;^[</span><span class="se">&quot;&quot;</span><span class="s">]([^</span><span class="se">`n`r</span><span class="s">]*)[</span><span class="se">&quot;&quot;</span><span class="s">]$&quot;</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">RegExMatch</span><span class="ss">(</span><span class="n">pathSoFar</span><span class="p">,</span> <span class="n">match_without_quotes</span> <span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">path_without_quotes</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span> <span class="n">pathSoFar</span><span class="p">,</span> <span class="n">match_without_quotes</span><span class="p">,</span> <span class="s">&quot;$1&quot;</span> <span class="ss">)</span>
         
         <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="p">,</span> <span class="n">GuiConfigPopup_ActionConfig_InputPath</span><span class="p">,</span> <span class="vi">%path_without_quotes%</span><span class="c1"></span>
<span class="c1">         ; msgbox without quotes %path_without_quotes%</span>
      <span class="p">}</span></DETAILS>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ActionConfig_Arguments</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_Cmd_Tab2_ListViewActions</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_FN_Cmd_Tab2_ListView_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; msgbox A_EventInfo %A_EventInfo%</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span> <span class="ss">(</span> <span class="s">&quot;DoubleClick&quot;</span> <span class="o">=</span> <span class="nv">A_GuiEvent</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
      <span class="p">}</span></DETAILS>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span> <span class="ss">(</span> <span class="s">&quot;I&quot;</span> <span class="o">=</span> <span class="nv">A_GuiEvent</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;-------------------------------------------------------------</span>
<span class="c1">         ; If a row is selected, the if branch will be entered</span>
<span class="c1">         ; and the Action ID will be stored in this variable.</span>
<span class="c1">         ; </span>
<span class="c1">         ; If a row is deselected, then this variable will be cleared.</span>
<span class="c1">         ;</span>
<span class="c1">         ; Used for </span>
<span class="c1">         ;   - Submit Button text in Command Popup&#39;s &quot;Use Existing Action&quot; tab </span>
<span class="c1">         ;   - Submitting the Command Popup&#39;s input to GuiMain and _COMMANDS </span>
<span class="c1">         ;</span>
         <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_selected_action_id</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         
         <span class="n">is_a_selection_event</span> <span class="o">:=</span> <span class="kr">InStr</span><span class="ss">(</span><span class="nv">ErrorLevel</span><span class="p">,</span> <span class="s">&quot;S&quot;</span><span class="p">,</span> <span class="n">CaseSensitive</span><span class="o">:=</span><span class="nv">true</span><span class="ss">)</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">is_a_selection_event</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="kr">LV_GetText</span><span class="ss">(</span><span class="n">sel_act_id</span><span class="p">,</span> <span class="nv">A_EventInfo</span><span class="p">,</span><span class="mi">1</span><span class="ss">)</span>
            <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_selected_action_id</span> <span class="o">:=</span> <span class="n">sel_act_id</span><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ; debug := &quot;gui tab2 actions selected row[&quot; A_EventInfo &quot;]&quot;</span>
<span class="c1">            ; debug .= &quot; id[&quot; sel_act_id &quot;] is_sel[&quot; is_a_selection_event &quot;]&quot;</span>
<span class="c1">            ; debug .= &quot; er[%ErrorLevel%]&quot;</span>
<span class="c1">            ; msgbox, %debug% </span>
         <span class="p">}</span></DETAILS>
         <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_FN_ButtonSubmit_Refresh_Text</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_EVENT_ButtonSubmit</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes</span><span class="ss">()</span>      
   <span class="k">return</span>
   <span class="p">}</span></DETAILS>
      
         
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_FN_Cmd_Tab2_ListView_Activate</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"></span>

<span class="c1">      ;--------------------------------------------------------------------;</span>
<span class="c1">      ; This line ensures &quot;Gui, &quot; commands operate on the main GUI window  ;</span>
<span class="c1">      ;--------------------------------------------------------------------;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Default</span><span class="c1"></span>

<span class="c1">      ;---------------------------------------------------;</span>
<span class="c1">      ; This line ensures ListView commands &quot;LV_..()&quot;     ;</span>
<span class="c1">      ; operate on this specific ListView                 ;</span>
<span class="c1">      ;---------------------------------------------------;</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">ListView</span><span class="p">,</span> <span class="n">GuiConfigPopup_Cmd_Tab2_ListViewActions</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;----------------------------------------------------------------</span>
<span class="c1">      ; see:                                                          </span>
<span class="c1">      ; https://www.autohotkey.com/docs/commands/Gui.htm#MultiWin     </span>
<span class="c1">      ; https://www.autohotkey.com/docs/commands/Gui.htm#Default      </span>
<span class="c1">      ; https://www.autohotkey.com/docs/commands/ListView.htm#BuiltIn </span>
<span class="c1">      ;----------------------------------------------------------------</span>

      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_FN_ButtonSubmit_Refresh_Text</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Submit</span><span class="p">,</span> <span class="n">NoHide</span>
      
      <span class="n">button_text</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">get_submit_button_text</span><span class="ss">()</span>      
      <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigPopup_ButtonSubmit&quot;</span>            
      <span class="kr">GuiControl</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span> <span class="n">Text</span><span class="p">,</span> <span class="vi">%c%</span><span class="p">,</span> <span class="vi">%button_text%</span>
      
      <span class="k">return</span> 
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_FN_LabelPathVerified_CheckAndRefresh</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Submit</span><span class="p">,</span> <span class="n">NoHide</span>
      
      <span class="n">is_path_valid</span> <span class="o">:=</span> <span class="nv">false</span>
      <span class="n">string_for_valid_label</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_InputPath&quot;</span>
      <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">path</span><span class="p">,,</span> <span class="vi">%c%</span>
      
      <span class="n">is_valid_path</span> <span class="o">:=</span> <span class="kr">FileExist</span><span class="ss">(</span><span class="n">path</span><span class="ss">)</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span>  <span class="n">is_valid_path</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">GuiConfigPopup_ActionConfig_RadioFolder</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="kr">InStr</span><span class="ss">(</span><span class="n">is_valid_path</span><span class="p">,</span> <span class="s">&quot;D&quot;</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="n">string_for_valid_label</span> <span class="o">:=</span> <span class="s">&quot;(valid folder)&quot;</span>
               <span class="n">is_path_valid</span> <span class="o">:=</span> <span class="nv">true</span>
            <span class="p">}</span></DETAILS>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">GuiConfigPopup_ActionConfig_RadioApp</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="kr">InStr</span><span class="ss">(</span><span class="n">is_valid_path</span><span class="p">,</span> <span class="s">&quot;D&quot;</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
               <span class="n">string_for_valid_label</span> <span class="o">:=</span> <span class="s">&quot;(valid file)&quot;</span>
               <span class="n">is_path_valid</span> <span class="o">:=</span> <span class="nv">true</span>
            <span class="p">}</span></DETAILS>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; msgbox % string_for_valid_label</span>
      
      <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_LabelVerified&quot;</span>
      <span class="kr">GuiControl</span><span class="p">,,</span> <span class="vi">%c%</span><span class="p">,</span> <span class="vi">%string_for_valid_label%</span>
      
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_isPathValid</span> <span class="o">:=</span> <span class="n">is_path_valid</span>
      <span class="k">return</span> <span class="n">is_path_valid</span>
   <span class="p">}</span></DETAILS>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">GUI_FN_ToggleArgumentsIfNotApp</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Submit</span><span class="p">,</span> <span class="n">NoHide</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">GuiConfigPopup_ActionConfig_RadioApp</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="kr">GuiControl</span>
            <span class="nl">,PopupConfig: </span><span class="o">-</span><span class="n">Hidden</span>
            <span class="p">,</span><span class="n">GuiConfigPopup_ActionConfig_InputArguments</span>
            
         <span class="kr">GuiControl</span>
            <span class="nl">,PopupConfig: </span><span class="o">-</span><span class="n">Hidden</span>
            <span class="p">,</span><span class="n">GuiConfigPopup_ActionConfig_LabelArguments1</span>
            
         <span class="kr">GuiControl</span>
            <span class="nl">,PopupConfig: </span><span class="o">-</span><span class="n">Hidden</span>
            <span class="p">,</span><span class="n">GuiConfigPopup_ActionConfig_LabelArguments2</span>
         
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="c1"> ; if GuiConfigPopup_ActionConfig_RadioFolder OR if uninitialized _____SUMMARY_END_____</span>
      
         <span class="kr">GuiControl</span>
            <span class="nl">,PopupConfig: </span><span class="o">+</span><span class="n">Hidden</span>
            <span class="p">,</span><span class="n">GuiConfigPopup_ActionConfig_InputArguments</span>
            
         <span class="kr">GuiControl</span>
            <span class="nl">,PopupConfig: </span><span class="o">+</span><span class="n">Hidden</span>
            <span class="p">,</span><span class="n">GuiConfigPopup_ActionConfig_LabelArguments1</span>
            
         <span class="kr">GuiControl</span>
            <span class="nl">,PopupConfig: </span><span class="o">+</span><span class="n">Hidden</span>
            <span class="p">,</span><span class="n">GuiConfigPopup_ActionConfig_LabelArguments2</span>
      
      <span class="p">}</span></DETAILS>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">get_submit_button_text</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
      
      <span class="n">button_text</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;---------------------------------------------------------------------</span>
<span class="c1">      ; This &quot;tab_num&quot; var won&#39;t be used for Action New or Action Edit, </span>
<span class="c1">      ; so we don&#39;t need an if branch checking &quot;this._popup_mode&quot;</span>
<span class="c1">      ;--------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">      ;</span>
<span class="c1">      ; When this function get_submit_button_text() is called from __New(), </span>
<span class="c1">      ; the var &quot;GuiConfigPopup_Cmd_Tabs&quot; won&#39;t be populated yet, </span>
<span class="c1">      ; but we can safely default it to &quot;tab1&quot;.</span>
<span class="c1">      ;                                                                      </span></DETAILS>
      <span class="n">tab_num</span> <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;Use Existing Action&quot;</span> <span class="o">=</span> <span class="n">GuiConfigPopup_Cmd_Tabs</span><span class="ss">)</span> <span class="o">?</span> <span class="s">&quot;tab2&quot;</span> <span class="o">:</span> <span class="s">&quot;tab1&quot;</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------------------------------------</span>
<span class="c1">      ; The static class member var &quot;text&quot;</span>
<span class="c1">      ; is an associative array holding more associative arrays.</span>
<span class="c1">      ;</span>
<span class="c1">      ; It holds the text to display on the submit button </span>
<span class="c1">      ; using the kys of</span>
<span class="c1">      ;    - type of config popup </span>
<span class="c1">      ;    - purpose for popup (&quot;add&quot; or &quot;edit&quot;)</span>
<span class="c1">      ;    - (and for the Command popups, different text for each tab)</span>
<span class="c1">      ;</span>
      <span class="n">button_text</span> <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="nn">this</span><span class="o">.</span><span class="vc">_popup_mode</span><span class="ss">)</span><span class="c1"></span>
<span class="c1">         ;----------------------------</span>
<span class="c1">         ; if Command config popup</span>
         <span class="o">?</span> <span class="nn">this</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="s">&quot;command_popup&quot;</span><span class="p">][</span><span class="nn">this</span><span class="o">.</span><span class="vc">_popup_purpose</span><span class="p">][</span><span class="n">tab_num</span><span class="p">]</span><span class="c1"></span>
<span class="c1">         ;----------------------------</span>
<span class="c1">         ; else, Action config popup</span>
         <span class="o">:</span> <span class="nn">this</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="s">&quot;action_popup&quot;</span><span class="p">][</span><span class="nn">this</span><span class="o">.</span><span class="vc">_popup_purpose</span><span class="p">]</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;tab2&quot;</span> <span class="o">==</span> <span class="n">tab_num</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;------------------------------------------------------------</span>
<span class="c1">         ; _LV_selected_action_id, updated on ListView selection events</span>
<span class="c1">         ;</span>
         <span class="n">lv_item_actID</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_selected_action_id</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="n">lv_item_actID</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">            ;--------------------------------------------------------------------</span>
<span class="c1">            ; change &quot;Use Action[]&quot; to &quot;Use Action[123]&quot; on LV selection change</span>
<span class="c1">            ;</span>
            <span class="n">button_text</span> <span class="o">:=</span> <span class="kr">RegExReplace</span><span class="ss">(</span><span class="n">button_text</span><span class="p">,</span> <span class="s">&quot;^Use Action\[&quot;</span><span class="p">,</span> <span class="s">&quot;Use Action[&quot;</span> <span class="n">lv_item_actID</span><span class="ss">)</span>
            
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span> <span class="n">button_text</span>
   <span class="p">}</span></DETAILS>
   
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Submit_Changes</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
      <span class="kr">Gui</span><span class="p">,</span> <span class="n">PopupConfig</span><span class="o">:</span><span class="n">Submit</span><span class="p">,</span> <span class="n">NoHide</span>
      
      <span class="n">mode</span>    <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span>
      <span class="n">purpose</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_purpose</span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">         GuiConfigPopup.Submit_Changes()</span>
<span class="cm">         GuiConfigPopup.Submit_Changes_1_GatherVariables()</span>
<span class="cm">         GuiConfigPopup.Submit_Changes_2__VerifyActionVars()</span>
<span class="cm">         GuiConfigPopup.Submit_Changes_2__VerifyCommandVars()</span>
<span class="cm">         GuiConfigPopup.Submit_Changes_3___ActionSubmit()</span>
<span class="cm">         GuiConfigPopup.Submit_Changes_3___CommandSubmit()</span>
<span class="cm">         GuiConfigPopup.Submit_Changes_4____Finalize_And_Close()</span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS>
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes_1_GatherVariables</span><span class="ss">()</span>
      
      <span class="n">varsOK</span> <span class="o">:=</span> <span class="nv">false</span> 
      <span class="n">success</span> <span class="o">:=</span> <span class="nv">false</span> 
      
      <span class="k">if</span><span class="ss">(</span><span class="s">&quot;action&quot;</span>  <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span>
         <span class="n">varsOK</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes_2__VerifyActionVars</span><span class="ss">()</span>
         
      <span class="k">if</span><span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span>
         <span class="n">varsOK</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes_2__VerifyCommandVars</span><span class="ss">()</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">varsOK</span> <span class="o">==</span> <span class="s">&quot;User notified to try again.&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ; No errors, but Command name conflict.</span>
<span class="c1">         ; Cancel submit, keep popup open.</span>
<span class="c1">         ;</span>
         <span class="k">return</span> 
         
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">varsOK</span> <span class="o">==</span> <span class="nv">false</span> <span class="ss">)</span><span class="p">{</span><span class="c1"> ;then bug; _____SUMMARY_END_____</span>
      
         <span class="kr">msgbox</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="p">[</span> <span class="n">PROGRAM</span> <span class="n">ERROR</span> <span class="p">],</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">submit</span> <span class="n">changes</span> <span class="o">--</span> <span class="n">var</span> <span class="n">verify</span> <span class="n">failed</span><span class="o">.</span>
         <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes_DEBUG</span><span class="ss">()</span>
         <span class="k">return</span>
         
      <span class="p">}</span></DETAILS>
      
      <span class="k">if</span><span class="ss">(</span><span class="s">&quot;action&quot;</span>  <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span>
         <span class="n">success</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes_3___ActionSubmit</span><span class="ss">()</span>
         
      <span class="k">if</span><span class="ss">(</span><span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">mode</span><span class="ss">)</span>
         <span class="n">success</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes_3___CommandSubmit</span><span class="ss">()</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">success</span> <span class="o">==</span> <span class="s">&quot;notified user of conflict, no errors&quot;</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="k">return</span> 
      <span class="p">}</span></DETAILS>
      
      <span class="k">if</span><span class="ss">(</span> <span class="nv">true</span> <span class="o">==</span> <span class="n">success</span> <span class="ss">)</span>
         <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes_4____Finalize_And_Close</span><span class="ss">()</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">false</span> <span class="o">==</span> <span class="n">success</span> <span class="ss">)</span><span class="p">{</span><span class="c1"> ;then bug; _____SUMMARY_END_____</span>
         <span class="kr">msgbox</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="p">[</span> <span class="n">PROGRAM</span> <span class="n">ERROR</span> <span class="p">],</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">submit</span> <span class="n">changes</span><span class="o">.</span>
         <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes_DEBUG</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">         alternate if branches, different paths but same functionality in fewer lines:</span>
<span class="cm">       * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *</span>
<span class="cm">       </span>
<span class="cm">         if(&quot;action&quot;  == mode)</span>
<span class="cm">            if true =      GuiConfigPopup.Submit_Changes_2__VerifyActionVars()</span>
<span class="cm">               if true =  GuiConfigPopup.Submit_Changes_3___ActionSubmit()</span>
<span class="cm">                        GuiConfigPopup.Submit_Changes_4____Finalize_And_Close()</span>
<span class="cm">         </span>
<span class="cm">         if(&quot;command&quot; == mode)</span>
<span class="cm">            if true =      GuiConfigPopup.Submit_Changes_2__VerifyCommandVars()</span>
<span class="cm">               if true =  GuiConfigPopup.Submit_Changes_3___CommandSubmit()</span>
<span class="cm">                        GuiConfigPopup.Submit_Changes_4____Finalize_And_Close()</span>
<span class="cm">                        </span>
<span class="cm">       * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *</span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Submit_Changes_DEBUG</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>   
      <span class="n">mode</span>    <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span>
      <span class="n">purpose</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_purpose</span>
      
      <span class="n">debug_out</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span> 
      <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;mode&quot;</span>                           <span class="s">&quot;</span><span class="se">`n</span><span class="s">[&quot;</span>     <span class="n">mode</span>                         <span class="s">&quot;]</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;purpose&quot;</span>                        <span class="s">&quot;</span><span class="se">`n</span><span class="s">[&quot;</span>     <span class="n">purpose</span>                      <span class="s">&quot;]</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;A_input_newAction_type&quot;</span>         <span class="s">&quot;</span><span class="se">`n</span><span class="s">[&quot;</span>     <span class="n">A_input_newAction_type</span>       <span class="s">&quot;]</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;B_input_newAction_path&quot;</span>         <span class="s">&quot;</span><span class="se">`n</span><span class="s">[&quot;</span>     <span class="n">B_input_newAction_path</span>       <span class="s">&quot;]</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;C_input_newAction_arg &quot;</span>         <span class="s">&quot;</span><span class="se">`n</span><span class="s">[&quot;</span>     <span class="n">C_input_newAction_arg</span>        <span class="s">&quot;]</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;D_input_oldAction_id     &quot;</span>      <span class="s">&quot;</span><span class="se">`n</span><span class="s">[&quot;</span>     <span class="n">D_input_oldAction_id</span>         <span class="s">&quot;]</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;E_input_cmd_theCommand   &quot;</span>      <span class="s">&quot;</span><span class="se">`n</span><span class="s">[&quot;</span>     <span class="n">E_input_cmd_theCommand</span>       <span class="s">&quot;]</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;TAB_cmd_tab_is_new_action&quot;</span>      <span class="s">&quot;</span><span class="se">`n</span><span class="s">[&quot;</span>     <span class="n">TAB_cmd_tab_is_new_action</span>    <span class="s">&quot;]</span><span class="se">`n`n</span><span class="s">&quot;</span>
      <span class="n">debug_out</span> <span class="o">.=</span> <span class="s">&quot;F_insertion_point_for_mainLV&quot;</span>   <span class="s">&quot;</span><span class="se">`n</span><span class="s">[&quot;</span>     <span class="n">F_insertion_point_for_mainLV</span> <span class="s">&quot;]</span><span class="se">`n`n</span><span class="s">&quot;</span>
      
      <span class="kr">msgbox</span> <span class="o">%</span> <span class="n">debug_out</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Submit_Changes_1_GatherVariables</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="c1">;--------------------------------------------------------------------------------------</span>
<span class="c1">   ; Note on scope and globals</span>
<span class="c1">   ;-------------------------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">   ; ABCDEF_vars + TAB_var (in table below)  are all global </span>
<span class="c1">   ;</span>
<span class="c1">   ; and will be used in:</span>
<span class="c1">   ;   - Submit_Changes_2_Action()</span>
<span class="c1">   ;   - Submit_Changes_3_Command()</span>
<span class="c1">   ;</span>
<span class="c1">   ; The benefit of using single instance popups</span>
<span class="c1">   ; is we can safely use global variables instead of parameters.</span>
<span class="c1">   ;</span>
<span class="c1">   ; The only tradeoffs are : </span>
<span class="c1">   ;   - (1) We need to be sure: these vars are unique and not edited elsewhere. </span>
<span class="c1">   ;   - (2) We need to  ensure: these vars are reset between Popup __New() calls.</span>
<span class="c1">   ;   - (3) We cannot make multiple instances of these popups </span>
<span class="c1">   ;         without refactoring these globals into this._class_members.</span>
<span class="c1">   ;</span>
<span class="c1">   ; For the scope and function of this app, this design works fine.</span>
<span class="c1">   ;-------------------------------------------------------------------------------------- </span></DETAILS>
   
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">           ------------------------------------------------------------------------</span>
<span class="cm">                    Vars we need to be valid in order to submit:</span>
<span class="cm">           ------------------------------------------------------------------------</span>
<span class="cm">         </span>
<span class="cm">      ----------------------------------------------------------------------------------</span>
<span class="cm">       #      var to store per input              Overview of Each Popup &amp; Input Used</span>
<span class="cm">      ----------------------------------------------------------------------------------</span>
<span class="cm">                                  |                                </span>
<span class="cm">                                  |  Gui Popup: Action </span>
<span class="cm">                                  |  </span>
<span class="cm">                                  |    purpose: add</span>
<span class="cm">                                  |      [x] main.LV_selected_row</span>
<span class="cm">       A     input_newAction_type          |      [â] pop.newact.folder || pop.newact.app</span>
<span class="cm">       B     input_newAction_path          |      [â] pop.newact.path</span>
<span class="cm">       C     input_newAction_arg           |      [â] pop.newact.arg </span>
<span class="cm">                                  |           </span>
<span class="cm">                                  |    purpose: edit</span>
<span class="cm">       F     LV row data[&quot;LV_id&quot;]          |      [â] main.LV_selected_row</span>
<span class="cm">       A     input_newAction_type          |      [â] pop.newact.folder || pop.newact.app</span>
<span class="cm">       B     input_newAction_path          |      [â] pop.newact.path</span>
<span class="cm">       C     input_newAction_arg           |      [â] pop.newact.arg </span>
<span class="cm">       D     input_oldAction_id            |      [â] pop.oldact.id</span>
<span class="cm">                                  |  </span>
<span class="cm">                                  |  </span>
<span class="cm">                                  |  Gui Popup: Command </span>
<span class="cm">                                  |  </span>
<span class="cm">                                  |    purpose: add</span>
<span class="cm">                                  |  </span>
<span class="cm">                                  |      [x] main.LV_selected_row</span>
<span class="cm">       E     input_cmd_theCommand          |      [â] pop.cmd</span>
<span class="cm">                                  |  </span>
<span class="cm">       TAB   cmd_tab_is_new_action         |      if tab: add action</span>
<span class="cm">       A     input_newAction_type          |          [â] pop.newact.folder || pop.newact.app</span>
<span class="cm">       B     input_newAction_path          |          [â] pop.newact.path</span>
<span class="cm">       C     input_newAction_arg           |          [â] pop.newact.arg </span>
<span class="cm">                                  |  </span>
<span class="cm">       TAB   cmd_tab_is_new_action         |      if tab: use existing action</span>
<span class="cm">       D     input_oldAction_id            |          [â] pop.oldact.id</span>
<span class="cm">                                  |            </span>
<span class="cm">                                  |    purpose: edit</span>
<span class="cm">                                  |                                </span>
<span class="cm">       F     LV row data[&quot;LV_id&quot;]          |      [â] main.LV_selected_row</span>
<span class="cm">       E     input_cmd_theCommand          |      [â] pop.cmd</span>
<span class="cm">                                  |                                </span>
<span class="cm">       TAB   cmd_tab_is_new_action         |      if tab: add action</span>
<span class="cm">       A     input_newAction_type          |          [â] pop.newact.folder || pop.newact.app</span>
<span class="cm">       B     input_newAction_path          |          [â] pop.newact.path</span>
<span class="cm">       C     input_newAction_arg           |          [â] pop.newact.arg </span>
<span class="cm">                                  |                                </span>
<span class="cm">       TAB   cmd_tab_is_new_action         |      if tab: use existing action</span>
<span class="cm">       D     input_oldAction_id            |          [â] pop.oldact.id</span>
<span class="cm">                                  |                                </span>
<span class="cm">                                  |                                </span>
<span class="cm">      ----------------------------------------------------------------------------------</span>
<span class="cm">      [A,B,C,D,E,F,TAB]          Which Popups use which of the var #s? </span>
<span class="cm">      ----------------------------------------------------------------------------------</span>
<span class="cm">      </span>
<span class="cm">           A :            act.add, act.edit,   cmd.add.tab1, cmd.edit.tab1</span>
<span class="cm">           B :            act.add, act.edit,   cmd.add.tab1, cmd.edit.tab1</span>
<span class="cm">           C :            act.add, act.edit,   cmd.add.tab1, cmd.edit.tab1</span>
<span class="cm">           D :                     act.edit,   cmd.add.tab2, cmd.edit.tab2</span>
<span class="cm">           E :                                 cmd.add,      cmd.edit</span>
<span class="cm">           F :                     act.edit,                 cmd.edit</span>
<span class="cm">         TAB :                                 cmd.add       cmd.edit</span>
<span class="cm">         </span>
<span class="cm">      ----------------------------------------------------------------------------------</span>
<span class="cm">      </span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS>
      
      
      <span class="n">mode</span>    <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span>
      <span class="n">purpose</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_purpose</span>
      
      
      <span class="n">A_input_newAction_type</span>       <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1">     ; A ;   all pop.act,   all pop.cmd (if tab 1)</span>
      <span class="n">B_input_newAction_path</span>       <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1">     ; B ;   all pop.act,   all pop.cmd (if tab 1)</span>
      <span class="n">C_input_newAction_arg</span>        <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1">     ; C ;   all pop.act,   all pop.cmd (if tab 1)</span>
      
      <span class="n">D_input_oldAction_id</span>         <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1">     ; D ;       pop.edit   all pop.cmd (if tab 2)</span>
      <span class="n">E_input_cmd_theCommand</span>       <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1">     ; E ;                  all pop.cmd</span>
      <span class="n">TAB_cmd_tab_is_new_action</span>    <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1">     ; TAB ;                all pop.cmd</span>
      
      <span class="n">F_insertion_point_for_mainLV</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c1">     ; F ;   edit pop.act, edit pop.cmd</span>
      
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;edit&quot;</span> <span class="o">==</span> <span class="n">purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
<DETAILS class="leading_tabs_3"><SUMMARY><span class="c1">;-----------------------------------------------------------------------</span>
<span class="c1">         ; If editing a Command or an Action </span>
<span class="c1">         ;----------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">         ;</span>
<span class="c1">         ; the original needs a valid insertion point </span>
<span class="c1">         ; in GuiConfigMain&#39;s corresponding ListView.</span>
<span class="c1">         ;</span>
<span class="c1">         ; Before the popup was rendered, the Action or Command </span>
<span class="c1">         ; was removed from _ACTIONS or _COMMANDS </span>
<span class="c1">         ; to make duplication-checking logic simpler below </span>
<span class="c1">         ; (and that entry will be added back, possibly modified,</span>
<span class="c1">         ;  after successful Submit). </span>
<span class="c1">         ;</span>
<span class="c1">         ; Their entry inside their ListView is still there in the GUI, unaltered </span>
<span class="c1">         ; (but will be changed upon a successful edit)</span>
<span class="c1">         ;----------------------------------------------------------------------- </span></DETAILS>
<span class="c1">         </span>
<span class="c1">         ;---;</span>
<span class="c1">         ; F ;</span>
<span class="c1">         ;---;</span>
         <span class="n">F_insertion_point_for_mainLV</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_RowData_FromMainGui</span><span class="p">[</span><span class="s">&quot;LV_id&quot;</span><span class="p">]</span>
      <span class="p">}</span></DETAILS>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;command&quot;</span> <span class="o">==</span> <span class="n">mode</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;-----;</span>
<span class="c1">         ; TAB ;</span>
<span class="c1">         ;-----;</span>
         <span class="n">TAB_cmd_tab_is_new_action</span> <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;Add New Action&quot;</span> <span class="o">=</span> <span class="n">GuiConfigPopup_Cmd_Tabs</span><span class="ss">)</span> <span class="o">?</span> <span class="nv">true</span> <span class="o">:</span> <span class="nv">false</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;---;</span>
<span class="c1">         ; E ;</span>
<span class="c1">         ;---;</span>
         <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigPopup_Cmd_InputCommandName&quot;</span>
         <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,,</span> <span class="vi">%c%</span>
         <span class="n">E_input_cmd_theCommand</span> <span class="o">:=</span> <span class="n">cmd</span><span class="c1"> </span>

<span class="c1">         ;-------------------------------------</span>
<span class="c1">         ; Command Tab2 &quot;Use Existing Action&quot;</span>
<span class="c1">         ;-------------------------------------</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="nv">false</span> <span class="o">==</span> <span class="n">TAB_cmd_tab_is_new_action</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            ; tmp := GuiConfigPopup._LV_selected_action_id</span>
<span class="c1">            ; msgbox in gather lv is %tmp%</span>
            
            <span class="n">action_id</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_LV_selected_action_id</span>
            
<DETAILS open class="control_flow_block leading_tabs_4"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">action_id</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">               ;---;   ;---;   ;---;</span>
<span class="c1">               ; A ;   ; B ;   ; C ;</span>
<span class="c1">               ;---;   ;---;   ;---;</span>
               <span class="n">A_input_newAction_type</span> <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">action_id</span><span class="p">][</span><span class="s">&quot;type&quot;</span><span class="p">]</span>
               <span class="n">B_input_newAction_path</span> <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">action_id</span><span class="p">][</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
               <span class="n">C_input_newAction_arg</span>  <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">action_id</span><span class="p">][</span><span class="s">&quot;arg&quot;</span><span class="p">]</span><span class="c1"></span>
<span class="c1">               </span>
<span class="c1">               ;---;</span>
<span class="c1">               ; D ;</span>
<span class="c1">               ;---;</span>
               <span class="n">D_input_oldAction_id</span> <span class="o">:=</span> <span class="n">action_id</span>
            <span class="p">}</span></DETAILS>
            
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="n">mode</span>
      <span class="ow">or</span> <span class="nv">true</span>     <span class="o">==</span> <span class="n">TAB_cmd_tab_is_new_action</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">         ;---;</span>
<span class="c1">         ; A ;</span>
<span class="c1">         ;---;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="n">GuiConfigPopup_ActionConfig_RadioFolder</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">A_input_newAction_type</span> <span class="o">:=</span> <span class="s">&quot;folder&quot;</span>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">GuiConfigPopup_ActionConfig_RadioApp</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">A_input_newAction_type</span> <span class="o">:=</span> <span class="s">&quot;app&quot;</span>
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;---------------------------------------------------</span>
<span class="c1">         ; sets GuiConfigPopup._isPathValid to true or false</span>
<span class="c1">         ;</span>
         <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_FN_LabelPathVerified_CheckAndRefresh</span><span class="ss">()</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_isPathValid</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">            ;---;</span>
<span class="c1">            ; B ;</span>
<span class="c1">            ;---;</span>
            <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_InputPath&quot;</span>
            <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">path</span><span class="p">,,</span> <span class="vi">%c%</span>
            <span class="n">B_input_newAction_path</span> <span class="o">:=</span> <span class="n">path</span><span class="c1"></span>
<span class="c1">            ; msgbox in gather path is {%path%}</span>
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;-----------------------------------------------------------</span>
<span class="c1">         ; Only actions which open an application</span>
<span class="c1">         ; will possibly have a custom Argument provided by the user </span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">GuiConfigPopup_ActionConfig_RadioApp</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">            ;---;</span>
<span class="c1">            ; C ;</span>
<span class="c1">            ;---;</span>
            <span class="n">c</span> <span class="o">:=</span> <span class="s">&quot;GuiConfigPopup_ActionConfig_InputArguments&quot;</span>
            <span class="kr">GuiControlGet</span><span class="p">,</span> <span class="n">userInputArg</span><span class="p">,,</span> <span class="vi">%c%</span>
            <span class="n">C_input_newAction_arg</span> <span class="o">:=</span> <span class="n">userInputArg</span>
         <span class="p">}</span></DETAILS>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;action&quot;</span> <span class="o">==</span> <span class="n">mode</span> 
         <span class="ow">and</span> <span class="s">&quot;edit&quot;</span>   <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">               ;---;</span>
<span class="c1">               ; D ;</span>
<span class="c1">               ;---;</span>
               <span class="n">D_input_oldAction_id</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_action</span><span class="p">[</span><span class="s">&quot;action_id&quot;</span><span class="p">]</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; msgbox gather: path[%B_input_newAction_path%]</span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------------;</span>
<span class="c1">      ;   A,B,C,D,E,F,TAB are now all set   ;</span>
<span class="c1">      ;-------------------------------------;</span>
<span class="c1">      ;   1 - [â] Gather Variables          ;</span>
<span class="c1">      ;-------------------------------------;</span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------------;</span>
<span class="c1">      ; GuiConfigPopup.Submit_Changes()                           ;</span>
<span class="c1">      ; will continue from here and:                              ;</span>
<span class="c1">      ;-----------------------------------------------------------;</span>
<span class="c1">      ;   2 - validate the vars                                   ;</span>
<span class="c1">      ;   3 - attempt to submit if all vars valid                 ;</span>
<span class="c1">      ;   4 - then if it all worked: close down the gui instance  ;</span>
<span class="c1">      ;-----------------------------------------------------------;</span>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>
      
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Submit_Changes_2__VerifyActionVars</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">         A_input_newAction_type       := &quot;&quot;     ; A ;   all pop.act</span>
<span class="cm">         B_input_newAction_path       := &quot;&quot;     ; B ;   all pop.act</span>
<span class="cm">         C_input_newAction_arg        := &quot;&quot;     ; C ;   all pop.act</span>
<span class="cm">         D_input_oldAction_id         := &quot;&quot;     ; D ;       pop.edit   all pop.cmd (if tab 2)</span>
<span class="cm">         </span>
<span class="cm">         F_insertion_point_for_mainLV := &quot;&quot;     ; F ;   edit pop.act</span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS>
      
      <span class="n">mode</span>    <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span>
      <span class="n">purpose</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_purpose</span>
      
      <span class="n">FAILURE</span> <span class="o">:=</span> <span class="nv">false</span>
      <span class="n">SUCCESS</span> <span class="o">:=</span> <span class="nv">true</span>
      <span class="n">USER_NOTIFIED</span> <span class="o">:=</span> <span class="s">&quot;User notified to try again.&quot;</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">      ;=========================</span>
<span class="c1">      ; Cancel if vars not set</span>
<span class="c1">      ;=========================</span>
<span class="c1">      </span>
<span class="c1">      ;---;   ;---;   ;---;</span>
<span class="c1">      ; A ;   ; B ;   ; C ;</span>
<span class="c1">      ;---;   ;---;   ;---;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">A_input_newAction_type</span>
      <span class="ow">or</span>  <span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">B_input_newAction_path</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      ; it&#39;s okay if C_input_newAction_arg is empty</span>
      
         <span class="k">return</span> <span class="n">FAILURE</span>
         
      <span class="p">}</span></DETAILS>
   
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;edit&quot;</span> <span class="o">==</span> <span class="n">purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;---;</span>
<span class="c1">         ; D ;</span>
<span class="c1">         ;---;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">D_input_oldAction_id</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="k">return</span> <span class="n">FAILURE</span>            
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;---;</span>
<span class="c1">         ; F ;</span>
<span class="c1">         ;---;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">F_insertion_point_for_mainLV</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="k">return</span> <span class="n">FAILURE</span>
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;========================================================</span>
<span class="c1">      ; Standardize Action Path (directory or app) string</span>
<span class="c1">      ;========================================================</span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------------------------</span>
<span class="c1">      ; Standardize paths like:</span>
<span class="c1">      ;    &quot;C:/somdir\another/dir&quot;</span>
<span class="c1">      ; </span>
<span class="c1">      ; to have uniform backslashes and trailing slashes:</span>
<span class="c1">      ;    &quot;C:\somdir\another\dir\&quot;</span>
<span class="c1">      ;</span>
      <span class="n">p1</span> <span class="o">:=</span> <span class="n">B_input_newAction_path</span>
      <span class="n">p2</span> <span class="o">:=</span> <span class="n">A_input_newAction_type</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;---;</span>
<span class="c1">      ; B ;</span>
<span class="c1">      ;---;</span>
      <span class="n">B_input_newAction_path</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Fn_Standardize_Path_String</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ss">)</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;========================================================</span>
<span class="c1">      ; Check for identical preexisting Actions</span>
<span class="c1">      ;========================================================</span>
      
      <span class="n">found_duplicate_action</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">does_action_already_exist</span><span class="ss">(</span> <span class="s">&quot;&quot;</span>
         <span class="o">.</span>   <span class="n">A_input_newAction_type</span>
           <span class="p">,</span> <span class="n">B_input_newAction_path</span>
           <span class="p">,</span> <span class="n">C_input_newAction_arg</span>  <span class="ss">)</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">found_duplicate_action</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">inform_user</span> <span class="o">:=</span> <span class="s">&quot;Action already exists.</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">inform_user</span> <span class="o">.=</span> <span class="s">&quot;Action[&quot;</span> <span class="n">found_duplicate_action</span> <span class="s">&quot;] is already configured to do this:</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">inform_user</span> <span class="o">.=</span> <span class="s">&quot;    Type:</span><span class="se">`t</span><span class="s">&quot;</span> <span class="n">A_input_newAction_type</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">inform_user</span> <span class="o">.=</span> <span class="s">&quot;    Path:</span><span class="se">`t</span><span class="s">&quot;</span> <span class="n">B_input_newAction_path</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">inform_user</span> <span class="o">.=</span> <span class="ss">(</span><span class="s">&quot;&quot;</span> <span class="o">!=</span> <span class="n">C_input_newAction_arg</span><span class="ss">)</span> 
                     <span class="o">?</span> <span class="s">&quot;    Arg:</span><span class="se">`t</span><span class="s">&quot;</span> <span class="n">C_input_newAction_arg</span> 
                     <span class="o">:</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">inform_user</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">inform_user</span> <span class="o">.=</span> <span class="s">&quot;No action taken.&quot;</span>
         
         <span class="kr">MsgBox</span><span class="p">,,</span> <span class="p">[</span><span class="n">Duplicate</span> <span class="n">Action</span><span class="p">],</span> <span class="vi">%inform_user%</span>
         <span class="k">return</span> <span class="n">USER_NOTIFIED</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------------------;</span>
<span class="c1">      ;   If this line is reached, then all vars are good!   ;</span>
<span class="c1">      ;------------------------------------------------------;</span>
<span class="c1">      ;   1 - [â] Gather Variables                           ;</span>
<span class="c1">      ;   2 - [â] Verify Variables                           ;</span>
<span class="c1">      ;------------------------------------------------------;</span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------------;</span>
<span class="c1">      ; GuiConfigPopup.Submit_Changes()                           ;</span>
<span class="c1">      ; will continue from here and:                              ;</span>
<span class="c1">      ;-----------------------------------------------------------;</span>
<span class="c1">      ;   3 - attempt to submit changes and (if succeessful)      ;</span>
<span class="c1">      ;   4 - close down the gui instance                         ;</span>
<span class="c1">      ;-----------------------------------------------------------;</span>
      
      <span class="k">return</span> <span class="n">SUCCESS</span>
   <span class="p">}</span></DETAILS>
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Submit_Changes_2__VerifyCommandVars</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">         A_input_newAction_type       := &quot;&quot;     ; A ;     all pop.cmd (if tab 1)</span>
<span class="cm">         B_input_newAction_path       := &quot;&quot;     ; B ;     all pop.cmd (if tab 1)</span>
<span class="cm">         C_input_newAction_arg        := &quot;&quot;     ; C ;     all pop.cmd (if tab 1)</span>
<span class="cm">         </span>
<span class="cm">         D_input_oldAction_id         := &quot;&quot;     ; D ;     all pop.cmd (if tab 2)</span>
<span class="cm">         E_input_cmd_theCommand       := &quot;&quot;     ; E ;     all pop.cmd</span>
<span class="cm">         F_insertion_point_for_mainLV := &quot;&quot;     ; F ;   edit  pop.cmd</span>
<span class="cm">         </span>
<span class="cm">         TAB_cmd_tab_is_new_action    := &quot;&quot;     ; TAB ;   all pop.cmd</span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; msgbox in verfcmd</span>
      
      <span class="n">mode</span>    <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span>
      <span class="n">purpose</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_purpose</span>
      
      <span class="n">is_tab_1</span> <span class="o">:=</span> <span class="n">TAB_cmd_tab_is_new_action</span>
      <span class="n">is_tab_2</span> <span class="o">:=</span> <span class="o">!</span><span class="n">TAB_cmd_tab_is_new_action</span>
      
      <span class="n">SUCCESS</span> <span class="o">:=</span> <span class="nv">true</span>
      <span class="n">FAILURE</span> <span class="o">:=</span> <span class="nv">false</span>
      <span class="n">USER_NOTIFIED</span> <span class="o">:=</span> <span class="s">&quot;User notified to try again.&quot;</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;=========================</span>
<span class="c1">      ; Cancel if vars not set</span>
<span class="c1">      ;=========================</span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------</span>
<span class="c1">      ; Tab1 -&gt; &quot;Add New Action&quot; tab.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">is_tab_1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;---;   ;---;   ;---;</span>
<span class="c1">         ; A ;   ; B ;   ; C ;</span>
<span class="c1">         ;---;   ;---;   ;---;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">A_input_newAction_type</span>
         <span class="ow">or</span>  <span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">B_input_newAction_path</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">         ; it&#39;s okay if C_input_newAction_arg is empty </span>
         
            <span class="k">return</span> <span class="n">FAILURE</span>
            
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;---------------------------------------</span>
<span class="c1">      ; Tab2 -&gt; &quot;Using Existing Action&quot; tab.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">is_tab_2</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;---;</span>
<span class="c1">         ; D ;</span>
<span class="c1">         ;---;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">D_input_oldAction_id</span> <span class="ss">)</span><span class="p">{</span><span class="c1"> ; error _____SUMMARY_END_____</span>
            <span class="k">return</span> <span class="n">FAILURE</span>
         <span class="p">}</span></DETAILS>
      
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------</span>
<span class="c1">      ; Either Tab </span>
<span class="c1">      ;-------------------------</span>
<span class="c1">      </span>
<span class="c1">      ;---;</span>
<span class="c1">      ; E ;</span>
<span class="c1">      ;---;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">E_input_cmd_theCommand</span> <span class="ss">)</span><span class="p">{</span><span class="c1"> ; error _____SUMMARY_END_____</span>
<span class="c1">      ; If Command text is empty </span>
      
         
         <span class="k">return</span> <span class="n">FAILURE</span>         
      <span class="p">}</span></DETAILS>
      
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;edit&quot;</span> <span class="o">==</span> <span class="n">purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;---;</span>
<span class="c1">         ; F ;</span>
<span class="c1">         ;---;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;&quot;</span> <span class="o">==</span> <span class="n">F_insertion_point_for_mainLV</span> <span class="ss">)</span><span class="p">{</span><span class="c1">  ; error _____SUMMARY_END_____</span>
            <span class="k">return</span> <span class="n">FAILURE</span>
         <span class="p">}</span></DETAILS>
         
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;========================================================</span>
<span class="c1">      ; Ensure Command (if renamed) is unique.</span>
<span class="c1">      ;========================================================</span>
<span class="c1">      </span>
<span class="c1">      ;---;</span>
<span class="c1">      ; E ;</span>
<span class="c1">      ;---;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="vc">_COMMANDS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span> <span class="n">E_input_cmd_theCommand</span> <span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      ; If another Command already uses this text </span>
      
         
         <span class="n">usr_output</span> <span class="o">:=</span> <span class="s">&quot;Oops, there&#39;s already a command with the word or phrase:</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">usr_output</span> <span class="o">.=</span> <span class="s">&quot;    &quot;</span> <span class="n">E_input_cmd_theCommand</span> <span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span>
         <span class="n">usr_output</span> <span class="o">.=</span> <span class="s">&quot;Either remove that command first,</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">usr_output</span> <span class="o">.=</span> <span class="s">&quot;or try another phrase.&quot;</span>
         
         <span class="kr">MsgBox</span><span class="p">,,</span><span class="n">Duplicate</span> <span class="n">Command</span><span class="p">,</span> <span class="vi">%usr_output%</span>         
         
         <span class="k">return</span> <span class="n">USER_NOTIFIED</span>         
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;========================================================</span>
<span class="c1">      ; If new Action:</span>
<span class="c1">      ;</span>
<span class="c1">      ;   Standardize all Action path strings</span>
<span class="c1">      ;   (a) So all path strings are uniform across the App.</span>
<span class="c1">      ;   (b) To aid in comparisons searching for duplicates.</span>
<span class="c1">      ;========================================================</span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------</span>
<span class="c1">      ; Tab1 -&gt; &quot;Add New Action&quot; tab.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">is_tab_1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;========================================================</span>
<span class="c1">         ; Format Action Path (directory or app) string</span>
<span class="c1">         ;========================================================</span>
<span class="c1">         </span>
<span class="c1">         ;--------------------------------------------------</span>
<span class="c1">         ; Standardize paths like:</span>
<span class="c1">         ;    &quot;C:/somdir\another/dir&quot;</span>
<span class="c1">         ; </span>
<span class="c1">         ; to have uniform backslashes and trailing slashes:</span>
<span class="c1">         ;    &quot;C:\somdir\another\dir\&quot;</span>
<span class="c1">         ;</span>
         <span class="n">p1</span> <span class="o">:=</span> <span class="n">B_input_newAction_path</span>
         <span class="n">p2</span> <span class="o">:=</span> <span class="n">A_input_newAction_type</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         </span>
<span class="c1">         ;---;</span>
<span class="c1">         ; B ;</span>
<span class="c1">         ;---;</span>
         <span class="n">B_input_newAction_path</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Fn_Standardize_Path_String</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ss">)</span>
         
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------------------;</span>
<span class="c1">      ;   If this line is reached, then all vars are good!   ;</span>
<span class="c1">      ;------------------------------------------------------;</span>
<span class="c1">      ;   1 - [â] Gather Variables                           ;</span>
<span class="c1">      ;   2 - [â] Verify Variables                           ;</span>
<span class="c1">      ;------------------------------------------------------;</span>
<span class="c1">      </span>
<span class="c1">      ;-----------------------------------------------------------;</span>
<span class="c1">      ; GuiConfigPopup.Submit_Changes()                           ;</span>
<span class="c1">      ; will continue from here and:                              ;</span>
<span class="c1">      ;-----------------------------------------------------------;</span>
<span class="c1">      ;   3 - attempt to submit changes and (if succeessful)      ;</span>
<span class="c1">      ;   4 - close down the gui instance                         ;</span>
<span class="c1">      ;-----------------------------------------------------------;</span>
      
      <span class="k">return</span> <span class="n">SUCCESS</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Submit_Changes_3___ActionSubmit</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
   
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">         A_input_newAction_type       := &quot;&quot;     ; A ;   all pop.act</span>
<span class="cm">         B_input_newAction_path       := &quot;&quot;     ; B ;   all pop.act</span>
<span class="cm">         C_input_newAction_arg        := &quot;&quot;     ; C ;   all pop.act</span>
<span class="cm">         </span>
<span class="cm">         F_insertion_point_for_mainLV := &quot;&quot;     ; F ;   edit pop.act</span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS>
      
      <span class="n">mode</span>    <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span>
      <span class="n">purpose</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_purpose</span>
      
      <span class="n">FAILURE</span> <span class="o">:=</span> <span class="nv">false</span>
      <span class="n">SUCCESS</span> <span class="o">:=</span> <span class="nv">true</span>
      <span class="n">USER_NOTIFIED</span> <span class="o">:=</span> <span class="s">&quot;notified user of conflict, no errors&quot;</span>
      
      <span class="n">popup_actionType</span> <span class="o">:=</span> <span class="n">A_input_newAction_type</span>
      <span class="n">popup_actionPath</span> <span class="o">:=</span> <span class="n">B_input_newAction_path</span>
      <span class="n">popup_actionArg</span>  <span class="o">:=</span> <span class="n">C_input_newAction_arg</span>
      
      <span class="n">popup_actionID</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>

<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;add&quot;</span> <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">popup_actionID</span> <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">Length</span><span class="ss">()</span><span class="o">+</span><span class="mi">1</span>   
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;edit&quot;</span> <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">popup_actionID</span> <span class="o">:=</span> <span class="n">D_input_oldAction_id</span>      
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;========================================================</span>
<span class="c1">      ; Submit new or edited Action to _ACTIONS array </span>
<span class="c1">      ;========================================================</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">popup_actionID</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
         <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">popup_actionID</span><span class="p">]</span> <span class="o">:=</span> <span class="p">{</span> <span class="s">&quot;&quot;</span> 
            <span class="o">.</span> <span class="s">&quot;type&quot;</span><span class="o">:</span> <span class="n">popup_actionType</span>
            <span class="p">,</span> <span class="s">&quot;path&quot;</span><span class="o">:</span> <span class="n">popup_actionPath</span>
            <span class="p">,</span> <span class="s">&quot;arg&quot;</span> <span class="o">:</span> <span class="n">popup_actionArg</span>   <span class="p">}</span>
            
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;=======================================================================</span>
<span class="c1">      ; Submit new or edited Action to ListView for Actions in GuiConfigMain</span>
<span class="c1">      ;=======================================================================</span>
<span class="c1">      </span>
<span class="c1">      ;------------------------------------------------------------------------------</span>
<span class="c1">      ; Tells future ListView operations to operate on this specific ListView control</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_Activate</span><span class="ss">()</span>
      
      <span class="n">LV_FAILURE</span> <span class="o">:=</span> <span class="mi">0</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="s">&quot;add&quot;</span> <span class="o">==</span> <span class="n">purpose</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="n">options</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">LV_returned</span> <span class="o">:=</span> <span class="kr">LV_ADD</span><span class="ss">(</span> <span class="s">&quot;&quot;</span>
            <span class="o">.</span> <span class="n">options</span><span class="c1">             ; no options needed</span>
            <span class="p">,</span> <span class="n">popup_actionID</span><span class="c1">        ; row 1</span>
            <span class="p">,</span> <span class="n">popup_actionType</span><span class="c1">      ; row 2</span>
            <span class="p">,</span> <span class="n">popup_actionPath</span><span class="c1">      ; row 3</span>
            <span class="p">,</span> <span class="n">popup_actionArg</span>  <span class="ss">)</span><span class="c1">    ; row 4</span>
<span class="c1">         </span>
<span class="c1">         ; for debugging</span>
<span class="c1">         ;</span>
<span class="c1">         ; msgBOX lv %LV_returned%</span>
<span class="c1">         ; GuiConfigPopup.Submit_Changes_DEBUG()</span>
<span class="c1">         </span>
<span class="c1">         ;----------------------------------------------</span>
<span class="c1">         ; cancel submit, inform user, return to popup</span>
<span class="c1">         ;</span>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="n">LV_returned</span> <span class="o">==</span> <span class="n">LV_FAILURE</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="kr">MSGBOX</span><span class="p">,</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">add</span> <span class="n">new</span> <span class="n">action</span> <span class="n">to</span> <span class="n">ListView</span><span class="o">.</span>
            
            <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes_DEBUG</span><span class="ss">()</span>
            
            <span class="k">return</span> <span class="n">FAILURE</span>
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span>
      <span class="k">if</span><span class="ss">(</span> <span class="s">&quot;edit&quot;</span> <span class="o">==</span> <span class="n">purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
      
         <span class="n">modify_this_row</span> <span class="o">:=</span> <span class="n">F_insertion_point_for_mainLV</span>
         
         <span class="n">LV_returned</span> <span class="o">:=</span> <span class="kr">LV_MODIFY</span><span class="ss">(</span> <span class="n">modify_this_row</span>
            <span class="p">,</span><span class="c1">                     ; no options needed</span>
            <span class="p">,</span> <span class="n">popup_actionID</span><span class="c1">      ; row 1</span>
            <span class="p">,</span> <span class="n">popup_actionType</span><span class="c1">       ; row 2</span>
            <span class="p">,</span> <span class="n">popup_actionPath</span><span class="c1">       ; row 3</span>
            <span class="p">,</span> <span class="n">popup_actionArg</span>  <span class="ss">)</span><span class="c1">    ; row 4</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="n">LV_returned</span> <span class="o">==</span> <span class="n">LV_FAILURE</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="kr">msgbox</span><span class="p">,</span> <span class="n">Failed</span> <span class="n">to</span> <span class="kr">edit</span> <span class="n">existing</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">ListView</span><span class="o">.</span>
            
            <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">Submit_Changes_DEBUG</span><span class="ss">()</span>
            
            <span class="k">return</span> <span class="n">FAILURE</span>
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">            </span>
<span class="c1">         ;----------------------------------------</span>
<span class="c1">         ; Remove backup of (now) edited Action</span>
<span class="c1">         ;----------------------------------------</span>
<span class="c1">         ; Making this variable empty will prevent </span>
<span class="c1">         ;</span>
<span class="c1">         ;   GUI_EVENT_GuiConfigPopup_OnClose and</span>
<span class="c1">         ;   GUI_EVENT_GuiConfigPopup_OnEscape</span>
<span class="c1">         ;</span>
<span class="c1">         ; from automatically restoring </span>
<span class="c1">         ; the old version of this Action</span>
<span class="c1">         ;</span>
<span class="c1">         ; when the GuiConfigPopup GUI is closed.</span>
<span class="c1">         ;----------------------------------------</span>
         
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Discard_Plucked_Action</span><span class="ss">()</span>
         
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_UpdateAllWhichUseAction</span><span class="ss">(</span><span class="n">popup_actionID</span><span class="ss">)</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;=======================================================================</span>
<span class="c1">      ; Submit changes to Savefile (all above operations were successful)</span>
<span class="c1">      ;=======================================================================</span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;-------------------------------------------------------------------</span>
<span class="c1">      ; Syntax Reference</span>
<span class="c1">      ;------------------------------------------------------------------- </span></SUMMARY>
<span class="c1">      ; class:    FILE_HELPER</span>
<span class="c1">      ; function: Change_Savefile( p1,p2,p3,p4 )</span>
<span class="c1">      ;</span>
<span class="c1">      ; p1:  mode                      action|command</span>
<span class="c1">      ; p2:  purpose                   add|delete|edit|enable|disable</span>
<span class="c1">      ; p2:  action_id__or__cmd        new Action&#39;s ID </span>
<span class="c1">      ; p2:  cmd_name_before_rename    not applicable here</span>
<span class="c1">      ;------------------------------------------------------------------- </span></DETAILS>
      
      <span class="n">p1</span> <span class="o">:=</span> <span class="s">&quot;action&quot;</span>
      <span class="n">p2</span> <span class="o">:=</span> <span class="n">purpose</span> 
      <span class="n">p3</span> <span class="o">:=</span> <span class="n">popup_actionID</span>
      <span class="n">p4</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      <span class="n">savefile_updated</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Savefile</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span><span class="p">,</span><span class="n">p4</span> <span class="ss">)</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="n">savefile_updated</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">MSGBOX</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">ERROR</span> <span class="n">WRITING</span> <span class="n">TO</span> <span class="n">SAVEFILE</span><span class="p">,</span> <span class="p">[</span><span class="o">~</span><span class="p">]</span>
         <span class="k">return</span> <span class="n">FAILURE</span>
      <span class="p">}</span></DETAILS>
      
      
      <span class="k">return</span> <span class="n">SUCCESS</span>
      
   <span class="p">}</span><span class="c1"> ; end of Submit_Changes_3___ActionSubmit() </span></DETAILS>
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">does_action_already_exist</span><span class="ss">(</span><span class="n">action_type</span><span class="p">,</span> <span class="n">action_path</span><span class="p">,</span> <span class="n">action_arg</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span><span class="c1"> </span>
<span class="c1">   </span>
<span class="c1">      ;===========================================</span>
<span class="c1">      ; return 0 if no Action matches this config</span>
<span class="c1">      ;===========================================</span>
      
      <span class="n">id_exists</span> <span class="o">:=</span> <span class="mi">0</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">for</span> <span class="n">id</span><span class="p">,</span> <span class="n">action</span> <span class="ow">in</span> <span class="vc">_ACTIONS</span> 
      <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">aType</span> <span class="o">:=</span> <span class="n">action</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span>
         <span class="n">aPath</span> <span class="o">:=</span> <span class="n">action</span><span class="p">[</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
         <span class="n">aArg</span>  <span class="o">:=</span> <span class="n">action</span><span class="p">[</span><span class="s">&quot;arg&quot;</span><span class="p">]</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">aType</span> <span class="o">==</span> <span class="n">action_type</span> 
         <span class="ow">and</span> <span class="n">aPath</span> <span class="o">==</span> <span class="n">action_path</span> 
         <span class="ow">and</span> <span class="n">aArg</span>  <span class="o">==</span> <span class="n">action_arg</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
            <span class="n">id_exists</span> <span class="o">:=</span> <span class="n">id</span> 
            <span class="k">break</span>
            
         <span class="p">}</span></DETAILS>

      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span> <span class="n">id_exists</span>
   <span class="p">}</span></DETAILS>
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Submit_Changes_3___CommandSubmit</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
   
<DETAILS class="leading_tabs_2"><SUMMARY><span class="cm">/* </span><span class="cm DETAILS_CLOSE_BRACE">*/</span></SUMMARY>
<span class="cm">         A_input_newAction_type       := &quot;&quot;     ; A ;     all pop.cmd (if tab 1)</span>
<span class="cm">         B_input_newAction_path       := &quot;&quot;     ; B ;     all pop.cmd (if tab 1)</span>
<span class="cm">         C_input_newAction_arg        := &quot;&quot;     ; C ;     all pop.cmd (if tab 1)</span>
<span class="cm">         </span>
<span class="cm">         D_input_oldAction_id         := &quot;&quot;     ; D ;     all pop.cmd (if tab 2)</span>
<span class="cm">         E_input_cmd_theCommand       := &quot;&quot;     ; E ;     all pop.cmd</span>
<span class="cm">         F_insertion_point_for_mainLV := &quot;&quot;     ; F ;   edit  pop.cmd</span>
<span class="cm">         </span>
<span class="cm">         TAB_cmd_tab_is_new_action    := &quot;&quot;     ; TAB ;   all pop.cmd</span>
<span class="cm DETAILS__INNER_CLOSE_BRACE">      */</span></DETAILS>
      
      <span class="n">mode</span>    <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_mode</span>
      <span class="n">purpose</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="vc">_popup_purpose</span>
      
      <span class="n">FAILURE</span> <span class="o">:=</span> <span class="nv">false</span>
      <span class="n">SUCCESS</span> <span class="o">:=</span> <span class="nv">true</span>
      
      <span class="n">is_action_new</span> <span class="o">:=</span> <span class="nv">false</span>
      
      <span class="n">is_tab_1</span> <span class="o">:=</span> <span class="n">TAB_cmd_tab_is_new_action</span>
      <span class="n">is_tab_2</span> <span class="o">:=</span> <span class="o">!</span><span class="n">TAB_cmd_tab_is_new_action</span>
      
      <span class="n">popup_cmd</span>        <span class="o">:=</span> <span class="n">E_input_cmd_theCommand</span>
      <span class="n">popup_actionType</span> <span class="o">:=</span> <span class="n">A_input_newAction_type</span>
      <span class="n">popup_actionPath</span> <span class="o">:=</span> <span class="n">B_input_newAction_path</span>
      <span class="n">popup_actionArg</span>  <span class="o">:=</span> <span class="n">C_input_newAction_arg</span>
      
      <span class="n">popup_actionID</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">use_actionID</span>   <span class="o">:=</span> <span class="s">&quot;&quot;</span>
      
      <span class="n">original_command_name</span> <span class="o">:=</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_command</span><span class="p">[</span><span class="s">&quot;command&quot;</span><span class="p">]</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;==============================================================</span>
<span class="c1">      ; Determine Action ID </span>
<span class="c1">      ;   (if duplicate, use preexisting, don&#39;t make a new Action).</span>
<span class="c1">      ;==============================================================</span>
<span class="c1">      </span>
<span class="c1">      ;--------------------------------</span>
<span class="c1">      ; Tab1 -&gt; &quot;Add New Action&quot; tab.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">is_tab_1</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
<DETAILS class="leading_tabs_3"><SUMMARY><span class="c1">;--------------------------------------------------------</span>
<span class="c1">         ; Determine Action ID - New or use Preexisting</span>
<span class="c1">         ;-------------------------------------------------------- </span></SUMMARY>
<span class="c1">         ;</span>
<span class="c1">         ; If user is on the &quot;Add New Action&quot; tab</span>
<span class="c1">         ; an unused ID will be assigned to the new Action.</span>
<span class="c1">         ; </span>
<span class="c1">         ; However, if the entire &quot;Add New Action&quot; config </span>
<span class="c1">         ; matches an identical preexisting Action</span>
<span class="c1">         ; that Action will be used instead of creating a new one.</span>
<span class="c1">         ;                                                          </span></DETAILS>
         <span class="n">use_actionID</span> <span class="o">:=</span> <span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">Length</span><span class="ss">()</span><span class="o">+</span><span class="mi">1</span>   
         
         <span class="n">duplicate_action_id_found</span> <span class="o">:=</span> <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">does_action_already_exist</span><span class="ss">(</span><span class="s">&quot;&quot;</span>
            <span class="o">.</span>   <span class="n">popup_actionType</span>
              <span class="p">,</span> <span class="n">popup_actionPath</span>
              <span class="p">,</span> <span class="n">popup_actionArg</span><span class="ss">)</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">duplicate_action_id_found</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="n">use_actionID</span> <span class="o">:=</span> <span class="n">duplicate_action_id_found</span>
         <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">else</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
            <span class="n">is_action_new</span> <span class="o">:=</span> <span class="nv">true</span>
            
         <span class="p">}</span></DETAILS>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      ;---------------------------------------</span>
<span class="c1">      ; Tab2 -&gt; &quot;Using Existing Action&quot; tab.</span>
<span class="c1">      ;</span>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> <span class="k">if</span><span class="ss">(</span> <span class="n">is_tab_2</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;--------------------------------------------------</span>
<span class="c1">         ; Determine Action ID -- use existing Action&#39;s ID</span>
<span class="c1">         ;--------------------------------------------------</span>
<span class="c1">         ;</span>
         <span class="n">use_actionID</span> <span class="o">:=</span> <span class="n">D_input_oldAction_id</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;=============</span>
<span class="c1">      ; Action ID </span>
<span class="c1">      ;=============</span>
      
      <span class="n">popup_actionID</span>   <span class="o">:=</span> <span class="n">use_actionID</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ; msgbox popup_cmd[%popup_cmd%] path[%popup_actionPath%] type[%popup_actionType%] </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;========================================================</span>
<span class="c1">      ; Submit Command (new or modified):</span>
<span class="c1">      ; to _COMMANDS array </span>
<span class="c1">      ;========================================================      </span>
      
<DETAILS class="leading_tabs_2"><SUMMARY><span class="c1">;---------------------------------------------------------</span>
<span class="c1">      ; Assign a key value pair in _COMMANDS </span>
<span class="c1">      ;--------------------------------------------------------- </span></SUMMARY>
<span class="c1">      ;</span>
<span class="c1">      ; If this is a new Command, </span>
<span class="c1">      ; then it has never been in _COMMANDS.</span>
<span class="c1">      ;</span>
<span class="c1">      ; If this is an existing Command being edited, </span>
<span class="c1">      ; then GuiConfigMain plucked it from _COMMANDS to </span>
<span class="c1">      ; simplify the code here.</span>
<span class="c1">      ;</span>
<span class="c1">      ; Key: </span>
<span class="c1">      ;        This Command&#39;s phrase</span>
<span class="c1">      ;        (stored in popup_cmd)</span>
<span class="c1">      ; Value:</span>
<span class="c1">      ;        An associative array holding:</span>
<span class="c1">      ;         Key:   &quot;enabled&quot; </span>
<span class="c1">      ;         Value: true or false </span>
<span class="c1">      ;                  (true if a new command,</span>
<span class="c1">      ;                  otherwise we&#39;ll use its original state)</span>
<span class="c1">      ;         Key:   &quot;action_id&quot; </span>
<span class="c1">      ;         Value: The integer ID for the Action</span>
<span class="c1">      ;                  (currently stored in popup_actionID)</span>
<span class="c1">      ;--------------------------------------------------------- </span></DETAILS>
      
      <span class="n">cmd</span>        <span class="o">:=</span> <span class="n">popup_cmd</span>
      <span class="n">aID</span>        <span class="o">:=</span> <span class="n">popup_actionID</span>
      <span class="n">is_enabled</span> <span class="o">:=</span> <span class="ss">(</span><span class="s">&quot;add&quot;</span><span class="o">==</span><span class="n">purpose</span><span class="ss">)</span> 
                  <span class="o">?</span> <span class="s">&quot;true&quot;</span> 
                  <span class="o">:</span> <span class="n">GuiConfigMain</span><span class="o">.</span><span class="vc">_plucked_command</span><span class="p">[</span><span class="s">&quot;enabled&quot;</span><span class="p">]</span><span class="c1"></span>
<span class="c1">                  </span>
<span class="c1">                  ;------------------------------------------------------</span>
<span class="c1">                  ; AutoHotkey Docs, Ternary Operator: </span>
<span class="c1">                  ; https://www.autohotkey.com/docs/Variables.htm#ternary</span>
<span class="c1">                  ;------------------------------------------------------</span>
      
      
      <span class="vc">_COMMANDS</span><span class="p">[</span><span class="n">cmd</span><span class="p">]</span> <span class="o">:=</span> <span class="p">{</span> <span class="s">&quot;action_id&quot;</span><span class="o">:</span><span class="n">aID</span><span class="p">,</span> <span class="s">&quot;enabled&quot;</span><span class="o">:</span><span class="n">is_enabled</span> <span class="p">}</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;===================================================</span>
<span class="c1">      ; Submit Command (new or modified) </span>
<span class="c1">      ; to GuiConfigMain&#39;s Command ListView</span>
<span class="c1">      ;===================================================</span>
<span class="c1">      </span>
<span class="c1">      ;----------------------------------------------------------------</span>
<span class="c1">      ; This label ensures the next AHK ListView function (&quot;LV_...()&quot;)</span>
<span class="c1">      ; will specifically use GuiConfigMain&#39;s ListView for Commands</span>
<span class="c1">      ;----------------------------------------------------------------</span>
      
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_Activate</span><span class="ss">()</span><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      ; msgbox cmd submit: purpose is [%purpose%]</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span><span class="s">&quot;add&quot;</span> <span class="o">==</span> <span class="n">purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         
         <span class="n">options</span> <span class="o">:=</span> <span class="s">&quot;+Check&quot;</span>
         <span class="kr">LV_ADD</span><span class="ss">(</span> <span class="n">options</span><span class="c1">      ; enable by default</span>
            <span class="p">,</span> <span class="n">popup_cmd</span><span class="c1">             ; row 1</span>
            <span class="p">,</span><span class="c1">                       ; row 2 is always empty</span>
            <span class="p">,</span> <span class="n">popup_actionID</span><span class="c1">      ; row 3</span>
            <span class="p">,</span> <span class="n">popup_actionType</span><span class="c1">       ; row 4</span>
            <span class="p">,</span> <span class="n">popup_actionPath</span><span class="c1">       ; row 5</span>
            <span class="p">,</span> <span class="n">popup_actionArg</span>  <span class="ss">)</span><span class="c1">    ; row 6</span>
         
      <span class="p">}</span></DETAILS>
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">else</span> 
      <span class="k">if</span><span class="ss">(</span><span class="s">&quot;edit&quot;</span> <span class="o">==</span> <span class="n">purpose</span><span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;---------------------------------------------------------------------</span>
<span class="c1">         ; Update the Command&#39;s entry in GuiConfigMain&#39;s ListView for Commands</span>
<span class="c1">         ;---------------------------------------------------------------------</span>
      
         <span class="n">modify_this_row</span> <span class="o">:=</span> <span class="n">F_insertion_point_for_mainLV</span><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;[~]</span>
         
         <span class="kr">LV_MODIFY</span><span class="ss">(</span><span class="n">modify_this_row</span>
            <span class="p">,</span><span class="c1">                     ; no options needed</span>
            <span class="p">,</span> <span class="n">popup_cmd</span><span class="c1">             ; row 1</span>
            <span class="p">,</span><span class="c1">                       ; row 2 is always empty</span>
            <span class="p">,</span> <span class="n">popup_actionID</span><span class="c1">      ; row 3</span>
            <span class="p">,</span> <span class="n">popup_actionType</span><span class="c1">       ; row 4</span>
            <span class="p">,</span> <span class="n">popup_actionPath</span><span class="c1">       ; row 5</span>
            <span class="p">,</span> <span class="n">popup_actionArg</span>  <span class="ss">)</span><span class="c1">    ; row 6</span>
            
<DETAILS class="leading_tabs_3"><SUMMARY><span class="c1">;----------------------------------------</span>
<span class="c1">         ; Remove backup of (now) edited command</span>
<span class="c1">         ;---------------------------------------- </span></SUMMARY>
<span class="c1">         ; Making this variable empty will prevent </span>
<span class="c1">         ;</span>
<span class="c1">         ;   GUI_EVENT_GuiConfigPopup_OnClose and</span>
<span class="c1">         ;   GUI_EVENT_GuiConfigPopup_OnEscape</span>
<span class="c1">         ;</span>
<span class="c1">         ; from automatically restoring </span>
<span class="c1">         ; the old version of this Command</span>
<span class="c1">         ;</span>
<span class="c1">         ; when the GuiConfigPopup GUI is closed.</span>
<span class="c1">         ;---------------------------------------- </span></DETAILS>
         
         <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">Discard_Plucked_Command</span><span class="ss">()</span>
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;========================================================</span>
<span class="c1">      ; Add if Action is new:</span>
<span class="c1">      ;</span>
<span class="c1">      ;    Submit new Action to _ACTIONS array </span>
<span class="c1">      ;    Submit new Action to GuiConfigMain&#39;s Action ListView</span>
<span class="c1">      ;    Submit new Action to Savefile</span>
<span class="c1">      ;========================================================</span>
         
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="n">is_action_new</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">         ;========================================</span>
<span class="c1">         ; Submit Action </span>
<span class="c1">         ; to GuiConfigMain&#39;s Action ListView</span>
<span class="c1">         ;========================================</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="vc">_ACTIONS</span><span class="o">.</span><span class="nn">HasKey</span><span class="ss">(</span><span class="n">popup_actionID</span><span class="ss">)</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            
            <span class="vc">_ACTIONS</span><span class="p">[</span><span class="n">popup_actionID</span><span class="p">]</span> <span class="o">:=</span> <span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="n">popup_actionType</span>
                                 <span class="p">,</span> <span class="s">&quot;path&quot;</span><span class="o">:</span><span class="n">popup_actionPath</span>
                                 <span class="p">,</span> <span class="s">&quot;arg&quot;</span> <span class="o">:</span><span class="n">popup_actionArg</span>  <span class="p">}</span>
            
            <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_AddNewAction</span><span class="ss">(</span><span class="n">popup_actionID</span>
               <span class="p">,</span> <span class="n">popup_actionType</span>
               <span class="p">,</span> <span class="n">popup_actionPath</span>
               <span class="p">,</span> <span class="n">popup_actionArg</span><span class="ss">)</span>            
         <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">         </span>
<span class="c1">         ;========================================</span>
<span class="c1">         ; Submit Action to Savefile </span>
<span class="c1">         ;========================================</span>
<span class="c1">         </span>
<span class="c1">         ;-------------------------------------------------------------------</span>
<span class="c1">         ; Syntax Reference</span>
<span class="c1">         ;-------------------------------------------------------------------</span>
<span class="c1">         ; class:    FILE_HELPER</span>
<span class="c1">         ; function: Change_Savefile( p1,p2,p3,p4 )</span>
<span class="c1">         ;</span>
<span class="c1">         ; p1:  mode                      action|command</span>
<span class="c1">         ; p2:  purpose                   add|delete|edit|enable|disable</span>
<span class="c1">         ; p2:  action_id__or__cmd        new Action&#39;s ID </span>
<span class="c1">         ; p2:  cmd_name_before_rename    not applicable here</span>
<span class="c1">         ;-------------------------------------------------------------------</span>
         
         <span class="n">p1</span> <span class="o">:=</span> <span class="s">&quot;action&quot;</span>
         <span class="n">p2</span> <span class="o">:=</span> <span class="s">&quot;add&quot;</span> 
         <span class="n">p3</span> <span class="o">:=</span> <span class="n">popup_actionID</span>
         <span class="n">p4</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
         <span class="n">savefile_updated</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Savefile</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span><span class="p">,</span><span class="n">p4</span> <span class="ss">)</span>
         
<DETAILS open class="control_flow_block leading_tabs_3"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="n">savefile_updated</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
            <span class="kr">MSGBOX</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">ERROR</span> <span class="n">WRITING</span> <span class="n">NEW</span> <span class="n">ACTION</span> <span class="n">TO</span> <span class="n">SAVEFILE</span><span class="p">,</span> <span class="p">[</span><span class="o">~</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">FAILURE</span>
         <span class="p">}</span></DETAILS>
         
         
      <span class="p">}</span></DETAILS><span class="c1"></span>
<span class="c1">      </span>
<span class="c1">      </span>
<span class="c1">      ;=======================================================================</span>
<span class="c1">      ; Submit Command (new or modified)</span>
<span class="c1">      ; to Savefile (all above operations were successful)</span>
<span class="c1">      ;=======================================================================</span>
<span class="c1">      </span>
<span class="c1">      ;-------------------------------------------------------------------</span>
<span class="c1">      ; Syntax Reference</span>
<span class="c1">      ;-------------------------------------------------------------------</span>
<span class="c1">      ; class:    FILE_HELPER</span>
<span class="c1">      ; function: Change_Savefile( p1,p2,p3,p4 )</span>
<span class="c1">      ;</span>
<span class="c1">      ; p1:  mode                      action|command</span>
<span class="c1">      ; p2:  purpose                   add|delete|edit|enable|disable</span>
<span class="c1">      ; p2:  action_id__or__cmd        updated text for Command</span>
<span class="c1">      ; p2:  cmd_name_before_rename    old text before Command renamed</span>
<span class="c1">      ;-------------------------------------------------------------------</span>
      
      <span class="n">p1</span> <span class="o">:=</span> <span class="n">mode</span>
      <span class="n">p2</span> <span class="o">:=</span> <span class="n">purpose</span> 
      <span class="n">p3</span> <span class="o">:=</span> <span class="n">popup_cmd</span>
      <span class="n">p4</span> <span class="o">:=</span> <span class="n">original_command_name</span>
      <span class="n">savefile_updated</span> <span class="o">:=</span> <span class="n">FILE_HELPER</span><span class="o">.</span><span class="nf">Change_Savefile</span><span class="ss">(</span> <span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span><span class="p">,</span><span class="n">p4</span> <span class="ss">)</span>
         
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">if</span><span class="ss">(</span> <span class="o">!</span><span class="n">savefile_updated</span> <span class="ss">)</span><span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="kr">MSGBOX</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">ERROR</span> <span class="n">WRITING</span> <span class="n">COMMAND</span> <span class="n">TO</span> <span class="n">SAVEFILE</span><span class="p">,</span> <span class="p">[</span><span class="o">~</span><span class="p">]</span>
         <span class="k">return</span> <span class="n">FAILURE</span>
      <span class="p">}</span></DETAILS>
      
      
      <span class="k">return</span> <span class="n">SUCCESS</span>
         
   <span class="p">}</span><span class="c1"> ; end of Submit_Changes_3___CommandSubmit() </span></DETAILS>
   
   
<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">Submit_Changes_4____Finalize_And_Close</span><span class="ss">()</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewActions_ReadjustAllCols</span><span class="ss">()</span>
      <span class="n">GuiConfigMain</span><span class="o">.</span><span class="nf">ListViewCommands_ReadjustAllCols</span><span class="ss">()</span>
      
      <span class="n">GuiConfigPopup</span><span class="o">.</span><span class="nf">GUI_EVENT_OnClose</span><span class="ss">()</span>
      <span class="k">return</span>
   <span class="p">}</span></DETAILS><span class="c1"></span>


<span class="c1">;=======================================================================</span>
<span class="c1">;         end of class:</span>
<span class="c1">;         GuiConfigPopup (Popup from GuiConfigMain&#39;s first tab)</span>
<span class="c1">;=======================================================================</span>

<span class="p">}</span></DETAILS>



<DETAILS class="leading_tabs_0"><SUMMARY><span class="k">class</span> <span class="n">REUSABLE_GUI_CONTROLS</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>

<DETAILS class="leading_tabs_1"><SUMMARY><span class="nf">create_listview_of_actions</span><span class="ss">(</span> <span class="n">GuiName</span><span class="p">,</span> <span class="n">GotoFuncOnEvent</span><span class="p">,</span> <span class="n">ControlNameForLV</span> <span class="ss">)</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
   <span class="nb">global</span> 
      
      <span class="n">options</span> <span class="o">:=</span> <span class="nv">A_Space</span> <span class="s">&quot;g&quot;</span> <span class="n">GotoFuncOnEvent</span><span class="c1">  ;&quot;GuiConfigMain.GUI_EVENT_ListViewActions&quot; </span>
      <span class="n">options</span> <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;v&quot;</span> <span class="n">ControlNameForLV</span><span class="c1"> ;&quot;GuiConfigMain_ListViewActions&quot; </span>
      <span class="n">options</span> <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;-checked +ReadOnly +AltSubmit -Multi&quot;</span> 
      <span class="n">options</span> <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;r20 w700&quot;</span> 
      <span class="n">options</span> <span class="o">.=</span> <span class="nv">A_Space</span> <span class="s">&quot;+LV0x10000&quot;</span><span class="c1"> </span>
<span class="c1">         ; see: https://www.autohotkey.com/docs/misc/Styles.htm#ListView</span>
      
      
      <span class="n">text_column1</span> <span class="o">:=</span> <span class="s">&quot;Action ID&quot;</span>
      <span class="n">text_column2</span> <span class="o">:=</span> <span class="s">&quot;|Action Type&quot;</span>
      <span class="n">text_column3</span> <span class="o">:=</span> <span class="s">&quot;|Action Path&quot;</span>
      <span class="n">text_column4</span> <span class="o">:=</span> <span class="s">&quot;|Action Arg for Programs&quot;</span>
      <span class="n">text</span> <span class="o">:=</span> <span class="n">text_column1</span>
                             <span class="o">.</span>  <span class="n">text_column2</span>
                             <span class="o">.</span>  <span class="n">text_column3</span>
                             <span class="o">.</span>  <span class="n">text_column4</span>
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="vi">%GuiName%</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">ListView</span>
         <span class="p">,</span> <span class="vi">%options%</span>
         <span class="p">,</span>    <span class="vi">%text%</span>
      
      
      
      <span class="kr">Gui</span><span class="p">,</span> <span class="vi">%GuiName%</span><span class="o">:</span><span class="n">Default</span>
      <span class="kr">Gui</span><span class="p">,</span> <span class="vi">%GuiName%</span><span class="o">:</span><span class="n">ListView</span><span class="p">,</span> <span class="vi">%ControlNameForLV%</span>
      
<DETAILS open class="control_flow_block leading_tabs_2"><SUMMARY><span class="k">for</span> <span class="n">id</span><span class="p">,</span> <span class="n">action</span> <span class="ow">in</span> <span class="vc">_ACTIONS</span> <span class="p">{</span><span class="DETAILS_CLOSE_BRACE">}</span></SUMMARY>
         <span class="n">action_type</span> <span class="o">:=</span> <span class="n">action</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span>
         <span class="n">action_path</span> <span class="o">:=</span> <span class="n">action</span><span class="p">[</span><span class="s">&quot;path&quot;</span><span class="p">]</span>
         <span class="n">action_arg</span>  <span class="o">:=</span> <span class="n">action</span><span class="p">[</span><span class="s">&quot;arg&quot;</span><span class="p">]</span>
         
         <span class="kr">LV_Add</span><span class="ss">(</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">action_type</span><span class="p">,</span> <span class="n">action_path</span><span class="p">,</span> <span class="n">action_arg</span> <span class="ss">)</span>
         
      <span class="p">}</span></DETAILS>
      
      <span class="k">return</span>
   <span class="p">}</span></DETAILS>

<span class="p">}</span></DETAILS>



 
</pre></div>
</div>
<p></div>
</details>
</div></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <br />
	<div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      <a href="../../User_Guide/index.html" class="btn btn-neutral float-left" title="User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../../../Godot/index.html" class="btn btn-neutral float-right" title="What is Godot?" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>

  <br />
  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div><div style="
    text-align: right;
	font-size: 11px;
    ">		
		&copy; Gamepad.Coder 2021
		<br>
		Have a wonderful day.
	</div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  





</body>
</html>